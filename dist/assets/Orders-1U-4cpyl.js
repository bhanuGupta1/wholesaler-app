import{u as Y,e as Z,r as l,j as e,L as d,c as v,d as j,w as N,o as E,l as H,q as k,g as u,C as _}from"./index-CFL3WSdy.js";const re=()=>{const{darkMode:t}=Y(),{user:W}=Z(),p=!W,[y,A]=l.useState([]),[$,m]=l.useState(!0),[R,C]=l.useState(null),[O,L]=l.useState(null),[T,I]=l.useState(!0),[q,U]=l.useState(0),[Q,V]=l.useState(1),b=10,[s,B]=l.useState({status:"all",dateRange:"all",searchTerm:""});l.useEffect(()=>{(async()=>{try{m(!0),C(null);const a=v(j,"orders");let i=[];if(s.status!=="all"&&i.push(N("status","==",s.status)),s.dateRange!=="all"){const g=new Date;let o=new Date;switch(s.dateRange){case"today":o.setHours(0,0,0,0);break;case"week":o.setDate(g.getDate()-7);break;case"month":o.setMonth(g.getMonth()-1);break;case"3months":o.setMonth(g.getMonth()-3);break;default:break}s.dateRange!=="all"&&i.push(N("createdAt",">=",o))}i.push(E("createdAt","desc")),i.push(H(b));const x=k(a,...i),h=await u(x),D=h.docs[h.docs.length-1];L(D),I(h.docs.length===b);const c=await Promise.all(h.docs.map(async g=>{const o=g.data(),f=o.createdAt?typeof o.createdAt.toDate=="function"?o.createdAt.toDate():new Date(o.createdAt):new Date,w=v(j,"orders",g.id,"orderItems"),P=(await u(w)).docs.map(z=>({id:z.id,...z.data()}));return{id:g.id,...o,createdAt:f,items:P,customerName:o.customerName||"Unknown Customer",status:o.status||"pending",total:o.total||0,itemCount:o.itemCount||P.length||0}}));A(c);let n=k(a);s.status!=="all"&&(n=k(n,N("status","==",s.status)));const S=await u(n);U(S.size),m(!1)}catch(a){console.error("Error fetching orders:",a),C("Failed to load orders. Please try again later."),m(!1)}})()},[s,Q]);const G=async()=>{if(!(!T||!O))try{m(!0);const r=v(j,"orders");let a=[];s.status!=="all"&&a.push(N("status","==",s.status)),a.push(E("createdAt","desc")),a.push(_(O)),a.push(H(b));const i=k(r,...a),x=await u(i),h=x.docs[x.docs.length-1];L(h),I(x.docs.length===b);const D=await Promise.all(x.docs.map(async c=>{const n=c.data(),S=n.createdAt?typeof n.createdAt.toDate=="function"?n.createdAt.toDate():new Date(n.createdAt):new Date,g=v(j,"orders",c.id,"orderItems"),f=(await u(g)).docs.map(w=>({id:w.id,...w.data()}));return{id:c.id,...n,createdAt:S,items:f,customerName:n.customerName||"Unknown Customer",status:n.status||"pending",total:n.total||0,itemCount:n.itemCount||f.length||0}}));A(c=>[...c,...D]),V(c=>c+1),m(!1)}catch(r){console.error("Error loading more orders:",r),C("Failed to load more orders. Please try again later."),m(!1)}},F=(r,a)=>{B(i=>({...i,[r]:a})),V(1),L(null)},J=r=>{const a=r.target.value;B(i=>({...i,searchTerm:a}))},M=l.useMemo(()=>{if(!s.searchTerm)return y;const r=s.searchTerm.toLowerCase();return y.filter(a=>a.customerName.toLowerCase().includes(r)||a.customerEmail&&a.customerEmail.toLowerCase().includes(r)||a.id.toLowerCase().includes(r))},[y,s.searchTerm]),K=r=>{switch(r){case"completed":return t?"bg-green-900/30 text-green-400":"bg-green-100 text-green-800";case"shipped":return t?"bg-blue-900/30 text-blue-400":"bg-blue-100 text-blue-800";case"processing":return t?"bg-yellow-900/30 text-yellow-400":"bg-yellow-100 text-yellow-800";case"cancelled":return t?"bg-red-900/30 text-red-400":"bg-red-100 text-red-800";case"pending":default:return t?"bg-gray-700 text-gray-300":"bg-gray-100 text-gray-800"}},X=r=>r?r.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"Unknown";return e.jsxs("div",{className:`container mx-auto px-4 py-8 ${t?"text-gray-200":"text-gray-800"}`,children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center mb-6",children:[e.jsx("h1",{className:`text-2xl font-bold ${t?"text-white":"text-gray-900"} mb-4 md:mb-0`,children:"Orders"}),e.jsx("div",{className:"flex flex-wrap gap-3",children:!p&&e.jsxs(d,{to:"/create-order",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"New Order"]})})]}),e.jsxs("div",{className:`${t?"bg-gray-800 border-gray-700":"bg-white border-gray-100"} rounded-lg shadow-md p-4 mb-6 border`,children:[e.jsx("h2",{className:`text-lg font-medium ${t?"text-white":"text-gray-900"} mb-4`,children:"Order Management"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-3",children:[e.jsxs(d,{to:"/invoice",className:`flex items-center justify-center px-4 py-3 border border-transparent text-sm font-medium rounded-md ${t?"text-blue-400 bg-blue-900/20 hover:bg-blue-900/30 border-blue-800":"text-blue-700 bg-blue-50 hover:bg-blue-100 border-blue-200"} transition-colors`,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Invoice"]}),e.jsxs(d,{to:"/order-details",className:`flex items-center justify-center px-4 py-3 border border-transparent text-sm font-medium rounded-md ${t?"text-green-400 bg-green-900/20 hover:bg-green-900/30 border-green-800":"text-green-700 bg-green-50 hover:bg-green-100 border-green-200"} transition-colors`,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Order Details"]}),e.jsxs(d,{to:"/order-filters",className:`flex items-center justify-center px-4 py-3 border border-transparent text-sm font-medium rounded-md ${t?"text-purple-400 bg-purple-900/20 hover:bg-purple-900/30 border-purple-800":"text-purple-700 bg-purple-50 hover:bg-purple-100 border-purple-200"} transition-colors`,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),"Filters"]}),e.jsxs(d,{to:"/orders-page",className:`flex items-center justify-center px-4 py-3 border border-transparent text-sm font-medium rounded-md ${t?"text-yellow-400 bg-yellow-900/20 hover:bg-yellow-900/30 border-yellow-800":"text-yellow-700 bg-yellow-50 hover:bg-yellow-100 border-yellow-200"} transition-colors`,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),"Orders Page"]}),e.jsxs(d,{to:"/order-table",className:`flex items-center justify-center px-4 py-3 border border-transparent text-sm font-medium rounded-md ${t?"text-indigo-400 bg-indigo-900/20 hover:bg-indigo-900/30 border-indigo-800":"text-indigo-700 bg-indigo-50 hover:bg-indigo-100 border-indigo-200"} transition-colors`,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h18M3 14h18m-9-4v8m-7 0h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})}),"Order Table"]})]})]}),e.jsx("div",{className:`${t?"bg-gray-800 border-gray-700":"bg-white border-gray-100"} rounded-lg shadow-md p-6 mb-6 border`,children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"col-span-1",children:[e.jsx("label",{htmlFor:"search",className:`block text-sm font-medium ${t?"text-gray-300":"text-gray-700"} mb-1`,children:"Search Orders"}),e.jsxs("div",{className:"relative rounded-md shadow-sm",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),e.jsx("input",{type:"text",id:"search",value:s.searchTerm,onChange:J,className:`focus:ring-indigo-500 focus:border-indigo-500 block w-full pl-10 sm:text-sm border-gray-300 rounded-md ${t?"bg-gray-700 border-gray-600 text-gray-100 placeholder-gray-400":"bg-white border-gray-300"}`,placeholder:"Search by customer name or ID"})]})]}),e.jsxs("div",{className:"col-span-1",children:[e.jsx("label",{htmlFor:"status",className:`block text-sm font-medium ${t?"text-gray-300":"text-gray-700"} mb-1`,children:"Filter by Status"}),e.jsxs("select",{id:"status",value:s.status,onChange:r=>F("status",r.target.value),className:`mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md ${t?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`,children:[e.jsx("option",{value:"all",children:"All Statuses"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"processing",children:"Processing"}),e.jsx("option",{value:"shipped",children:"Shipped"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),e.jsxs("div",{className:"col-span-1",children:[e.jsx("label",{htmlFor:"dateRange",className:`block text-sm font-medium ${t?"text-gray-300":"text-gray-700"} mb-1`,children:"Date Range"}),e.jsxs("select",{id:"dateRange",value:s.dateRange,onChange:r=>F("dateRange",r.target.value),className:`mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md ${t?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`,children:[e.jsx("option",{value:"all",children:"All Time"}),e.jsx("option",{value:"today",children:"Today"}),e.jsx("option",{value:"week",children:"Last 7 Days"}),e.jsx("option",{value:"month",children:"Last 30 Days"}),e.jsx("option",{value:"3months",children:"Last 3 Months"})]})]})]})}),$&&y.length===0?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:`animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 ${t?"border-indigo-400":"border-indigo-500"}`})}):R?e.jsx("div",{className:`${t?"bg-red-900/30 border-red-800":"bg-red-50 border-red-400"} p-4 mb-6 rounded-md`,children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-red-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:`text-sm ${t?"text-red-400":"text-red-700"}`,children:R})})]})}):M.length===0?e.jsxs("div",{className:`${t?"bg-gray-800 border-gray-700":"bg-white border-gray-100"} rounded-lg shadow-md p-8 text-center border`,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-12 w-12 mx-auto ${t?"text-gray-500":"text-gray-400"}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),e.jsx("h3",{className:`mt-2 text-lg font-medium ${t?"text-gray-200":"text-gray-900"}`,children:"No orders found"}),e.jsx("p",{className:`mt-1 text-sm ${t?"text-gray-400":"text-gray-500"}`,children:s.status!=="all"||s.dateRange!=="all"||s.searchTerm?"Try adjusting your search or filters to find what you're looking for.":"Get started by creating your first order."}),e.jsx("div",{className:"mt-6",children:!p&&e.jsx(d,{to:"/create-order",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Create Order"})})]}):e.jsxs("div",{className:`${t?"bg-gray-800 border-gray-700":"bg-white border-gray-100"} rounded-lg shadow-lg overflow-hidden border`,children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:`${t?"bg-gray-700":"bg-gray-50"}`,children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:`px-6 py-3 text-left text-xs font-medium ${t?"text-gray-300":"text-gray-500"} uppercase tracking-wider`,children:"Order ID"}),e.jsx("th",{scope:"col",className:`px-6 py-3 text-left text-xs font-medium ${t?"text-gray-300":"text-gray-500"} uppercase tracking-wider`,children:"Customer"}),e.jsx("th",{scope:"col",className:`px-6 py-3 text-left text-xs font-medium ${t?"text-gray-300":"text-gray-500"} uppercase tracking-wider`,children:"Date"}),e.jsx("th",{scope:"col",className:`px-6 py-3 text-left text-xs font-medium ${t?"text-gray-300":"text-gray-500"} uppercase tracking-wider`,children:"Items"}),e.jsx("th",{scope:"col",className:`px-6 py-3 text-left text-xs font-medium ${t?"text-gray-300":"text-gray-500"} uppercase tracking-wider`,children:"Total"}),e.jsx("th",{scope:"col",className:`px-6 py-3 text-left text-xs font-medium ${t?"text-gray-300":"text-gray-500"} uppercase tracking-wider`,children:"Status"}),e.jsx("th",{scope:"col",className:`px-6 py-3 text-right text-xs font-medium ${t?"text-gray-300":"text-gray-500"} uppercase tracking-wider`,children:"Actions"})]})}),e.jsx("tbody",{className:`${t?"bg-gray-800 divide-y divide-gray-700":"bg-white divide-y divide-gray-200"}`,children:M.map(r=>e.jsxs("tr",{className:`${t?"hover:bg-gray-700":"hover:bg-gray-50"}`,children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:`text-sm font-medium ${t?"text-gray-200":"text-gray-900"}`,children:["#",r.id.substring(0,8)]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`h-8 w-8 rounded-full ${t?"bg-gray-600 text-gray-300":"bg-gray-200 text-gray-600"} flex items-center justify-center font-medium`,children:r.customerName.charAt(0).toUpperCase()}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:`text-sm font-medium ${t?"text-gray-200":"text-gray-900"}`,children:r.customerName}),r.customerEmail&&e.jsx("div",{className:`text-sm ${t?"text-gray-400":"text-gray-500"}`,children:r.customerEmail})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:`text-sm ${t?"text-gray-200":"text-gray-900"}`,children:X(r.createdAt)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:`text-sm ${t?"text-gray-200":"text-gray-900"}`,children:r.itemCount})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:`text-sm font-medium ${t?"text-gray-200":"text-gray-900"}`,children:["$",typeof r.total=="number"?r.total.toFixed(2):r.total]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${K(r.status)}`,children:r.status.charAt(0).toUpperCase()+r.status.slice(1)})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[e.jsx(d,{to:`/orders/${r.id}`,className:`${t?"text-indigo-400 hover:text-indigo-300":"text-indigo-600 hover:text-indigo-900"} mr-4`,children:"View"}),!p&&e.jsx(d,{to:`/generate-invoice/${r.id}`,className:`${t?"text-gray-400 hover:text-gray-300":"text-gray-600 hover:text-gray-900"}`,children:"Invoice"})]})]},r.id))})]})}),e.jsxs("div",{className:`${t?"bg-gray-700":"bg-gray-50"} px-4 py-3 border-t border-gray-200 dark:border-gray-700 sm:px-6 flex items-center justify-between`,children:[e.jsxs("div",{className:`text-sm ${t?"text-gray-300":"text-gray-700"}`,children:["Showing ",M.length," of ",q," results"]}),T&&e.jsx("div",{children:e.jsx("button",{onClick:G,disabled:$,className:"ml-3 inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md bg-indigo-600 hover:bg-indigo-700 text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:$?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Loading..."]}):"Load More"})})]})]}),p&&e.jsx("div",{className:`mt-8 p-6 ${t?"bg-gray-800 border-gray-700":"bg-white border-gray-100"} rounded-lg shadow-md border`,children:e.jsxs("div",{className:"sm:flex sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:`text-lg font-medium ${t?"text-white":"text-gray-900"}`,children:"Sign in to manage orders"}),e.jsx("p",{className:`mt-2 text-sm ${t?"text-gray-300":"text-gray-500"}`,children:"Create an account or sign in to create and manage orders for your wholesale business."})]}),e.jsxs("div",{className:"mt-5 sm:mt-0 sm:ml-6 sm:flex-shrink-0 sm:flex sm:items-center",children:[e.jsx(d,{to:"/login",className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 text-sm",children:"Sign in"}),e.jsx(d,{to:"/register",className:`ml-3 inline-flex items-center px-4 py-2 border ${t?"border-gray-600 text-gray-300 hover:bg-gray-700":"border-gray-300 text-gray-700 hover:bg-gray-50"} shadow-sm font-medium rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 text-sm`,children:"Register"})]})]})})]})};export{re as default};
