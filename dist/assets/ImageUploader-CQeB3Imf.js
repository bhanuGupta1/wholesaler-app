import{r as l,j as e,V as k,W as A,X as H,Y as J}from"./index-C076F-ZT.js";const I=({label:y="Upload Image",initialImage:a="",onImageUploaded:n,uploadToStorage:b=null,folder:j="images",filePrefix:F="",maxSizeMB:m=2,showPreview:B=!0,previewSize:U="md",darkMode:s=!1,className:z="",autoUpload:N=!1,customId:g=null,buttonLabel:G=null})=>{const[c,u]=l.useState(a),[$,P]=l.useState(null),[d,h]=l.useState(!1),[L,i]=l.useState(""),[f,x]=l.useState(0),p=l.useRef(null);l.useEffect(()=>{a&&u(a)},[a]);const S={sm:"h-16 w-16",md:"h-20 w-20",lg:"h-32 w-32",xl:"h-48 w-48"},W=async w=>{const t=w.target.files[0];if(!t)return;if(!["image/jpeg","image/png","image/gif","image/webp"].includes(t.type)){i("Please select a valid image file (JPEG, PNG, GIF, or WEBP)");return}if(t.size>m*1024*1024){i(`Image size must be less than ${m}MB`);return}i(""),P(t);const o=new FileReader;o.onloadend=()=>{u(o.result)},o.readAsDataURL(t),N?await R(t):n&&n(t)},R=async(w=null)=>{const t=w||$;if(!t)return c&&a?a:(i("Please select an image first"),"");try{h(!0),i(""),x(0);let r;if(b)r=await b(t);else{const o=`${F||""}${Date.now()}_${t.name}`,V=g?`${j}/${g}/${o}`:`${j}/${o}`,C=k(A,V);let v=0;const E=setInterval(()=>{v+=10,x(Math.min(v,90)),v>=90&&clearInterval(E)},200);await H(C,t),clearInterval(E),x(100),r=await J(C)}return n&&n(r),h(!1),r}catch(r){return console.error("Error uploading image:",r),i("Failed to upload image. Please try again."),h(!1),null}},D=()=>{u(""),P(null),x(0),n&&n(""),p.current&&(p.current.value="")};return e.jsxs("div",{className:`w-full ${z}`,children:[y&&e.jsx("label",{className:`block text-sm font-medium ${s?"text-gray-300":"text-gray-700"} mb-1`,children:y}),e.jsxs("div",{className:"mt-1 flex items-center space-x-4",children:[B&&e.jsxs("div",{className:`flex-shrink-0 ${S[U]} ${s?"bg-gray-700":"bg-gray-100"} rounded-md overflow-hidden flex items-center justify-center relative`,children:[c?e.jsx("img",{src:c,alt:"Preview",className:"h-full w-full object-cover"}):e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),c&&e.jsx("button",{type:"button",onClick:D,className:`absolute top-0 right-0 p-1 ${s?"bg-gray-800 text-gray-200":"bg-white text-gray-700"} rounded-bl-md hover:bg-red-500 hover:text-white transition-colors`,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),e.jsxs("div",{className:"flex flex-col flex-1",children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("input",{type:"file",accept:"image/*",id:`image-upload-${g||"default"}`,ref:p,onChange:W,className:"hidden",disabled:d}),e.jsxs("label",{htmlFor:`image-upload-${g||"default"}`,className:`inline-flex items-center px-3 py-1.5 ${s?"bg-gray-700 border-gray-600 text-gray-200 hover:bg-gray-600":"bg-white border-gray-300 text-gray-700 hover:bg-gray-50"} border rounded-md text-sm font-medium cursor-pointer transition-colors`,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0l-4 4m4-4v12"})}),c?"Change":G||"Select Image"]}),!N&&$&&!d&&e.jsx("button",{onClick:()=>R(),className:`inline-flex items-center px-3 py-1.5 border border-transparent text-sm font-medium rounded-md text-white ${s?"bg-indigo-600 hover:bg-indigo-500":"bg-indigo-600 hover:bg-indigo-700"}`,children:"Upload"}),d&&e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${s?"bg-indigo-900/30 text-indigo-400":"bg-indigo-100 text-indigo-800"}`,children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Uploading..."]})]}),L&&e.jsx("p",{className:`text-xs mt-1 ${s?"text-red-400":"text-red-600"}`,children:L}),d&&f>0&&e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[e.jsx("span",{className:s?"text-gray-400":"text-gray-500",children:"Uploading..."}),e.jsxs("span",{className:s?"text-gray-400":"text-gray-500",children:[f,"%"]})]}),e.jsx("div",{className:`w-full h-1.5 bg-gray-200 rounded-full overflow-hidden ${s?"bg-gray-700":"bg-gray-200"}`,children:e.jsx("div",{className:`h-full ${s?"bg-indigo-500":"bg-indigo-600"} rounded-full`,style:{width:`${f}%`}})})]}),e.jsxs("p",{className:`text-xs mt-1 ${s?"text-gray-400":"text-gray-500"}`,children:["Recommended: Square image (e.g., 600Ã—600px), JPEG or PNG, under ",m,"MB"]})]})]})]})};export{I};
