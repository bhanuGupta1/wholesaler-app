import{u as w,a as S,r as g,j as e,L as $,e as N,d as p,M as A,Z as C,b as U,g as f,c as v,f as D,q as R,k,l as L}from"./index-Cayz1xms.js";const E=({config:s,onUpdate:m,darkMode:o})=>{const[i,y]=g.useState(s),[n,c]=g.useState(!1),x=(t,d)=>{const a={...i,[t]:d};y(a)},b=async()=>{c(!0);try{await m(i)}finally{c(!1)}},u=[{title:"Security Settings",icon:"🔒",color:"red",settings:[{key:"requireEmailVerification",label:"Require Email Verification",type:"boolean",description:"Users must verify email before account activation"},{key:"sessionTimeout",label:"Session Timeout (minutes)",type:"number",description:"Automatic logout after inactivity",min:15,max:1440},{key:"maxLoginAttempts",label:"Max Login Attempts",type:"number",description:"Maximum failed login attempts before lockout",min:3,max:10}]},{title:"User Management",icon:"👥",color:"blue",settings:[{key:"autoApproveUsers",label:"Auto-approve New Users",type:"boolean",description:"Automatically approve new user registrations"},{key:"allowGuestAccess",label:"Allow Guest Access",type:"boolean",description:"Allow browsing without account registration"},{key:"defaultUserRole",label:"Default User Role",type:"select",description:"Default role assigned to new users",options:[{value:"user",label:"Regular User"},{value:"business",label:"Business User"}]}]},{title:"Business Settings",icon:"🏢",color:"green",settings:[{key:"requireBusinessVerification",label:"Require Business Verification",type:"boolean",description:"Business accounts need document verification"},{key:"minOrderAmount",label:"Minimum Order Amount ($)",type:"number",description:"Minimum order value for processing",min:0,max:1e3},{key:"allowBackorders",label:"Allow Backorders",type:"boolean",description:"Allow orders when items are out of stock"}]},{title:"Notifications",icon:"📢",color:"purple",settings:[{key:"emailNotifications",label:"Email Notifications",type:"boolean",description:"Send email notifications for system events"},{key:"lowStockAlert",label:"Low Stock Alert Threshold",type:"number",description:"Alert when inventory falls below this number",min:0,max:100},{key:"orderNotifications",label:"Order Notifications",type:"boolean",description:"Notify admins of new orders"}]}];return e.jsxs("div",{className:"space-y-6",children:[u.map((t,d)=>e.jsxs("div",{className:`p-6 rounded-lg border ${o?"bg-gray-800/50 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsxs("h3",{className:`text-lg font-semibold mb-4 text-${t.color}-500 flex items-center`,children:[e.jsx("span",{className:"mr-3",children:t.icon}),t.title]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:t.settings.map((a,l)=>e.jsxs("div",{className:`p-4 rounded border ${o?"bg-gray-700/50 border-gray-600":"bg-gray-50 border-gray-200"}`,children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${o?"text-gray-200":"text-gray-800"}`,children:a.label}),e.jsx("div",{className:"mb-2",children:a.type==="boolean"?e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:i[a.key]||!1,onChange:r=>x(a.key,r.target.checked),className:"sr-only"}),e.jsx("div",{className:`w-12 h-6 rounded-full transition-all ${i[a.key]?`bg-${t.color}-500`:o?"bg-gray-600":"bg-gray-300"}`,children:e.jsx("div",{className:`w-5 h-5 bg-white rounded-full transition-all transform ${i[a.key]?"translate-x-6":"translate-x-0.5"} mt-0.5`})}),e.jsx("span",{className:`ml-3 text-sm ${i[a.key]?`text-${t.color}-500`:o?"text-gray-400":"text-gray-600"}`,children:i[a.key]?"Enabled":"Disabled"})]}):a.type==="select"?e.jsx("select",{value:i[a.key]||a.options[0].value,onChange:r=>x(a.key,r.target.value),className:`w-full p-2 rounded border ${o?"bg-gray-800 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,children:a.options.map(r=>e.jsx("option",{value:r.value,children:r.label},r.value))}):e.jsx("input",{type:"number",value:i[a.key]||a.min||0,onChange:r=>x(a.key,parseInt(r.target.value)),min:a.min,max:a.max,className:`w-full p-2 rounded border ${o?"bg-gray-800 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`})}),e.jsx("p",{className:`text-xs ${o?"text-gray-400":"text-gray-500"}`,children:a.description})]},l))})]},d)),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:b,disabled:n,className:`px-6 py-3 rounded-lg font-medium transition-all ${n?o?"bg-gray-700 text-gray-400 cursor-not-allowed":"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-500 text-white"}`,children:n?"Saving...":"Save Configuration"})})]})},T=({darkMode:s})=>{const[m,o]=g.useState({totalUsers:0,totalProducts:0,totalOrders:0,pendingApprovals:0,lastUpdated:null}),[i,y]=g.useState(!1),[n,c]=g.useState(!1),x=async()=>{y(!0);try{const[t,d,a]=await Promise.all([f(v(p,"users")),f(v(p,"products")),f(v(p,"orders"))]),l=t.docs.filter(r=>{const h=r.data();return h.status==="pending_approval"||h.status==="pending"});o({totalUsers:t.size,totalProducts:d.size,totalOrders:a.size,pendingApprovals:l.length,lastUpdated:new Date})}catch(t){console.error("Error fetching database stats:",t)}finally{y(!1)}},b=async()=>{if(window.confirm("Are you sure you want to clear test data? This action cannot be undone.")){c(!0);try{const t=D(p);(await f(v(p,"users"))).docs.filter(l=>{const r=l.data().email||"";return r.includes("test")||r.includes("demo")||r.includes("example")}).forEach(l=>{t.delete(l.ref)}),await t.commit(),await x()}catch(t){console.error("Error clearing test data:",t)}finally{c(!1)}}};g.useEffect(()=>{x()},[]);const u=[{title:"Refresh Statistics",description:"Update database statistics",action:x,loading:i,color:"blue",icon:"🔄"},{title:"Clear Test Data",description:"Remove test users and demo data",action:b,loading:n,color:"red",icon:"🧹"}];return e.jsxs("div",{className:`p-6 rounded-lg border ${s?"bg-gray-800/50 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsxs("h3",{className:`text-lg font-semibold mb-6 ${s?"text-blue-400":"text-blue-600"} flex items-center`,children:[e.jsx("span",{className:"mr-3",children:"🗄️"}),"Database Management"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[{label:"Total Users",value:m.totalUsers,color:"blue",icon:"👥"},{label:"Total Products",value:m.totalProducts,color:"green",icon:"📦"},{label:"Total Orders",value:m.totalOrders,color:"purple",icon:"📋"},{label:"Pending Approvals",value:m.pendingApprovals,color:"yellow",icon:"⏳"}].map((t,d)=>e.jsxs("div",{className:`p-4 rounded border ${s?"bg-gray-700/50 border-gray-600":"bg-gray-50 border-gray-200"} text-center`,children:[e.jsx("div",{className:"text-2xl mb-2",children:t.icon}),e.jsx("div",{className:`text-2xl font-bold text-${t.color}-500 mb-1`,children:t.value}),e.jsx("div",{className:`text-xs ${s?"text-gray-400":"text-gray-600"}`,children:t.label})]},d))}),m.lastUpdated&&e.jsxs("div",{className:`text-sm ${s?"text-gray-400":"text-gray-600"} mb-6`,children:["Last updated: ",m.lastUpdated.toLocaleString()]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:u.map((t,d)=>e.jsxs("button",{onClick:t.action,disabled:t.loading,className:`p-4 rounded border text-left transition-all ${t.loading?s?"bg-gray-700 border-gray-600 cursor-not-allowed opacity-50":"bg-gray-100 border-gray-200 cursor-not-allowed opacity-50":s?`bg-gray-700/50 border-gray-600 hover:border-${t.color}-500/50 hover:bg-gray-700`:`bg-gray-50 border-gray-200 hover:border-${t.color}-500/50 hover:bg-gray-100`}`,children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("span",{className:"text-xl mr-3",children:t.icon}),e.jsx("span",{className:`text-sm font-medium ${t.loading?s?"text-gray-400":"text-gray-500":`text-${t.color}-500`}`,children:t.loading?"Processing...":t.title})]}),e.jsx("p",{className:`text-xs ${s?"text-gray-400":"text-gray-600"}`,children:t.description})]},d))})]})},B=({darkMode:s})=>{const[m,o]=g.useState([]),[i,y]=g.useState(!0);return g.useEffect(()=>{(async()=>{try{const x=(await f(R(v(p,"users"),k("updatedAt","desc"),L(10)))).docs.map(b=>{var d,a;const u=b.data();return{timestamp:((d=u.updatedAt)==null?void 0:d.toDate())||((a=u.createdAt)==null?void 0:a.toDate())||new Date,level:u.status==="rejected"?"ERROR":"INFO",message:`User ${u.status||"updated"}: ${u.email}`,details:`Account type: ${u.accountType||"user"}`}});o(x)}catch(c){console.error("Error fetching logs:",c),o([{timestamp:new Date,level:"ERROR",message:"Failed to fetch system logs",details:c.message}])}finally{y(!1)}})()},[]),i?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:`text-center ${s?"text-gray-400":"text-gray-600"}`,children:[e.jsx("div",{className:"text-2xl mb-2",children:"📋"}),e.jsx("div",{children:"Loading system logs..."})]})}):e.jsxs("div",{className:`p-6 rounded-lg border ${s?"bg-gray-800/50 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsxs("h3",{className:`text-lg font-semibold mb-4 ${s?"text-blue-400":"text-blue-600"} flex items-center`,children:[e.jsx("span",{className:"mr-3",children:"📋"}),"System Logs"]}),e.jsx("div",{className:`p-4 rounded border font-mono text-sm ${s?"bg-gray-900 border-gray-600 text-green-400":"bg-black border-gray-300 text-green-500"} max-h-96 overflow-y-auto`,children:e.jsxs("div",{className:"space-y-1",children:[m.map((n,c)=>e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsxs("span",{className:"text-gray-500",children:["[",n.timestamp.toLocaleString(),"]"]}),e.jsxs("span",{className:`${n.level==="ERROR"?"text-red-400":n.level==="WARN"?"text-yellow-400":"text-green-400"}`,children:[n.level,":"]}),e.jsx("span",{children:n.message})]}),n.details&&e.jsx("div",{className:"text-gray-500 ml-4 text-xs",children:n.details})]},c)),m.length===0&&e.jsx("div",{className:"text-gray-500",children:"No recent system activity"})]})})]})},q=()=>{const{darkMode:s}=w(),{user:m}=S(),[o,i]=g.useState({}),[y,n]=g.useState(!0),[c,x]=g.useState("system"),[b,u]=g.useState(null);g.useEffect(()=>{(async()=>{try{const r=N(p,"system","config"),h=await A(r);if(h.exists())i(h.data());else{const j={requireEmailVerification:!0,sessionTimeout:60,maxLoginAttempts:5,autoApproveUsers:!1,allowGuestAccess:!0,defaultUserRole:"user",requireBusinessVerification:!0,minOrderAmount:50,allowBackorders:!0,emailNotifications:!0,lowStockAlert:10,orderNotifications:!0};i(j),await C(r,j)}}catch(r){console.error("Error loading config:",r),t("Failed to load configuration","error")}finally{n(!1)}})()},[]);const t=(l,r="success")=>{u({message:l,type:r}),setTimeout(()=>u(null),4e3)},d=async l=>{try{const r=N(p,"system","config");await U(r,{...l,updatedAt:new Date,updatedBy:m.uid}),i(l),t("Configuration updated successfully","success")}catch(r){console.error("Error updating config:",r),t("Failed to update configuration","error")}},a=[{id:"system",label:"System Config",icon:"⚙️"},{id:"database",label:"Database",icon:"🗄️"},{id:"logs",label:"System Logs",icon:"📋"}];return y?e.jsx("div",{className:`min-h-screen ${s?"bg-gray-900":"bg-gray-50"}`,children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`text-6xl mb-4 ${s?"text-blue-400":"text-blue-500"}`,children:"⚙️"}),e.jsx("div",{className:`text-lg ${s?"text-gray-300":"text-gray-600"}`,children:"Loading Settings..."})]})})}):e.jsxs("div",{className:`min-h-screen ${s?"bg-gray-900":"bg-gray-50"} p-6`,children:[b&&e.jsx("div",{className:`fixed top-4 right-4 z-50 px-6 py-3 rounded-lg shadow-lg ${b.type==="success"?"bg-green-600 text-white":"bg-red-600 text-white"}`,children:b.message}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:`text-3xl font-bold ${s?"text-white":"text-gray-900"} flex items-center`,children:[e.jsx("span",{className:"mr-3",children:"⚙️"}),"Admin Settings"]}),e.jsx("p",{className:`text-sm ${s?"text-gray-400":"text-gray-600"}`,children:"Configure system settings and manage platform behavior"})]}),e.jsx($,{to:"/admin",className:`px-4 py-2 rounded-lg text-sm transition-all border ${s?"bg-gray-800 hover:bg-gray-700 text-blue-400 border-blue-500/50":"bg-white hover:bg-gray-50 text-blue-600 border-blue-500/50"}`,children:"← Back to Admin"})]}),e.jsx("div",{className:"flex space-x-1 bg-opacity-20 rounded-lg p-1",children:a.map(l=>e.jsxs("button",{onClick:()=>x(l.id),className:`flex-1 py-3 px-4 rounded text-sm font-medium transition-all ${c===l.id?"bg-blue-600 text-white":s?"text-gray-300 hover:text-white hover:bg-gray-700":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"}`,children:[e.jsx("span",{className:"mr-2",children:l.icon}),l.label]},l.id))})]}),e.jsxs("div",{className:"space-y-6",children:[c==="system"&&e.jsx(E,{config:o,onUpdate:d,darkMode:s}),c==="database"&&e.jsx(T,{darkMode:s}),c==="logs"&&e.jsx(B,{darkMode:s})]})]})};export{q as default};
