import{N as ve,a as je,u as we,h as ke,r as b,j as e}from"./index-Cayz1xms.js";import{c as $e}from"./orderService-Ckalb_W1.js";import{P as F}from"./package-CO1katkn.js";import{c as T}from"./createLucideIcon-ZL5jKoAQ.js";import{U as E}from"./user-tkCuWfrf.js";import{T as O}from"./truck-Bt5yrkGF.js";import{C as K}from"./credit-card-BgVdiJ11.js";import{T as P}from"./tag-DK9DjVU6.js";import{S as A}from"./shield-BPQzL7Fy.js";/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],X=T("mail",Ce);/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],Se=T("map-pin",Pe);/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],ee=T("phone",De),Me=()=>{var W,Y,U;const{cart:w,clearCart:re}=ve(),{user:g}=je(),{darkMode:s}=we(),k=ke(),l=!g||(g==null?void 0:g.role)==="guest",L=l?`guest_${Date.now()}`:null,[p,$]=b.useState(l?2:1),[S,R]=b.useState(!1),[M,I]=b.useState(""),[N,se]=b.useState([]);b.useEffect(()=>{const r=w.map(t=>te(t));se(r)},[w]);const te=r=>{if(!r.bulkPricing||typeof r.bulkPricing!="object")return{...r,effectivePrice:r.price,hasBulkDiscount:!1};const c=Object.keys(r.bulkPricing).map(a=>parseInt(a)).filter(a=>!isNaN(a)).sort((a,m)=>m-a).find(a=>r.quantity>=a);if(c){const a=r.bulkPricing[c.toString()],m=r.price-a,x=m/r.price*100;return{...r,effectivePrice:a,hasBulkDiscount:!0,bulkPricing:{...r.bulkPricing,isBulkPrice:!0,originalPrice:r.price,bulkDiscount:x,bulkTier:c,appliedPrice:a,savings:m}}}return{...r,effectivePrice:r.price,hasBulkDiscount:!1,bulkPricing:{...r.bulkPricing,isBulkPrice:!1}}},[n,ae]=b.useState({firstName:((W=g==null?void 0:g.displayName)==null?void 0:W.split(" ")[0])||"",lastName:((Y=g==null?void 0:g.displayName)==null?void 0:Y.split(" ")[1])||"",email:(g==null?void 0:g.email)||"",phone:"",address:"",suburb:"",city:"",region:"",postcode:"",country:"NZ",isDefault:!1}),[o,ie]=b.useState({method:"credit_card",cardNumber:"",expiryDate:"",cvv:"",nameOnCard:"",billingAddressSame:!0,billingAddress:{address:"",suburb:"",city:"",region:"",postcode:"",country:"NZ"}}),[f,D]=b.useState("standard"),[_,ne]=b.useState(""),[d,le]=b.useState({email:"",phone:"",firstName:"",lastName:""});b.useEffect(()=>{w.length===0&&k("/cart")},[w,k]);const q=[{id:"standard",name:"Standard Delivery",description:"3-5 business days",price:9.9,freeThreshold:250},{id:"express",name:"Express Delivery",description:"1-2 business days",price:19.9,freeThreshold:500},{id:"overnight",name:"Overnight Delivery",description:"Next business day (Metro areas)",price:29.9,freeThreshold:1e3},{id:"pickup",name:"Click & Collect",description:"Ready in 2-4 hours",price:0,freeThreshold:0}],de=["Auckland","Bay of Plenty","Canterbury","Gisborne","Hawke's Bay","Manawatū-Whanganui","Marlborough","Nelson","Northland","Otago","Southland","Taranaki","Tasman","Waikato","Wellington","West Coast"],Z=()=>{let r=0,t=0,c=0;N.forEach(h=>{const H=(h.effectivePrice||h.price)*h.quantity;r+=H;const J=h.price*h.quantity;if(c+=J,h.hasBulkDiscount){const Ne=J-H;t+=Ne}});const a=q.find(h=>h.id===f),m=r>=a.freeThreshold?0:a.price,x=r*.15,j=r+m+x;return{subtotal:r,originalSubtotal:c,totalBulkSavings:t,deliveryFee:m,gst:x,total:j,totalItems:N.reduce((h,Q)=>h+Q.quantity,0)}},y=(r,t)=>{ae(c=>({...c,[r]:t}))},v=(r,t)=>{ie(c=>({...c,[r]:t}))},C=(r,t)=>{le(c=>({...c,[r]:t}))},oe=()=>{if(l)return!0;const r={};return n.firstName.trim()||(r.firstName="First name is required"),n.lastName.trim()||(r.lastName="Last name is required"),n.email.trim()?V(n.email)||(r.email="Please enter a valid email address"):r.email="Email is required",n.phone.trim()?z(n.phone)||(r.phone="Please enter a valid NZ phone number"):r.phone="Phone number is required",n.address.trim()||(r.address="Address is required"),n.city.trim()||(r.city="City is required"),n.region.trim()||(r.region="Region is required"),n.postcode.trim()?be(n.postcode)||(r.postcode="Postcode must be 4 digits"):r.postcode="Postcode is required",B(r),Object.keys(r).length===0},ce=()=>{if(!l)return!0;const r={};return d.firstName.trim()||(r.guestFirstName="First name is required"),d.lastName.trim()||(r.guestLastName="Last name is required"),d.email.trim()?V(d.email)||(r.guestEmail="Please enter a valid email address"):r.guestEmail="Email is required",d.phone&&!z(d.phone)&&(r.guestPhone="Please enter a valid NZ phone number"),B(r),Object.keys(r).length===0},me=()=>{const r={};return(o.method==="credit_card"||o.method==="debit_card")&&(o.nameOnCard.trim()||(r.nameOnCard="Name on card is required"),o.cardNumber.trim()?he(o.cardNumber)||(r.cardNumber="Card number must be 16 digits"):r.cardNumber="Card number is required",o.expiryDate.trim()?fe(o.expiryDate)||(r.expiryDate="Invalid or expired date (MM/YY)"):r.expiryDate="Expiry date is required",o.cvv.trim()?pe(o.cvv)||(r.cvv="CVV must be 3-4 digits"):r.cvv="CVV is required"),B(r),Object.keys(r).length===0},ue=r=>{const c=r.replace(/\s+/g,"").replace(/[^0-9]/gi,"").match(/\d{4,16}/g),a=c&&c[0]||"",m=[];for(let x=0,j=a.length;x<j;x+=4)m.push(a.substring(x,x+4));return m.length?m.join(" "):r},ge=r=>{const t=r.replace(/\D/g,"");return t.length>=2?t.substring(0,2)+(t.length>2?"/"+t.substring(2,4):""):t},xe=r=>r.replace(/\D/g,"").substring(0,4),G=r=>{const t=r.replace(/\D/g,"");return t.startsWith("64")?"+64 "+t.substring(2):t.startsWith("0")?t:t.length<=9?"0"+t:r},V=r=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r),z=r=>{const t=r.replace(/\D/g,"");return t.startsWith("64")?t.length>=11&&t.length<=13:t.length>=8&&t.length<=10},be=r=>/^\d{4}$/.test(r),he=r=>{const t=r.replace(/\s/g,"");return/^\d{16}$/.test(t)},pe=r=>/^\d{3,4}$/.test(r),fe=r=>{if(!/^\d{2}\/\d{2}$/.test(r))return!1;const[t,c]=r.split("/").map(j=>parseInt(j)),a=new Date,m=a.getFullYear()%100,x=a.getMonth()+1;return!(t<1||t>12||c<m||c===m&&t<x)},[i,B]=b.useState({}),ye=async()=>{try{R(!0),I("");const r=Z(),t={customerName:l?`${d.firstName} ${d.lastName}`:`${n.firstName} ${n.lastName}`,customerEmail:l?d.email:n.email,customerPhone:l?d.phone:n.phone,isGuestOrder:l,guestId:L,shippingAddress:l?{firstName:d.firstName,lastName:d.lastName,email:d.email,phone:d.phone,address:f==="pickup"?"Click & Collect":"Guest Order",suburb:"N/A",city:"N/A",region:"N/A",postcode:"N/A",country:"New Zealand"}:n,billingAddress:l?{firstName:d.firstName,lastName:d.lastName,email:d.email}:o.billingAddressSame?n:o.billingAddress,items:N.map(a=>{var m,x;return{productId:a.id,productName:a.name,originalPrice:a.price,effectivePrice:a.effectivePrice||a.price,quantity:a.quantity,subtotal:(a.effectivePrice||a.price)*a.quantity,hasBulkPricing:!!a.hasBulkDiscount,bulkTier:((m=a.bulkPricing)==null?void 0:m.bulkTier)||null,bulkDiscount:((x=a.bulkPricing)==null?void 0:x.bulkDiscount)||0,bulkSavings:a.hasBulkDiscount?(a.price-a.effectivePrice)*a.quantity:0,wasAutoApplied:!!a.hasBulkDiscount}}),originalSubtotal:r.originalSubtotal,subtotal:r.subtotal,totalBulkSavings:r.totalBulkSavings,deliveryFee:r.deliveryFee,gst:r.gst,total:r.total,currency:"NZD",deliveryOption:f,specialInstructions:_,paymentMethod:o.method,paymentStatus:"pending",status:"pending",userId:l?null:(g==null?void 0:g.uid)||null,itemCount:N.reduce((a,m)=>a+m.quantity,0),hasBulkDiscounts:r.totalBulkSavings>0,bulkDiscountsAutoApplied:N.some(a=>a.hasBulkDiscount),country:"New Zealand",timezone:"Pacific/Auckland"},c=await $e(t);await new Promise(a=>setTimeout(a,2e3)),re(),k(l?`/guest-order-confirmation/${c}?email=${encodeURIComponent(d.email)}`:`/order-confirmation/${c}`)}catch(r){I(r.message||"Failed to place order. Please try again.")}finally{R(!1)}},u=Z();return e.jsx("div",{className:`min-h-screen ${s?"bg-gray-900 text-white":"bg-gray-50 text-gray-900"}`,children:e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("h1",{className:"text-4xl font-bold mb-4 flex items-center",children:[e.jsx(F,{className:"w-10 h-10 mr-3"}),l?"Guest Checkout":"Checkout"]}),l&&e.jsx("div",{className:`mb-6 p-6 rounded-xl ${s?"bg-blue-900/20 border-blue-800":"bg-blue-50 border-blue-200"} border`,children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"text-3xl mr-4",children:"🇳🇿"}),e.jsxs("div",{children:[e.jsx("h3",{className:`text-lg font-semibold ${s?"text-blue-300":"text-blue-800"} mb-2`,children:"Checking out as Guest"}),e.jsx("p",{className:`${s?"text-blue-200":"text-blue-700"}`,children:"Complete your purchase without creating an account. We'll send order updates to your email. All prices in NZD."})]})]})}),u.totalBulkSavings>0&&e.jsx("div",{className:`mb-6 p-6 rounded-xl ${s?"bg-green-900/20 border-green-800":"bg-green-50 border-green-200"} border`,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(P,{className:"w-8 h-8 mr-3 text-green-600"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("h3",{className:`text-lg font-semibold ${s?"text-green-300":"text-green-800"} mb-1`,children:["🎉 You're saving $",u.totalBulkSavings.toFixed(2)," NZD with auto-applied bulk pricing!"]}),e.jsx("p",{className:`${s?"text-green-200":"text-green-700"}`,children:"Bulk discounts have been automatically applied based on your quantities and will be maintained through checkout."})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:`text-sm font-medium ${s?"text-green-300":"text-green-700"}`,children:[N.filter(r=>r.hasBulkDiscount).length," items with bulk pricing"]}),e.jsx("div",{className:`text-xs ${s?"text-green-400":"text-green-600"}`,children:"Auto-applied at checkout"})]})]})}),e.jsx("div",{className:"flex items-center justify-center mb-6",children:(l?[{num:2,label:"Contact & Payment"},{num:3,label:"Review"}]:[{num:1,label:"Shipping"},{num:2,label:"Payment"},{num:3,label:"Review"}]).map((r,t)=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`flex items-center justify-center w-10 h-10 rounded-full font-semibold ${p>=r.num?"bg-indigo-600 text-white":s?"bg-gray-700 text-gray-400":"bg-gray-300 text-gray-600"}`,children:p>r.num?"✓":r.num}),e.jsx("span",{className:"ml-3 font-medium",children:r.label}),t<(l?1:2)&&e.jsx("div",{className:`w-20 h-1 mx-6 rounded ${p>r.num?"bg-indigo-600":s?"bg-gray-700":"bg-gray-300"}`})]},r.num))})]}),M&&e.jsx("div",{className:`mb-6 p-4 rounded-xl border-l-4 ${s?"bg-red-900/30 border-red-800 text-red-400":"bg-red-50 border-red-400 text-red-700"}`,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),M]})}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"xl:col-span-2",children:[!l&&p===1&&e.jsxs("div",{className:`${s?"bg-gray-800 border-gray-700":"bg-white border-gray-200"} rounded-2xl shadow-lg border p-8`,children:[e.jsxs("h2",{className:"text-2xl font-bold mb-6 flex items-center",children:[e.jsx(Se,{className:"w-6 h-6 mr-2"}),"Shipping Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm font-semibold mb-2 flex items-center",children:[e.jsx(E,{className:"w-4 h-4 mr-1"}),"First Name *"]}),e.jsx("input",{type:"text",value:n.firstName,onChange:r=>y("firstName",r.target.value),className:`w-full px-4 py-3 border rounded-xl ${i.firstName?"border-red-500 focus:border-red-500 focus:ring-red-500":s?"bg-gray-700 border-gray-600 text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent":"bg-white border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-transparent"}`,required:!0}),i.firstName&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.firstName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Last Name *"}),e.jsx("input",{type:"text",value:n.lastName,onChange:r=>y("lastName",r.target.value),className:`w-full px-4 py-3 border rounded-xl ${i.lastName?"border-red-500 focus:border-red-500 focus:ring-red-500":s?"bg-gray-700 border-gray-600 text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent":"bg-white border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-transparent"}`,required:!0}),i.lastName&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.lastName})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm font-semibold mb-2 flex items-center",children:[e.jsx(X,{className:"w-4 h-4 mr-1"}),"Email *"]}),e.jsx("input",{type:"email",value:n.email,onChange:r=>y("email",r.target.value),className:`w-full px-4 py-3 border rounded-xl ${i.email?"border-red-500 focus:border-red-500 focus:ring-red-500":s?"bg-gray-700 border-gray-600 text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent":"bg-white border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-transparent"}`,required:!0}),i.email&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.email})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm font-semibold mb-2 flex items-center",children:[e.jsx(ee,{className:"w-4 h-4 mr-1"}),"Phone *"]}),e.jsx("input",{type:"tel",value:n.phone,onChange:r=>y("phone",G(r.target.value)),placeholder:"021 234 5678",className:`w-full px-4 py-3 border rounded-xl ${i.phone?"border-red-500 focus:border-red-500 focus:ring-red-500":s?"bg-gray-700 border-gray-600 text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent":"bg-white border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-transparent"}`,required:!0}),i.phone&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.phone})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Street Address *"}),e.jsx("input",{type:"text",value:n.address,onChange:r=>y("address",r.target.value),placeholder:"123 Queen Street",className:`w-full px-4 py-3 border rounded-xl ${s?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"} focus:ring-2 focus:ring-indigo-500 focus:border-transparent`,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Suburb"}),e.jsx("input",{type:"text",value:n.suburb,onChange:r=>y("suburb",r.target.value),placeholder:"CBD",className:`w-full px-4 py-3 border rounded-xl ${s?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"} focus:ring-2 focus:ring-indigo-500 focus:border-transparent`})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"City *"}),e.jsx("input",{type:"text",value:n.city,onChange:r=>y("city",r.target.value),placeholder:"Auckland",className:`w-full px-4 py-3 border rounded-xl ${s?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"} focus:ring-2 focus:ring-indigo-500 focus:border-transparent`,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Region *"}),e.jsxs("select",{value:n.region,onChange:r=>y("region",r.target.value),className:`w-full px-4 py-3 border rounded-xl ${s?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"} focus:ring-2 focus:ring-indigo-500 focus:border-transparent`,required:!0,children:[e.jsx("option",{value:"",children:"Select Region"}),de.map(r=>e.jsx("option",{value:r,children:r},r))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Postcode *"}),e.jsx("input",{type:"text",value:n.postcode,onChange:r=>y("postcode",xe(r.target.value)),placeholder:"1010",maxLength:"4",className:`w-full px-4 py-3 border rounded-xl ${i.postcode?"border-red-500 focus:border-red-500 focus:ring-red-500":s?"bg-gray-700 border-gray-600 text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent":"bg-white border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-transparent"}`,required:!0}),i.postcode&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.postcode})]})]}),e.jsxs("div",{className:"mt-8",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[e.jsx(O,{className:"w-5 h-5 mr-2"}),"Delivery Options"]}),e.jsx("div",{className:"space-y-3",children:q.map(r=>e.jsxs("label",{className:`flex items-center p-4 border rounded-xl cursor-pointer transition-all ${f===r.id?s?"border-indigo-500 bg-indigo-900/20 shadow-lg":"border-indigo-500 bg-indigo-50 shadow-lg":s?"border-gray-600 hover:border-gray-500":"border-gray-300 hover:border-gray-400"}`,children:[e.jsx("input",{type:"radio",name:"delivery",value:r.id,checked:f===r.id,onChange:t=>D(t.target.value),className:"mr-4 w-5 h-5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold",children:r.name}),e.jsx("div",{className:`text-sm ${s?"text-gray-400":"text-gray-600"}`,children:r.description})]}),e.jsx("div",{className:"text-right",children:r.price===0?e.jsx("span",{className:"font-semibold text-green-600",children:"FREE"}):u.subtotal>=r.freeThreshold?e.jsxs("div",{children:[e.jsxs("span",{className:"line-through text-gray-400",children:["$",r.price.toFixed(2)]}),e.jsx("span",{className:"ml-2 font-semibold text-green-600",children:"FREE"})]}):e.jsxs("span",{className:"font-semibold",children:["$",r.price.toFixed(2)]})})]},r.id))})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Special Instructions (Optional)"}),e.jsx("textarea",{value:_,onChange:r=>ne(r.target.value),rows:"3",className:`w-full px-4 py-3 border rounded-xl ${s?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"} focus:ring-2 focus:ring-indigo-500 focus:border-transparent`,placeholder:"Leave at door, ring doorbell, etc..."})]})]}),p===2&&e.jsxs("div",{className:`${s?"bg-gray-800 border-gray-700":"bg-white border-gray-200"} rounded-2xl shadow-lg border p-8`,children:[e.jsxs("h2",{className:"text-2xl font-bold mb-6 flex items-center",children:[e.jsx(K,{className:"w-6 h-6 mr-2"}),l?"Contact & Payment Information":"Payment Information"]}),l&&e.jsxs("div",{className:"mb-8",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[e.jsx(E,{className:"w-5 h-5 mr-2"}),"Contact Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"First Name *"}),e.jsx("input",{type:"text",value:d.firstName,onChange:r=>C("firstName",r.target.value),className:`w-full px-4 py-3 border rounded-xl ${i.guestFirstName?"border-red-500 focus:border-red-500 focus:ring-red-500":s?"bg-gray-700 border-gray-600 text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent":"bg-white border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-transparent"}`,required:!0}),i.guestFirstName&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.guestFirstName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Last Name *"}),e.jsx("input",{type:"text",value:d.lastName,onChange:r=>C("lastName",r.target.value),className:`w-full px-4 py-3 border rounded-xl ${i.guestLastName?"border-red-500 focus:border-red-500 focus:ring-red-500":s?"bg-gray-700 border-gray-600 text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent":"bg-white border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-transparent"}`,required:!0}),i.guestLastName&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.guestLastName})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm font-semibold mb-2 flex items-center",children:[e.jsx(X,{className:"w-4 h-4 mr-1"}),"Email *"]}),e.jsx("input",{type:"email",value:d.email,onChange:r=>C("email",r.target.value),className:`w-full px-4 py-3 border rounded-xl ${i.guestEmail?"border-red-500 focus:border-red-500 focus:ring-red-500":s?"bg-gray-700 border-gray-600 text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent":"bg-white border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-transparent"}`,placeholder:"your.email@example.co.nz",required:!0}),i.guestEmail&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.guestEmail})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm font-semibold mb-2 flex items-center",children:[e.jsx(ee,{className:"w-4 h-4 mr-1"}),"Phone (Optional)"]}),e.jsx("input",{type:"tel",value:d.phone,onChange:r=>C("phone",G(r.target.value)),className:`w-full px-4 py-3 border rounded-xl ${i.guestPhone?"border-red-500 focus:border-red-500 focus:ring-red-500":s?"bg-gray-700 border-gray-600 text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent":"bg-white border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-transparent"}`,placeholder:"021 234 5678"}),i.guestPhone&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.guestPhone})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("h4",{className:"text-md font-semibold mb-3 flex items-center",children:[e.jsx(O,{className:"w-4 h-4 mr-1"}),"Delivery Method"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:`flex items-center p-4 border rounded-xl cursor-pointer transition-all ${f==="pickup"?s?"border-indigo-500 bg-indigo-900/20":"border-indigo-500 bg-indigo-50":s?"border-gray-600":"border-gray-300"}`,children:[e.jsx("input",{type:"radio",name:"delivery",value:"pickup",checked:f==="pickup",onChange:r=>D(r.target.value),className:"mr-3 w-5 h-5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold",children:"Click & Collect (Recommended)"}),e.jsx("div",{className:`text-sm ${s?"text-gray-400":"text-gray-600"}`,children:"Ready in 2-4 hours • FREE"})]}),e.jsx("span",{className:"font-semibold text-green-600",children:"FREE"})]}),e.jsxs("label",{className:`flex items-center p-4 border rounded-xl cursor-pointer transition-all ${f==="standard"?s?"border-indigo-500 bg-indigo-900/20":"border-indigo-500 bg-indigo-50":s?"border-gray-600":"border-gray-300"}`,children:[e.jsx("input",{type:"radio",name:"delivery",value:"standard",checked:f==="standard",onChange:r=>D(r.target.value),className:"mr-3 w-5 h-5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold",children:"Standard Delivery"}),e.jsx("div",{className:`text-sm ${s?"text-gray-400":"text-gray-600"}`,children:"3-5 business days across New Zealand"})]}),e.jsxs("span",{className:"font-semibold",children:["$",(U=q.find(r=>r.id==="standard"))==null?void 0:U.price.toFixed(2)]})]})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Choose Payment Method"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[{id:"credit_card",name:"Credit Card",icon:"💳",desc:"Visa, Mastercard"},{id:"debit_card",name:"Debit Card",icon:"💳",desc:"EFTPOS, Visa Debit"},{id:"bank_transfer",name:"Bank Transfer",icon:"🏦",desc:"Direct from bank"},{id:"afterpay",name:"Afterpay",icon:"💰",desc:"Buy now, pay later"},{id:"paypal",name:"PayPal",icon:"🅿️",desc:"PayPal account"}].map(r=>e.jsxs("label",{className:`flex items-center p-4 border rounded-xl cursor-pointer transition-all ${o.method===r.id?s?"border-indigo-500 bg-indigo-900/20":"border-indigo-500 bg-indigo-50":s?"border-gray-600 hover:border-gray-500":"border-gray-300 hover:border-gray-400"}`,children:[e.jsx("input",{type:"radio",name:"payment",value:r.id,checked:o.method===r.id,onChange:t=>v("method",t.target.value),className:"mr-3 w-5 h-5"}),e.jsx("span",{className:"mr-3 text-2xl",children:r.icon}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:r.name}),e.jsx("div",{className:`text-xs ${s?"text-gray-400":"text-gray-500"}`,children:r.desc})]})]},r.id))})]}),(o.method==="credit_card"||o.method==="debit_card")&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Name on Card *"}),e.jsx("input",{type:"text",value:o.nameOnCard,onChange:r=>v("nameOnCard",r.target.value),className:`w-full px-4 py-3 border rounded-xl ${i.nameOnCard?"border-red-500 focus:border-red-500 focus:ring-red-500":s?"bg-gray-700 border-gray-600 text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent":"bg-white border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-transparent"}`,required:!0}),i.nameOnCard&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.nameOnCard})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Card Number *"}),e.jsx("input",{type:"text",value:o.cardNumber,onChange:r=>v("cardNumber",ue(r.target.value)),placeholder:"1234 5678 9012 3456",maxLength:"19",className:`w-full px-4 py-3 border rounded-xl ${i.cardNumber?"border-red-500 focus:border-red-500 focus:ring-red-500":s?"bg-gray-700 border-gray-600 text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent":"bg-white border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-transparent"}`,required:!0}),i.cardNumber&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.cardNumber})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Expiry Date *"}),e.jsx("input",{type:"text",value:o.expiryDate,onChange:r=>v("expiryDate",ge(r.target.value)),placeholder:"MM/YY",maxLength:"5",className:`w-full px-4 py-3 border rounded-xl ${i.expiryDate?"border-red-500 focus:border-red-500 focus:ring-red-500":s?"bg-gray-700 border-gray-600 text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent":"bg-white border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-transparent"}`,required:!0}),i.expiryDate&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.expiryDate})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"CVV *"}),e.jsx("input",{type:"text",value:o.cvv,onChange:r=>v("cvv",r.target.value.replace(/\D/g,"")),placeholder:"123",maxLength:"4",className:`w-full px-4 py-3 border rounded-xl ${i.cvv?"border-red-500 focus:border-red-500 focus:ring-red-500":s?"bg-gray-700 border-gray-600 text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent":"bg-white border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-transparent"}`,required:!0}),i.cvv&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:i.cvv})]})]})]}),o.method==="afterpay"&&e.jsx("div",{className:`p-6 rounded-xl border-2 border-dashed ${s?"border-gray-600 bg-gray-700":"border-gray-300 bg-gray-50"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-4xl mb-3",children:"💰"}),e.jsx("p",{className:"font-semibold text-lg",children:"Afterpay Payment"}),e.jsx("p",{className:`text-sm ${s?"text-gray-400":"text-gray-600"} mt-1`,children:"Split your purchase into 4 equal payments, due every 2 weeks"}),e.jsx("div",{className:"mt-3 text-xs text-green-600 font-medium",children:"No interest if paid on time"})]})}),o.method==="bank_transfer"&&e.jsx("div",{className:`p-6 rounded-xl border-2 border-dashed ${s?"border-gray-600 bg-gray-700":"border-gray-300 bg-gray-50"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-4xl mb-3",children:"🏦"}),e.jsx("p",{className:"font-semibold text-lg",children:"Bank Transfer"}),e.jsx("p",{className:`text-sm ${s?"text-gray-400":"text-gray-600"} mt-1`,children:"Bank details will be provided after order confirmation"})]})})]}),p===3&&e.jsxs("div",{className:`${s?"bg-gray-800 border-gray-700":"bg-white border-gray-200"} rounded-2xl shadow-lg border p-8`,children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Review Your Order"}),e.jsx("div",{className:"space-y-4 mb-8",children:N.map(r=>{const t=r.effectivePrice||r.price,c=r.hasBulkDiscount,a=c?(r.price-t)*r.quantity:0;return e.jsxs("div",{className:`flex items-center space-x-4 p-4 border rounded-xl ${s?"border-gray-600":"border-gray-200"}`,children:[e.jsx("div",{className:"w-20 h-20 bg-gray-200 rounded-xl flex items-center justify-center overflow-hidden",children:r.imageUrl?e.jsx("img",{src:r.imageUrl,alt:r.name,className:"w-20 h-20 object-cover rounded-xl"}):e.jsx(F,{className:"w-8 h-8 text-gray-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-lg",children:r.name}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:`text-sm ${s?"text-gray-400":"text-gray-600"}`,children:["Qty: ",r.quantity," × $",t.toFixed(2),c&&e.jsxs("span",{className:"ml-2 text-green-600 font-medium",children:["(was $",r.price.toFixed(2),")"]})]}),c&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(P,{className:"w-3 h-3 text-green-600"}),e.jsxs("span",{className:"text-xs font-medium text-green-600",children:["Auto bulk discount: ",r.bulkPricing.bulkDiscount.toFixed(0),"% off • ",r.bulkPricing.bulkTier,"+ units"]})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"font-bold text-lg",children:["$",(t*r.quantity).toFixed(2)]}),a>0&&e.jsxs("div",{className:"text-sm text-green-600 font-medium",children:["Saved $",a.toFixed(2)]})]})]},r.id)})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold mb-3 flex items-center",children:[e.jsx(E,{className:"w-4 h-4 mr-1"}),"Contact Information"]}),e.jsx("div",{className:`p-4 rounded-xl ${s?"bg-gray-700":"bg-gray-50"}`,children:e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsx("div",{className:"font-medium",children:l?`${d.firstName} ${d.lastName}`:`${n.firstName} ${n.lastName}`}),e.jsx("div",{children:l?d.email:n.email}),(l?d.phone:n.phone)&&e.jsx("div",{children:l?d.phone:n.phone}),l&&e.jsxs("div",{className:`text-xs mt-2 px-2 py-1 rounded ${s?"bg-orange-900/30 text-orange-400":"bg-orange-100 text-orange-700"}`,children:["Guest Order • ID: ",L]})]})})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold mb-3 flex items-center",children:[e.jsx(K,{className:"w-4 h-4 mr-1"}),"Payment Method"]}),e.jsx("div",{className:`p-4 rounded-xl ${s?"bg-gray-700":"bg-gray-50"}`,children:e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsx("div",{className:"font-medium capitalize",children:o.method.replace("_"," ")}),o.cardNumber&&e.jsxs("div",{children:["•••• •••• •••• ",o.cardNumber.slice(-4)]}),e.jsx("div",{className:"text-xs text-green-600 font-medium",children:"All payments in NZD"})]})})]})]})]})]}),e.jsx("div",{className:"xl:col-span-1",children:e.jsxs("div",{className:`${s?"bg-gray-800 border-gray-700":"bg-white border-gray-200"} rounded-2xl shadow-lg border p-6 sticky top-4`,children:[e.jsxs("h3",{className:"text-xl font-bold mb-6 flex items-center",children:[e.jsx(F,{className:"w-6 h-6 mr-2"}),"Order Summary"]}),e.jsxs("div",{className:"space-y-4 mb-6",children:[u.totalBulkSavings>0&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:`${s?"text-gray-400":"text-gray-500"} line-through`,children:"Original subtotal:"}),e.jsxs("span",{className:`${s?"text-gray-400":"text-gray-500"} line-through`,children:["$",u.originalSubtotal.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{children:["Subtotal (",u.totalItems," items):"]}),e.jsxs("span",{className:"font-semibold",children:["$",u.subtotal.toFixed(2)]})]}),u.totalBulkSavings>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-green-600 font-medium flex items-center",children:[e.jsx(P,{className:"w-4 h-4 mr-1"}),"Auto Bulk Savings:"]}),e.jsxs("span",{className:"font-bold text-green-600",children:["-$",u.totalBulkSavings.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Delivery:"}),e.jsx("span",{children:u.deliveryFee===0?e.jsx("span",{className:"text-green-600 font-semibold",children:"FREE"}):`$${u.deliveryFee.toFixed(2)}`})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"GST (15%):"}),e.jsxs("span",{children:["$",u.gst.toFixed(2)]})]}),e.jsx("hr",{className:`${s?"border-gray-600":"border-gray-200"}`}),e.jsxs("div",{className:"flex justify-between text-xl font-bold",children:[e.jsx("span",{children:"Total (NZD):"}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{children:["$",u.total.toFixed(2)]}),u.totalBulkSavings>0&&e.jsxs("div",{className:"text-sm font-normal text-green-600",children:["You saved $",u.totalBulkSavings.toFixed(2),"!"]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[!l&&p===1&&e.jsx("button",{onClick:()=>{oe()&&$(2)},className:"w-full py-4 rounded-xl font-semibold text-lg transition-colors bg-indigo-600 text-white hover:bg-indigo-700 shadow-lg",children:"Continue to Payment"}),p===2&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>{const r=me(),t=l?ce():!0;r&&t&&$(3)},className:"w-full py-4 rounded-xl font-semibold text-lg transition-colors bg-indigo-600 text-white hover:bg-indigo-700 shadow-lg",children:"Review Order"}),!l&&e.jsx("button",{onClick:()=>$(1),className:`w-full py-3 rounded-xl font-medium border transition-colors ${s?"border-gray-600 text-gray-300 hover:bg-gray-700":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:"Back to Shipping"})]}),p===3&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:ye,disabled:S,className:`w-full py-4 rounded-xl font-semibold text-lg transition-colors ${S?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700 shadow-lg"} text-white`,children:S?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx(A,{className:"w-5 h-5 mr-2"}),l?"Complete Guest Order":"Place Order"]}),e.jsxs("div",{className:"text-sm font-normal mt-1",children:["$",u.total.toFixed(2)," NZD"]})]})}),e.jsx("button",{onClick:()=>$(2),className:`w-full py-3 rounded-xl font-medium border transition-colors ${s?"border-gray-600 text-gray-300 hover:bg-gray-700":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:"Back to Payment"})]}),Object.keys(i).length>0&&e.jsxs("div",{className:`mt-4 p-4 rounded-xl ${s?"bg-red-900/20 border-red-800":"bg-red-50 border-red-200"} border`,children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("svg",{className:"w-5 h-5 text-red-600 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),e.jsx("span",{className:"font-semibold text-red-600",children:"Please fix the following errors:"})]}),e.jsxs("div",{className:`text-sm space-y-1 ${s?"text-red-300":"text-red-600"}`,children:[Object.keys(i).length," field(s) need attention"]})]})]}),e.jsxs("div",{className:"mt-6 space-y-3",children:[e.jsxs("div",{className:`p-4 rounded-xl text-sm ${s?"bg-green-900/20 border-green-800":"bg-green-50 border-green-200"} border`,children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx(A,{className:"w-4 h-4 mr-2 text-green-600"}),e.jsx("span",{className:"font-semibold text-green-600",children:"Secure NZ Checkout"})]}),e.jsxs("div",{className:`text-xs space-y-1 ${s?"text-green-300":"text-green-600"}`,children:[e.jsx("div",{children:"• SSL encrypted & PCI compliant"}),e.jsx("div",{children:"• All prices include GST"}),e.jsx("div",{children:"• NZ consumer rights protected"}),u.totalBulkSavings>0&&e.jsx("div",{children:"• Auto bulk discounts applied"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[e.jsxs("div",{className:`p-3 rounded-xl ${s?"bg-gray-700":"bg-gray-50"}`,children:[e.jsx(A,{className:`w-5 h-5 mx-auto mb-1 ${s?"text-green-400":"text-green-600"}`}),e.jsx("div",{className:`text-xs font-medium ${s?"text-gray-300":"text-gray-700"}`,children:"Secure"})]}),e.jsxs("div",{className:`p-3 rounded-xl ${s?"bg-gray-700":"bg-gray-50"}`,children:[e.jsx(O,{className:`w-5 h-5 mx-auto mb-1 ${s?"text-blue-400":"text-blue-600"}`}),e.jsx("div",{className:`text-xs font-medium ${s?"text-gray-300":"text-gray-700"}`,children:"Fast Ship"})]}),e.jsxs("div",{className:`p-3 rounded-xl ${s?"bg-gray-700":"bg-gray-50"}`,children:[e.jsx(P,{className:`w-5 h-5 mx-auto mb-1 ${s?"text-purple-400":"text-purple-600"}`}),e.jsx("div",{className:`text-xs font-medium ${s?"text-gray-300":"text-gray-700"}`,children:"Auto Bulk"})]})]})]})]})})]})]})})};export{Me as default};
