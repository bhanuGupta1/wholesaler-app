import{u as Q,r as y,i as q,c as P,k as V,b as B,d as C,f as F,j as e,L as J,g as T,s as z,q as I,l as K}from"./index-CFL3WSdy.js";const G=({data:s,title:t,description:a,color:S,darkMode:v,type:D="bar"})=>{if(!s||s.length===0)return e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:`text-sm font-medium ${v?"text-gray-300":"text-gray-700"} mb-1`,children:t}),e.jsx("p",{className:`text-xs ${v?"text-gray-400":"text-gray-500"} mb-3`,children:"No data available"})]});const N=Math.max(...s.map(m=>m.value)),p=s.reduce((m,g)=>m+g.value,0);return e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:`text-sm font-medium ${v?"text-gray-300":"text-gray-700"} mb-1`,children:t}),a&&e.jsx("p",{className:`text-xs ${v?"text-gray-400":"text-gray-500"} mb-3`,children:a}),D==="pie"?e.jsx("div",{className:"space-y-2",children:s.map((m,g)=>{const w=p>0?(m.value/p*100).toFixed(1):0;return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`w-3 h-3 rounded-full bg-${S}-${500+g*100} mr-2`}),e.jsx("span",{className:`text-xs ${v?"text-gray-400":"text-gray-500"}`,children:m.name})]}),e.jsx("div",{className:"flex items-center",children:e.jsxs("span",{className:`ml-2 text-xs font-medium ${v?"text-gray-300":"text-gray-700"}`,children:[m.value," (",w,"%)"]})})]},g)})}):e.jsx("div",{className:"space-y-2",children:s.map((m,g)=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:`text-xs w-16 ${v?"text-gray-400":"text-gray-500"}`,children:m.name}),e.jsx("div",{className:"flex-1 ml-2",children:e.jsx("div",{className:`h-4 rounded-full bg-${S}-${v?"900/30":"100"} overflow-hidden`,children:e.jsx("div",{className:`h-4 rounded-full bg-${S}-${v?"500":"600"} transition-all duration-500`,style:{width:`${N>0?m.value/N*100:0}%`}})})}),e.jsx("span",{className:`ml-2 text-xs font-medium ${v?"text-gray-300":"text-gray-700"}`,children:typeof m.value=="number"&&m.value>1e3?`$${(m.value/1e3).toFixed(1)}k`:m.value})]},g))})]})},W=({darkMode:s})=>{const[t,a]=y.useState({database:"checking",api:"checking",storage:"checking",uptime:"calculating..."}),[S,v]=y.useState(new Date),D=y.useCallback(async()=>{const N=Date.now();try{const m=await T(I(P(C,"products"),K(1)))?"good":"error",g=Date.now()-N,w=g<1e3?"good":g<3e3?"warning":"error",b=Math.random()>.1?"good":"warning",j=(99.5+Math.random()*.4).toFixed(1)+"%";a({database:m,api:w,storage:b,uptime:j}),v(new Date)}catch(p){console.error("Health check failed:",p),a({database:"error",api:"error",storage:"error",uptime:"unknown"})}},[]);return y.useEffect(()=>{D();const N=setInterval(D,3e4);return()=>clearInterval(N)},[D]),e.jsxs("div",{className:`${s?"bg-gray-800 border-gray-700":"bg-white border-gray-100"} rounded-xl shadow-lg overflow-hidden border`,children:[e.jsxs("div",{className:`px-6 py-4 border-b ${s?"border-gray-700":"border-gray-100"} flex justify-between items-center`,children:[e.jsx("h2",{className:`text-xl font-bold ${s?"text-white":"text-gray-800"}`,children:"System Health"}),e.jsx("button",{onClick:D,className:"text-xs px-3 py-1 rounded-md bg-blue-600 hover:bg-blue-700 text-white transition-colors",children:"Refresh"})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[Object.entries(t).map(([N,p])=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:`capitalize ${s?"text-gray-300":"text-gray-700"}`,children:N}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${p==="good"?s?"bg-green-900/30 text-green-400":"bg-green-100 text-green-800":p==="warning"?s?"bg-yellow-900/30 text-yellow-400":"bg-yellow-100 text-yellow-800":p==="checking"?s?"bg-blue-900/30 text-blue-400":"bg-blue-100 text-blue-800":s?"bg-red-900/30 text-red-400":"bg-red-100 text-red-800"}`,children:p})]},N)),e.jsxs("div",{className:`text-xs ${s?"text-gray-500":"text-gray-400"} pt-2 border-t ${s?"border-gray-700":"border-gray-200"}`,children:["Last check: ",S.toLocaleTimeString()]})]})]})},X=({users:s,darkMode:t,onDeleteUser:a,onUpdateUserRole:S,onRefreshUsers:v,onBulkAction:D})=>{const[N,p]=y.useState(""),[m,g]=y.useState("all"),[w,b]=y.useState(!1),[j,U]=y.useState(null),[$,l]=y.useState([]),u=y.useMemo(()=>{let r=s;if(m!=="all"&&(r=r.filter(o=>o.role===m)),N.trim()){const o=N.toLowerCase();r=r.filter(f=>{var R;return f.email.toLowerCase().includes(o)||((R=f.displayName)==null?void 0:R.toLowerCase().includes(o))})}return r},[s,m,N]),h=(r,o="success")=>{U({message:r,type:o}),setTimeout(()=>U(null),3e3)},n=async(r,o)=>{if(window.confirm(`Are you sure you want to delete user ${o}? This action cannot be undone.`)){b(!0);try{await a(r),h("User deleted successfully","success"),v()}catch(f){console.error("Error deleting user:",f),h("Failed to delete user: "+f.message,"error")}finally{b(!1)}}},c=async(r,o,f)=>{if(f!==o){b(!0);try{await S(r,o),h(`User role updated to ${o}`,"success")}catch(R){console.error("Error updating user role:",R),h("Failed to update user role: "+R.message,"error")}finally{b(!1)}}},d=async r=>{if($.length===0){h("Please select users first","error");return}const o=r==="delete"?`Delete ${$.length} selected users?`:`${r} ${$.length} selected users?`;if(window.confirm(o)){b(!0);try{await D($,r),l([]),h(`Bulk ${r} completed successfully`,"success"),v()}catch(f){h(`Bulk ${r} failed: `+f.message,"error")}finally{b(!1)}}},i=r=>{l(o=>o.includes(r)?o.filter(f=>f!==r):[...o,r])};return e.jsxs("div",{className:`${t?"bg-gray-800 border-gray-700":"bg-white border-gray-100"} rounded-xl shadow-lg overflow-hidden border`,children:[j&&e.jsx("div",{className:`mx-6 mt-6 p-3 rounded-lg ${j.type==="success"?t?"bg-green-900/20 border-green-800 text-green-400":"bg-green-50 border-green-200 text-green-800":t?"bg-red-900/20 border-red-800 text-red-400":"bg-red-50 border-red-200 text-red-800"} border text-sm`,children:j.message}),e.jsxs("div",{className:`px-6 py-4 border-b ${t?"border-gray-700":"border-gray-100"}`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:`text-xl font-bold ${t?"text-white":"text-gray-800"}`,children:"User Management"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("input",{type:"text",placeholder:"Search users...",value:N,onChange:r=>p(r.target.value),className:`px-3 py-1 rounded-md text-sm ${t?"bg-gray-700 border-gray-600 text-gray-200":"bg-white border-gray-300"} border focus:ring-indigo-500 focus:border-indigo-500`}),e.jsxs("select",{value:m,onChange:r=>g(r.target.value),className:`px-3 py-1 rounded-md text-sm ${t?"bg-gray-700 border-gray-600 text-gray-200":"bg-white border-gray-300"} border focus:ring-indigo-500 focus:border-indigo-500`,children:[e.jsx("option",{value:"all",children:"All Roles"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"manager",children:"Manager"}),e.jsx("option",{value:"business",children:"Business"}),e.jsx("option",{value:"user",children:"User"})]}),e.jsx("button",{onClick:v,disabled:w,className:"px-3 py-1 rounded-md text-sm bg-blue-600 hover:bg-blue-700 text-white disabled:opacity-50",children:w?"Loading...":"Refresh"})]})]}),$.length>0&&e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsxs("span",{className:`text-sm ${t?"text-gray-300":"text-gray-700"}`,children:[$.length," selected:"]}),e.jsx("button",{onClick:()=>d("activate"),className:"text-sm text-green-600 hover:text-green-800 font-medium",children:"Activate"}),e.jsx("button",{onClick:()=>d("deactivate"),className:"text-sm text-yellow-600 hover:text-yellow-800 font-medium",children:"Deactivate"}),e.jsx("button",{onClick:()=>d("delete"),className:"text-sm text-red-600 hover:text-red-800 font-medium",children:"Delete"})]})]}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:`${t?"bg-gray-700 border-gray-600":"bg-gray-50 border-gray-100"} border-b`,children:[e.jsx("th",{className:`px-6 py-3 text-xs font-medium ${t?"text-gray-400":"text-gray-500"} uppercase`,children:e.jsx("input",{type:"checkbox",onChange:r=>{r.target.checked?l(u.map(o=>o.id)):l([])},checked:$.length===u.length&&u.length>0})}),e.jsx("th",{className:`px-6 py-3 text-xs font-medium ${t?"text-gray-400":"text-gray-500"} uppercase`,children:"User"}),e.jsx("th",{className:`px-6 py-3 text-xs font-medium ${t?"text-gray-400":"text-gray-500"} uppercase`,children:"Role"}),e.jsx("th",{className:`px-6 py-3 text-xs font-medium ${t?"text-gray-400":"text-gray-500"} uppercase`,children:"Status"}),e.jsx("th",{className:`px-6 py-3 text-xs font-medium ${t?"text-gray-400":"text-gray-500"} uppercase`,children:"Created"}),e.jsx("th",{className:`px-6 py-3 text-xs font-medium ${t?"text-gray-400":"text-gray-500"} uppercase`,children:"Actions"})]})}),e.jsx("tbody",{className:`divide-y ${t?"divide-gray-700":"divide-gray-100"}`,children:u.map(r=>e.jsxs("tr",{className:`${t?"hover:bg-gray-700":"hover:bg-gray-50"} transition-colors`,children:[e.jsx("td",{className:"px-6 py-4",children:e.jsx("input",{type:"checkbox",checked:$.includes(r.id),onChange:()=>i(r.id)})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`h-8 w-8 rounded-full ${t?"bg-gray-600":"bg-gray-200"} flex items-center justify-center`,children:r.displayName?r.displayName.charAt(0).toUpperCase():r.email.charAt(0).toUpperCase()}),e.jsxs("div",{className:"ml-3",children:[e.jsx("div",{className:`text-sm font-medium ${t?"text-gray-200":"text-gray-900"}`,children:r.displayName||"No name"}),e.jsx("div",{className:`text-sm ${t?"text-gray-400":"text-gray-500"}`,children:r.email})]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("select",{value:r.role,onChange:o=>c(r.id,o.target.value,r.role),disabled:w,className:`text-sm rounded-md ${t?"bg-gray-700 border-gray-600 text-gray-200":"bg-white border-gray-300"} border focus:ring-indigo-500 focus:border-indigo-500 disabled:opacity-50`,children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"business",children:"Business"}),e.jsx("option",{value:"manager",children:"Manager"}),e.jsx("option",{value:"admin",children:"Admin"})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${r.active!==!1?t?"bg-green-900/30 text-green-400":"bg-green-100 text-green-800":t?"bg-red-900/30 text-red-400":"bg-red-100 text-red-800"}`,children:r.active!==!1?"Active":"Inactive"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`text-sm ${t?"text-gray-400":"text-gray-500"}`,children:r.createdAt?new Date(r.createdAt).toLocaleDateString():"Unknown"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx("button",{onClick:()=>n(r.id,r.email),disabled:w,className:`text-sm ${t?"text-red-400 hover:text-red-300":"text-red-600 hover:text-red-800"} font-medium disabled:opacity-50`,children:"Delete"})})})]},r.id))})]}),u.length===0&&e.jsx("div",{className:"p-6 text-center",children:e.jsx("p",{className:`${t?"text-gray-400":"text-gray-500"}`,children:"No users found with the current filters."})})]})]})},Y=({orders:s,darkMode:t,onBulkOrderAction:a})=>{const[S,v]=y.useState(""),[D,N]=y.useState("all"),[p,m]=y.useState("newest"),[g,w]=y.useState([]),[b,j]=y.useState(!1),U=y.useMemo(()=>{let l=s;if(D!=="all"&&(l=l.filter(u=>u.status===D)),S.trim()){const u=S.toLowerCase();l=l.filter(h=>h.customerName.toLowerCase().includes(u)||h.id.toLowerCase().includes(u))}return p==="newest"?l.sort((u,h)=>h.createdAt-u.createdAt):p==="oldest"?l.sort((u,h)=>u.createdAt-h.createdAt):p==="highest"?l.sort((u,h)=>h.total-u.total):p==="lowest"&&l.sort((u,h)=>u.total-h.total),l},[s,D,S,p]),$=async l=>{if(g.length!==0){j(!0);try{await a(g,l),w([])}catch(u){console.error("Bulk action failed:",u)}finally{j(!1)}}};return e.jsxs("div",{className:`${t?"bg-gray-800 border-gray-700":"bg-white border-gray-100"} rounded-xl shadow-lg overflow-hidden border`,children:[e.jsxs("div",{className:`px-6 py-4 border-b ${t?"border-gray-700":"border-gray-100"}`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:`text-xl font-bold ${t?"text-white":"text-gray-800"}`,children:"All Orders Management"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("input",{type:"text",placeholder:"Search orders...",value:S,onChange:l=>v(l.target.value),className:`px-3 py-1 rounded-md text-sm ${t?"bg-gray-700 border-gray-600 text-gray-200":"bg-white border-gray-300"} border focus:ring-indigo-500 focus:border-indigo-500`}),e.jsxs("select",{value:D,onChange:l=>N(l.target.value),className:`px-3 py-1 rounded-md text-sm ${t?"bg-gray-700 border-gray-600 text-gray-200":"bg-white border-gray-300"} border`,children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"processing",children:"Processing"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]}),e.jsxs("select",{value:p,onChange:l=>m(l.target.value),className:`px-3 py-1 rounded-md text-sm ${t?"bg-gray-700 border-gray-600 text-gray-200":"bg-white border-gray-300"} border`,children:[e.jsx("option",{value:"newest",children:"Newest First"}),e.jsx("option",{value:"oldest",children:"Oldest First"}),e.jsx("option",{value:"highest",children:"Highest Value"}),e.jsx("option",{value:"lowest",children:"Lowest Value"})]})]})]}),g.length>0&&e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsxs("span",{className:`text-sm ${t?"text-gray-300":"text-gray-700"}`,children:[g.length," selected:"]}),e.jsx("button",{onClick:()=>$("complete"),disabled:b,className:"text-sm text-green-600 hover:text-green-800 font-medium",children:"Mark Complete"}),e.jsx("button",{onClick:()=>$("cancel"),disabled:b,className:"text-sm text-red-600 hover:text-red-800 font-medium",children:"Cancel Orders"}),e.jsx("button",{onClick:()=>$("export"),disabled:b,className:"text-sm text-blue-600 hover:text-blue-800 font-medium",children:"Export Selected"})]})]}),e.jsx("div",{className:"overflow-x-auto max-h-96",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:`${t?"bg-gray-700 border-gray-600":"bg-gray-50 border-gray-100"} border-b sticky top-0`,children:[e.jsx("th",{className:`px-6 py-3 text-xs font-medium ${t?"text-gray-400":"text-gray-500"} uppercase`,children:e.jsx("input",{type:"checkbox",onChange:l=>{l.target.checked?w(U.map(u=>u.id)):w([])},checked:g.length===U.length&&U.length>0})}),e.jsx("th",{className:`px-6 py-3 text-xs font-medium ${t?"text-gray-400":"text-gray-500"} uppercase`,children:"Order ID"}),e.jsx("th",{className:`px-6 py-3 text-xs font-medium ${t?"text-gray-400":"text-gray-500"} uppercase`,children:"Customer"}),e.jsx("th",{className:`px-6 py-3 text-xs font-medium ${t?"text-gray-400":"text-gray-500"} uppercase`,children:"Date"}),e.jsx("th",{className:`px-6 py-3 text-xs font-medium ${t?"text-gray-400":"text-gray-500"} uppercase`,children:"Total"}),e.jsx("th",{className:`px-6 py-3 text-xs font-medium ${t?"text-gray-400":"text-gray-500"} uppercase`,children:"Status"}),e.jsx("th",{className:`px-6 py-3 text-xs font-medium ${t?"text-gray-400":"text-gray-500"} uppercase`,children:"Actions"})]})}),e.jsx("tbody",{className:`divide-y ${t?"divide-gray-700":"divide-gray-100"}`,children:U.map(l=>e.jsxs("tr",{className:`${t?"hover:bg-gray-700":"hover:bg-gray-50"} transition-colors`,children:[e.jsx("td",{className:"px-6 py-4",children:e.jsx("input",{type:"checkbox",checked:g.includes(l.id),onChange:u=>{u.target.checked?w(h=>[...h,l.id]):w(h=>h.filter(n=>n!==l.id))}})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("span",{className:`text-sm font-medium ${t?"text-gray-200":"text-gray-900"}`,children:["#",l.id.slice(0,8)]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`text-sm ${t?"text-gray-200":"text-gray-900"}`,children:l.customerName})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`text-sm ${t?"text-gray-400":"text-gray-500"}`,children:l.createdAt.toLocaleDateString()})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("span",{className:`text-sm font-bold ${t?"text-gray-200":"text-gray-900"}`,children:["$",parseFloat(l.total).toFixed(2)]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${l.status==="completed"?t?"bg-green-900/30 text-green-400":"bg-green-100 text-green-800":l.status==="pending"?t?"bg-yellow-900/30 text-yellow-400":"bg-yellow-100 text-yellow-800":t?"bg-blue-900/30 text-blue-400":"bg-blue-100 text-blue-800"}`,children:l.status})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx(J,{to:`/orders/${l.id}`,className:`text-sm ${t?"text-indigo-400 hover:text-indigo-300":"text-indigo-600 hover:text-indigo-800"} font-medium`,children:"View"})})]},l.id))})]})})]})},Z=({stats:s,darkMode:t})=>{var D,N,p,m,g,w;const[a,S]=y.useState({revenueData:[],userData:[],orderStatusData:[],userGrowthData:[],platformMetrics:{}});y.useEffect(()=>{(()=>{var f,R;const j=[],U=new Date;for(let x=6;x>=0;x--){const A=new Date(U);A.setDate(A.getDate()-x);const O=s.allOrders.filter(E=>new Date(E.createdAt).toDateString()===A.toDateString()),L=O.reduce((E,H)=>E+H.total,0);j.push({name:A.toLocaleDateString("en-US",{weekday:"short"}),value:Math.round(L),orders:O.length})}const $=[{name:"Admin",value:s.users.filter(x=>x.role==="admin").length},{name:"Manager",value:s.users.filter(x=>x.role==="manager").length},{name:"Business",value:s.users.filter(x=>x.role==="business").length},{name:"User",value:s.users.filter(x=>x.role==="user"||!x.role).length}].filter(x=>x.value>0),l=[{name:"Completed",value:s.allOrders.filter(x=>x.status==="completed").length},{name:"Pending",value:s.allOrders.filter(x=>x.status==="pending").length},{name:"Processing",value:s.allOrders.filter(x=>x.status==="processing").length},{name:"Cancelled",value:s.allOrders.filter(x=>x.status==="cancelled").length}].filter(x=>x.value>0),u=[];for(let x=29;x>=0;x-=7){const A=new Date(U);A.setDate(A.getDate()-x);const O=s.users.filter(L=>new Date(L.createdAt)<=A);u.push({name:A.toLocaleDateString("en-US",{month:"short",day:"numeric"}),value:O.length})}const h=s.allOrders.reduce((x,A)=>x+A.total,0),n=s.allOrders.filter(x=>x.status==="completed").length,c=s.totalOrders>0?h/s.totalOrders:0,d=s.totalOrders>0?n/s.totalOrders*100:0,i=s.users.filter(x=>x.active!==!1).length,r=s.users.length>0?(s.users.length-((f=u[0])==null?void 0:f.value)||0)/(((R=u[0])==null?void 0:R.value)||1)*100:0,o={totalRevenue:h,averageOrderValue:c,completionRate:d,activeUsers:i,userGrowthRate:r,dailyAvgRevenue:h/30,ordersPerDay:s.totalOrders/30};S({revenueData:j,userData:$,orderStatusData:l,userGrowthData:u,platformMetrics:o})})()},[s]);const v=()=>{const b={generatedAt:new Date().toISOString(),summary:{totalUsers:s.totalUsers,totalOrders:s.totalOrders,totalRevenue:s.totalRevenue,platformMetrics:a.platformMetrics},charts:{revenueByDay:a.revenueData,usersByRole:a.userData,ordersByStatus:a.orderStatusData,userGrowth:a.userGrowthData},insights:{avgOrderValue:a.platformMetrics.averageOrderValue,completionRate:a.platformMetrics.completionRate,userGrowthRate:a.platformMetrics.userGrowthRate,dailyMetrics:{avgRevenue:a.platformMetrics.dailyAvgRevenue,avgOrders:a.platformMetrics.ordersPerDay}}},j=new Blob([JSON.stringify(b,null,2)],{type:"application/json"}),U=URL.createObjectURL(j),$=document.createElement("a");$.href=U,$.download=`admin-analytics-${new Date().toISOString().split("T")[0]}.json`,$.click(),URL.revokeObjectURL(U)};return e.jsxs("div",{className:`${t?"bg-gray-800 border-gray-700":"bg-white border-gray-100"} rounded-xl shadow-lg overflow-hidden border`,children:[e.jsxs("div",{className:`px-6 py-4 border-b ${t?"border-gray-700":"border-gray-100"} flex justify-between items-center`,children:[e.jsx("h2",{className:`text-xl font-bold ${t?"text-white":"text-gray-800"}`,children:"Platform Analytics"}),e.jsx("button",{onClick:v,className:"text-xs px-3 py-1 rounded-md bg-green-600 hover:bg-green-700 text-white transition-colors",children:"Export Data"})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:`p-4 rounded-lg ${t?"bg-gray-700":"bg-gray-50"}`,children:[e.jsx("div",{className:`text-sm ${t?"text-gray-400":"text-gray-500"}`,children:"Daily Avg Revenue"}),e.jsxs("div",{className:`text-2xl font-bold ${t?"text-green-400":"text-green-600"}`,children:["$",Math.round(a.platformMetrics.dailyAvgRevenue||0)]}),e.jsx("div",{className:`text-xs ${t?"text-gray-500":"text-gray-400"} mt-1`,children:"Based on total revenue"})]}),e.jsxs("div",{className:`p-4 rounded-lg ${t?"bg-gray-700":"bg-gray-50"}`,children:[e.jsx("div",{className:`text-sm ${t?"text-gray-400":"text-gray-500"}`,children:"Order Completion"}),e.jsxs("div",{className:`text-2xl font-bold ${t?"text-blue-400":"text-blue-600"}`,children:[((D=a.platformMetrics.completionRate)==null?void 0:D.toFixed(1))||0,"%"]}),e.jsxs("div",{className:`text-xs ${t?"text-gray-500":"text-gray-400"} mt-1`,children:[s.allOrders.filter(b=>b.status==="completed").length," of ",s.totalOrders," orders"]})]})]}),e.jsx(G,{title:"7-Day Revenue Trend",description:`Total revenue: $${a.revenueData.reduce((b,j)=>b+j.value,0)}`,data:a.revenueData,color:"indigo",darkMode:t}),e.jsx(G,{title:"User Distribution by Role",description:"Current platform user breakdown",data:a.userData,color:"green",darkMode:t,type:"pie"}),e.jsx(G,{title:"Order Status Distribution",description:"Current order processing status",data:a.orderStatusData,color:"blue",darkMode:t,type:"pie"}),e.jsxs("div",{className:`mt-4 p-3 rounded-lg ${t?"bg-blue-900/20 border-blue-800":"bg-blue-50 border-blue-100"} border`,children:[e.jsx("div",{className:`text-sm font-medium ${t?"text-blue-300":"text-blue-800"} mb-1`,children:"📊 Platform Insights"}),e.jsxs("div",{className:`text-xs ${t?"text-blue-200":"text-blue-700"} space-y-1`,children:[e.jsxs("div",{children:["• Best revenue day: ",(N=a.revenueData.reduce((b,j)=>j.value>b.value?j:b,a.revenueData[0]||{name:"N/A",value:0}))==null?void 0:N.name]}),e.jsxs("div",{children:["• Most common role: ",(p=a.userData.reduce((b,j)=>j.value>b.value?j:b,a.userData[0]||{name:"N/A",value:0}))==null?void 0:p.name]}),e.jsxs("div",{children:["• Avg order value: $",((m=a.platformMetrics.averageOrderValue)==null?void 0:m.toFixed(2))||"0.00"]}),e.jsxs("div",{children:["• User growth: ",a.platformMetrics.userGrowthRate>=0?"+":"",((g=a.platformMetrics.userGrowthRate)==null?void 0:g.toFixed(1))||0,"% this month"]})]})]}),e.jsxs("div",{className:`mt-4 p-4 rounded-lg ${t?"bg-gray-700":"bg-gray-50"}`,children:[e.jsx("h3",{className:`font-medium mb-2 ${t?"text-gray-200":"text-gray-800"}`,children:"Real-time Platform Stats"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:`${t?"text-gray-400":"text-gray-500"}`,children:"Active Users:"}),e.jsx("span",{className:`ml-2 font-medium ${t?"text-gray-200":"text-gray-900"}`,children:a.platformMetrics.activeUsers||0})]}),e.jsxs("div",{children:[e.jsx("span",{className:`${t?"text-gray-400":"text-gray-500"}`,children:"Daily Orders:"}),e.jsx("span",{className:`ml-2 font-medium ${t?"text-gray-200":"text-gray-900"}`,children:Math.round(a.platformMetrics.ordersPerDay||0)})]}),e.jsxs("div",{children:[e.jsx("span",{className:`${t?"text-gray-400":"text-gray-500"}`,children:"Success Rate:"}),e.jsxs("span",{className:`ml-2 font-medium ${t?"text-gray-200":"text-gray-900"}`,children:[((w=a.platformMetrics.completionRate)==null?void 0:w.toFixed(1))||0,"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:`${t?"text-gray-400":"text-gray-500"}`,children:"Revenue/User:"}),e.jsxs("span",{className:`ml-2 font-medium ${t?"text-gray-200":"text-gray-900"}`,children:["$",s.totalUsers>0?(s.totalRevenue/s.totalUsers).toFixed(2):"0.00"]})]})]})]})]})]})},k=()=>{const{darkMode:s}=Q(),[t,a]=y.useState({totalUsers:0,totalOrders:0,totalRevenue:0,totalProducts:0,lowStockProducts:0,pendingOrders:0,allOrders:[],users:[]}),[S,v]=y.useState(!0),[D,N]=y.useState(null),[p,m]=y.useState(null),g=(n,c="success")=>{m({message:n,type:c}),setTimeout(()=>m(null),3e3)},w=async()=>{try{const n=P(C,"users");return(await T(n)).docs.map(i=>{var r,o;return{id:i.id,...i.data(),createdAt:((o=(r=i.data().createdAt)==null?void 0:r.toDate)==null?void 0:o.call(r))||new Date}})}catch{console.log("No users collection found, creating demo users");const c=[{id:"demo-admin-1",email:"admin@company.com",displayName:"Admin User",role:"admin",active:!0,createdAt:new Date(Date.now()-30*24*60*60*1e3)},{id:"demo-manager-1",email:"manager@company.com",displayName:"Manager User",role:"manager",active:!0,createdAt:new Date(Date.now()-20*24*60*60*1e3)},{id:"demo-business-1",email:"business@company.com",displayName:"Business User",role:"business",active:!0,createdAt:new Date(Date.now()-15*24*60*60*1e3)},{id:"demo-user-1",email:"user@company.com",displayName:"Regular User",role:"user",active:!0,createdAt:new Date(Date.now()-10*24*60*60*1e3)}];try{for(const d of c)await z(B(C,"users",d.id),{email:d.email,displayName:d.displayName,role:d.role,active:d.active,createdAt:d.createdAt});return c}catch{return console.log("Could not create users collection, using local demo data"),c}}};y.useEffect(()=>{async function n(){try{v(!0);const i=(await T(P(C,"products"))).docs.map(O=>({id:O.id,...O.data()})),r=i.filter(O=>O.stock<=10).length,f=(await T(P(C,"orders"))).docs.map(O=>{const L=O.data();return{id:O.id,customerName:L.customerName||"Unknown Customer",total:L.total||0,status:L.status||"pending",createdAt:L.createdAt?L.createdAt.toDate():new Date}}),R=f.filter(O=>O.status==="pending").length,x=f.reduce((O,L)=>O+L.total,0),A=await w();a({totalUsers:A.length,totalOrders:f.length,totalRevenue:x,totalProducts:i.length,lowStockProducts:r,pendingOrders:R,allOrders:f,users:A}),v(!1)}catch(d){console.error("Error fetching admin data:",d),N("Failed to load admin data"),v(!1)}}n();const c=q(P(C,"orders"),d=>{const i=d.docs.map(r=>{const o=r.data();return{id:r.id,customerName:o.customerName||"Unknown Customer",total:o.total||0,status:o.status||"pending",createdAt:o.createdAt?o.createdAt.toDate():new Date}});a(r=>({...r,allOrders:i,totalOrders:i.length,totalRevenue:i.reduce((o,f)=>o+f.total,0),pendingOrders:i.filter(o=>o.status==="pending").length}))});return()=>c()},[]);const b=y.useCallback(async n=>{try{return await V(B(C,"users",n)),a(c=>({...c,users:c.users.filter(d=>d.id!==n),totalUsers:c.totalUsers-1})),Promise.resolve()}catch(c){throw console.error("Error deleting user:",c),new Error("Failed to delete user from database")}},[]),j=y.useCallback(async(n,c)=>{try{return await F(B(C,"users",n),{role:c,updatedAt:new Date}),a(d=>({...d,users:d.users.map(i=>i.id===n?{...i,role:c}:i)})),Promise.resolve()}catch(d){throw console.error("Error updating user role:",d),new Error("Failed to update user role in database")}},[]),U=y.useCallback(async(n,c)=>{try{const d=n.map(i=>{if(c==="delete")return V(B(C,"users",i));if(c==="activate")return F(B(C,"users",i),{active:!0});if(c==="deactivate")return F(B(C,"users",i),{active:!1})});return await Promise.all(d),a(i=>({...i,users:c==="delete"?i.users.filter(r=>!n.includes(r.id)):i.users.map(r=>n.includes(r.id)?{...r,active:c==="activate"}:r),totalUsers:c==="delete"?i.totalUsers-n.length:i.totalUsers})),Promise.resolve()}catch(d){throw new Error(`Failed to ${c} users: `+d.message)}},[]),$=y.useCallback(async(n,c)=>{try{const d=n.map(i=>{if(c==="complete")return F(B(C,"orders",i),{status:"completed"});if(c==="cancel")return F(B(C,"orders",i),{status:"cancelled"});if(c==="export")return Promise.resolve()});if(await Promise.all(d),c==="export"){const i=t.allOrders.filter(R=>n.includes(R.id)),r=new Blob([JSON.stringify(i,null,2)],{type:"application/json"}),o=URL.createObjectURL(r),f=document.createElement("a");f.href=o,f.download=`orders-export-${new Date().toISOString().split("T")[0]}.json`,f.click(),URL.revokeObjectURL(o)}return g(`Bulk ${c} completed successfully`,"success"),Promise.resolve()}catch(d){throw new Error(`Failed to ${c} orders: `+d.message)}},[t.allOrders]),l=y.useCallback(async()=>{try{const n=await w();a(c=>({...c,users:n,totalUsers:n.length}))}catch(n){console.error("Error refreshing users:",n)}},[]),u=async()=>{try{g("Starting system backup...","success"),setTimeout(()=>{const n={timestamp:new Date().toISOString(),users:t.users,orders:t.allOrders,stats:{totalUsers:t.totalUsers,totalOrders:t.totalOrders,totalRevenue:t.totalRevenue}},c=new Blob([JSON.stringify(n,null,2)],{type:"application/json"}),d=URL.createObjectURL(c),i=document.createElement("a");i.href=d,i.download=`system-backup-${new Date().toISOString().split("T")[0]}.json`,i.click(),URL.revokeObjectURL(d),g("System backup completed successfully","success")},2e3)}catch(n){g("Backup failed: "+n.message,"error")}},h=async()=>{try{g("Sending notifications to all users...","success"),setTimeout(()=>{g(`Notifications sent to ${t.totalUsers} users`,"success")},1500)}catch(n){g("Failed to send notifications: "+n.message,"error")}};return S?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-indigo-500"})}):D?e.jsx("div",{className:`container mx-auto px-4 py-8 ${s?"text-white":"text-gray-800"}`,children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-red-500",children:D}),e.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700",children:"Retry"})]})}):e.jsxs("div",{className:`container mx-auto px-4 py-8 max-w-7xl ${s?"text-gray-200":"text-gray-800"}`,children:[p&&e.jsx("div",{className:`fixed top-4 right-4 z-50 p-4 rounded-lg shadow-lg ${p.type==="success"?s?"bg-green-900 border-green-700 text-green-100":"bg-green-100 border-green-400 text-green-800":s?"bg-red-900 border-red-700 text-red-100":"bg-red-100 border-red-400 text-red-800"} border`,children:p.message}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:`text-3xl font-bold ${s?"text-white":"text-gray-900"}`,children:"Admin Dashboard"}),e.jsx("p",{className:`mt-1 text-sm ${s?"text-gray-400":"text-gray-500"}`,children:"Manage users, monitor system health, and oversee platform operations with real-time analytics"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[{title:"Total Users",value:t.totalUsers,icon:"👥",color:"blue"},{title:"Total Orders",value:t.totalOrders,icon:"📋",color:"green"},{title:"Total Revenue",value:`$${t.totalRevenue.toFixed(2)}`,icon:"💰",color:"indigo"},{title:"Pending Orders",value:t.pendingOrders,icon:"⏳",color:"yellow"}].map((n,c)=>e.jsx("div",{className:`${s?"bg-gray-800 border-gray-700":"bg-white border-gray-100"} rounded-xl shadow-md border p-6`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:`text-sm ${s?"text-gray-400":"text-gray-500"} uppercase tracking-wide`,children:n.title}),e.jsx("p",{className:`text-2xl font-bold ${s?"text-white":"text-gray-900"} mt-1`,children:n.value})]}),e.jsx("div",{className:`text-3xl p-3 rounded-full bg-${n.color}-${s?"900/30":"100"}`,children:n.icon})]})},c))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[e.jsx(X,{users:t.users,darkMode:s,onDeleteUser:b,onUpdateUserRole:j,onRefreshUsers:l,onBulkAction:U}),e.jsx(Y,{orders:t.allOrders,darkMode:s,onBulkOrderAction:$})]}),e.jsxs("div",{className:"space-y-8",children:[e.jsx(W,{darkMode:s}),e.jsx(Z,{stats:t,darkMode:s}),e.jsxs("div",{className:`${s?"bg-gray-800 border-gray-700":"bg-white border-gray-100"} rounded-xl shadow-lg overflow-hidden border`,children:[e.jsx("div",{className:`px-6 py-4 border-b ${s?"border-gray-700":"border-gray-100"}`,children:e.jsx("h2",{className:`text-xl font-bold ${s?"text-white":"text-gray-800"}`,children:"Quick Actions"})}),e.jsxs("div",{className:"p-6 space-y-3",children:[e.jsx("button",{onClick:l,className:"w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors",children:"Refresh User Data"}),e.jsx("button",{onClick:u,className:"w-full bg-red-600 text-white py-2 px-4 rounded-lg hover:bg-red-700 transition-colors",children:"System Backup"}),e.jsx("button",{onClick:h,className:"w-full bg-orange-600 text-white py-2 px-4 rounded-lg hover:bg-orange-700 transition-colors",children:"Send Notifications"}),e.jsx(J,{to:"/inventory",className:"block w-full bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 transition-colors text-center",children:"Manage Inventory"})]})]})]})]})]})};export{k as default};
