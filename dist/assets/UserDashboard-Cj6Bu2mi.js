import{u as W,e as Y,r as j,j as e,L as h,c as v,d as N,q as f,w as D,o as O,g as w,l as H}from"./index-CFL3WSdy.js";const P=({data:r,title:t,description:s,color:l,darkMode:d})=>{const g=Math.max(...r.map(c=>c.value));return e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:`text-sm font-medium ${d?"text-gray-300":"text-gray-700"} mb-1`,children:t}),s&&e.jsx("p",{className:`text-xs ${d?"text-gray-400":"text-gray-500"} mb-3`,children:s}),e.jsx("div",{className:"space-y-2",children:r.map((c,y)=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:`text-xs w-16 ${d?"text-gray-400":"text-gray-500"}`,children:c.name}),e.jsx("div",{className:"flex-1 ml-2",children:e.jsx("div",{className:`h-4 rounded-full bg-${l}-${d?"900/30":"100"} overflow-hidden`,children:e.jsx("div",{className:`h-4 rounded-full bg-${l}-${d?"500":"600"}`,style:{width:`${c.value/g*100}%`}})})}),e.jsxs("span",{className:`ml-2 text-xs font-medium ${d?"text-gray-300":"text-gray-700"}`,children:["$",c.value]})]},y))})]})},T=({orders:r,darkMode:t})=>e.jsxs("div",{className:`${t?"bg-gray-800 border-gray-700":"bg-white border-gray-100"} rounded-xl shadow-lg overflow-hidden border`,children:[e.jsx("div",{className:`px-6 py-4 border-b ${t?"border-gray-700":"border-gray-100"}`,children:e.jsx("h2",{className:`text-xl font-bold ${t?"text-white":"text-gray-800"}`,children:"Your Recent Orders"})}),r.length>0?e.jsx("div",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:r.slice(0,5).map(s=>e.jsx("div",{className:"p-6 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:`font-medium ${t?"text-gray-200":"text-gray-900"}`,children:["Order #",s.id.slice(0,8)]}),e.jsx("span",{className:`ml-3 px-2 py-1 rounded-full text-xs font-medium ${s.status==="completed"?t?"bg-green-900/30 text-green-400":"bg-green-100 text-green-800":s.status==="pending"?t?"bg-yellow-900/30 text-yellow-400":"bg-yellow-100 text-yellow-800":s.status==="processing"?t?"bg-blue-900/30 text-blue-400":"bg-blue-100 text-blue-800":t?"bg-red-900/30 text-red-400":"bg-red-100 text-red-800"}`,children:s.status})]}),e.jsxs("div",{className:`text-sm ${t?"text-gray-400":"text-gray-500"} mt-1`,children:[s.createdAt.toLocaleDateString()," • ",s.itemCount||0," items"]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("span",{className:`text-lg font-bold ${t?"text-gray-200":"text-gray-900"}`,children:["$",parseFloat(s.total).toFixed(2)]}),e.jsx(h,{to:`/orders/${s.id}`,className:`text-sm ${t?"text-indigo-400 hover:text-indigo-300":"text-indigo-600 hover:text-indigo-800"} font-medium`,children:"View Details"})]})]})},s.id))}):e.jsxs("div",{className:"p-12 text-center",children:[e.jsx("div",{className:`text-4xl mb-4 ${t?"text-gray-600":"text-gray-400"}`,children:"🛒"}),e.jsx("h3",{className:`text-lg font-medium ${t?"text-gray-300":"text-gray-900"} mb-2`,children:"No orders yet"}),e.jsx("p",{className:`${t?"text-gray-400":"text-gray-500"} mb-4`,children:"You haven't placed any orders yet. Start shopping to see your orders here!"}),e.jsx(h,{to:"/products",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700",children:"Start Shopping"})]}),r.length>0&&e.jsx("div",{className:`border-t ${t?"border-gray-700 bg-gray-700":"border-gray-100 bg-gray-50"} px-6 py-3`,children:e.jsxs(h,{to:"/orders",className:`text-sm font-medium ${t?"text-indigo-400 hover:text-indigo-300":"text-indigo-600 hover:text-indigo-800"} flex items-center justify-center`,children:["View All Your Orders",e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"ml-1 h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})})]}),U=({stats:r,darkMode:t})=>{const l=(()=>{const d=["Jan","Feb","Mar","Apr","May","Jun"],g=r.totalSpent/6;return d.map((c,y)=>({name:c,value:Math.round(g*(.5+Math.random()))}))})();return e.jsxs("div",{className:`${t?"bg-gray-800 border-gray-700":"bg-white border-gray-100"} rounded-xl shadow-lg overflow-hidden border`,children:[e.jsx("div",{className:`px-6 py-4 border-b ${t?"border-gray-700":"border-gray-100"}`,children:e.jsx("h2",{className:`text-xl font-bold ${t?"text-white":"text-gray-800"}`,children:"Your Spending Analytics"})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:`p-4 rounded-lg ${t?"bg-gray-700":"bg-gray-50"}`,children:[e.jsx("div",{className:`text-sm ${t?"text-gray-400":"text-gray-500"}`,children:"Total Spent"}),e.jsxs("div",{className:`text-2xl font-bold ${t?"text-green-400":"text-green-600"}`,children:["$",r.totalSpent.toFixed(2)]})]}),e.jsxs("div",{className:`p-4 rounded-lg ${t?"bg-gray-700":"bg-gray-50"}`,children:[e.jsx("div",{className:`text-sm ${t?"text-gray-400":"text-gray-500"}`,children:"Avg Order"}),e.jsxs("div",{className:`text-2xl font-bold ${t?"text-blue-400":"text-blue-600"}`,children:["$",r.avgOrderValue.toFixed(2)]})]})]}),e.jsx(P,{title:"Monthly Spending",description:"Your spending over the last 6 months",data:l,color:"indigo",darkMode:t}),e.jsxs("div",{className:`mt-6 p-4 rounded-lg ${t?"bg-blue-900/20 border-blue-800":"bg-blue-50 border-blue-100"} border`,children:[e.jsx("h3",{className:`font-semibold mb-2 ${t?"text-blue-300":"text-blue-800"}`,children:"💡 Your Shopping Insights"}),e.jsxs("ul",{className:`text-sm space-y-1 ${t?"text-blue-200":"text-blue-700"}`,children:[e.jsxs("li",{children:["• You've placed ",r.totalOrders," order",r.totalOrders!==1?"s":""," so far"]}),e.jsxs("li",{children:["• Your average order value is $",r.avgOrderValue.toFixed(2)]}),e.jsxs("li",{children:["• ",r.completedOrders," of your orders have been completed"]})]})]})]})]})},Q=({darkMode:r})=>{const t=[{id:"browse-products",to:"/products",name:"Browse Products",description:"Explore our catalog",icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),color:"blue"},{id:"view-cart",to:"/cart",name:"Shopping Cart",description:"Review your items",icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-1.5 2.5M7 13h.01M17 13v6a2 2 0 01-2 2H9a2 2 0 01-2-2v-6m8 0v-3a4 4 0 00-8 0v3m8 0H7"})}),color:"green"},{id:"order-history",to:"/orders",name:"Order History",description:"Track your orders",icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})}),color:"purple"},{id:"account-settings",to:"/profile",name:"Account Settings",description:"Manage your profile",icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),color:"orange"}];return e.jsxs("div",{className:`${r?"bg-gray-800 border-gray-700":"bg-white border-gray-100"} rounded-xl shadow-lg overflow-hidden border`,children:[e.jsx("div",{className:`px-6 py-4 border-b ${r?"border-gray-700":"border-gray-100"}`,children:e.jsx("h2",{className:`text-xl font-bold ${r?"text-white":"text-gray-800"}`,children:"Quick Actions"})}),e.jsx("div",{className:"p-5 grid grid-cols-2 gap-4",children:t.map(s=>e.jsxs(h,{to:s.to,className:`flex flex-col items-center p-4 rounded-xl 
              hover:bg-${s.color}-${r?"900/20":"50"} 
              transition-all duration-300 transform hover:scale-105
              group border ${r?`border-gray-700 hover:border-${s.color}-800`:`border-gray-100 hover:border-${s.color}-100`}`,children:[e.jsx("div",{className:`h-12 w-12 rounded-full ${r?`bg-${s.color}-900/30`:`bg-${s.color}-100`} 
              flex items-center justify-center mb-3 
              ${r?`group-hover:bg-${s.color}-900/50`:`group-hover:bg-${s.color}-200`} 
              transition-colors`,children:e.jsx("span",{className:`${r?`text-${s.color}-400`:`text-${s.color}-600`}`,children:s.icon})}),e.jsx("span",{className:`text-sm font-medium ${r?`text-gray-200 group-hover:text-${s.color}-400`:`text-gray-800 group-hover:text-${s.color}-700`}`,children:s.name}),e.jsx("span",{className:`text-xs ${r?"text-gray-400":"text-gray-500"} mt-1 text-center`,children:s.description})]},s.id))})]})},q=({products:r,darkMode:t})=>{const s=r.slice(0,3);return e.jsxs("div",{className:`${t?"bg-gray-800 border-gray-700":"bg-white border-gray-100"} rounded-xl shadow-lg overflow-hidden border`,children:[e.jsx("div",{className:`px-6 py-4 border-b ${t?"border-gray-700":"border-gray-100"}`,children:e.jsx("h2",{className:`text-xl font-bold ${t?"text-white":"text-gray-800"}`,children:"Featured Products"})}),s.length>0?e.jsx("div",{className:"p-5 space-y-4",children:s.map(l=>e.jsxs(h,{to:`/products/${l.id}`,className:`flex items-center p-4 rounded-xl 
                hover:bg-gray-${t?"700":"50"} 
                transition-all duration-300 border ${t?"border-gray-700":"border-gray-100"}`,children:[e.jsx("div",{className:"h-16 w-16 bg-gray-100 dark:bg-gray-700 rounded-lg overflow-hidden flex-shrink-0",children:l.imageUrl?e.jsx("img",{src:l.imageUrl,alt:l.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-200 dark:bg-gray-800",children:e.jsx("svg",{className:"h-6 w-6 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})})}),e.jsxs("div",{className:"ml-4 flex-1",children:[e.jsx("span",{className:`text-sm font-medium ${t?"text-gray-200":"text-gray-800"}`,children:l.name}),e.jsxs("div",{className:"flex justify-between mt-1",children:[e.jsx("span",{className:`text-xs ${t?"text-gray-400":"text-gray-500"}`,children:l.category}),e.jsxs("span",{className:`text-sm font-bold ${t?"text-indigo-400":"text-indigo-600"}`,children:["$",parseFloat(l.price).toFixed(2)]})]})]})]},l.id))}):e.jsx("div",{className:"p-6 text-center",children:e.jsx("p",{className:`${t?"text-gray-400":"text-gray-500"}`,children:"No featured products available."})}),e.jsx("div",{className:`border-t ${t?"border-gray-700 bg-gray-700":"border-gray-100 bg-gray-50"} px-6 py-3`,children:e.jsxs(h,{to:"/products",className:`text-sm font-medium ${t?"text-indigo-400 hover:text-indigo-300":"text-indigo-600 hover:text-indigo-800"} flex items-center justify-center`,children:["Browse all products",e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"ml-1 h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})})]})},I=()=>{var L,A;const{darkMode:r}=W(),{user:t}=Y(),[s,l]=j.useState({totalOrders:0,totalSpent:0,avgOrderValue:0,completedOrders:0,pendingOrders:0,userOrders:[],featuredProducts:[]}),[d,g]=j.useState(!0),[c,y]=j.useState(null);return j.useEffect(()=>{async function u(){var b;if(t)try{g(!0);let n=[];try{if(t.uid){const a=v(N,"orders"),m=f(a,D("userId","==",t.uid),O("createdAt","desc"));n=(await w(m)).docs.map(x=>{var i;const o=x.data();return{id:x.id,customerName:o.customerName||t.displayName||"You",total:o.total||0,status:o.status||"pending",itemCount:o.itemCount||0,createdAt:((i=o.createdAt)==null?void 0:i.toDate())||new Date}})}}catch(a){console.log("userId field not found or query failed, trying email approach:",a.message)}if(n.length===0&&t.email)try{const a=v(N,"orders"),m=f(a,D("userEmail","==",t.email),O("createdAt","desc"));n=(await w(m)).docs.map(x=>{var i;const o=x.data();return{id:x.id,customerName:o.customerName||t.displayName||"You",total:o.total||0,status:o.status||"pending",itemCount:o.itemCount||0,createdAt:((i=o.createdAt)==null?void 0:i.toDate())||new Date}})}catch(a){console.log("userEmail field not found or query failed, trying fallback approach:",a.message)}if(n.length===0)try{const a=v(N,"orders"),m=f(a,O("createdAt","desc")),x=(await w(m)).docs.map(i=>{var F;const p=i.data();return{id:i.id,customerName:p.customerName||"Unknown Customer",userEmail:p.userEmail||"",total:p.total||0,status:p.status||"pending",itemCount:p.itemCount||0,createdAt:((F=p.createdAt)==null?void 0:F.toDate())||new Date}}),o=t.displayName||((b=t.email)==null?void 0:b.split("@")[0])||"";n=x.filter(i=>i.userEmail===t.email||i.customerName.toLowerCase().includes(o.toLowerCase()))}catch(a){console.log("Fallback approach failed:",a.message)}const $=n.length,C=n.reduce((a,m)=>a+(m.total||0),0),B=$>0?C/$:0,V=n.filter(a=>a.status==="completed").length,R=n.filter(a=>a.status==="pending").length;let E=[];try{const a=v(N,"products"),m=f(a,H(6));E=(await w(m)).docs.map(x=>({id:x.id,...x.data()}))}catch(a){console.log("Failed to load featured products:",a.message)}l({totalOrders:$,totalSpent:C,avgOrderValue:B,completedOrders:V,pendingOrders:R,userOrders:n,featuredProducts:E}),g(!1)}catch(n){console.error("Error fetching user data:",n),y("Failed to load your dashboard data"),g(!1)}}u()},[t]),d?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-indigo-500"})}):c?e.jsx("div",{className:`container mx-auto px-4 py-8 ${r?"text-white":"text-gray-800"}`,children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-red-500",children:c}),e.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700",children:"Retry"})]})}):e.jsxs("div",{className:`container mx-auto px-4 py-8 max-w-7xl ${r?"text-gray-200":"text-gray-800"}`,children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("h1",{className:`text-3xl font-bold ${r?"text-white":"text-gray-900"}`,children:["Welcome back, ",(t==null?void 0:t.displayName)||((L=t==null?void 0:t.email)==null?void 0:L.split("@")[0])||"User","!"]}),e.jsx("p",{className:`mt-1 text-sm ${r?"text-gray-400":"text-gray-500"}`,children:"Here's your personal shopping dashboard and order history"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[{title:"Total Orders",value:s.totalOrders,icon:"📋",color:"blue"},{title:"Total Spent",value:`$${s.totalSpent.toFixed(2)}`,icon:"💰",color:"green"},{title:"Avg Order",value:`$${s.avgOrderValue.toFixed(2)}`,icon:"📊",color:"indigo"},{title:"Pending Orders",value:s.pendingOrders,icon:"⏳",color:"yellow"}].map((u,b)=>e.jsx("div",{className:`${r?"bg-gray-800 border-gray-700":"bg-white border-gray-100"} rounded-xl shadow-md border p-6`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:`text-sm ${r?"text-gray-400":"text-gray-500"} uppercase tracking-wide`,children:u.title}),e.jsx("p",{className:`text-2xl font-bold ${r?"text-white":"text-gray-900"} mt-1`,children:u.value})]}),e.jsx("div",{className:`text-3xl p-3 rounded-full bg-${u.color}-${r?"900/30":"100"}`,children:u.icon})]})},b))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[e.jsx(T,{orders:s.userOrders,darkMode:r}),e.jsx(U,{stats:s,darkMode:r})]}),e.jsxs("div",{className:"space-y-8",children:[e.jsx(Q,{darkMode:r}),e.jsx(q,{products:s.featuredProducts,darkMode:r}),e.jsxs("div",{className:`${r?"bg-gray-800 border-gray-700":"bg-white border-gray-100"} rounded-xl shadow-lg overflow-hidden border`,children:[e.jsx("div",{className:`px-6 py-4 border-b ${r?"border-gray-700":"border-gray-100"}`,children:e.jsx("h2",{className:`text-xl font-bold ${r?"text-white":"text-gray-800"}`,children:"Account Summary"})}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:`${r?"text-gray-400":"text-gray-500"}`,children:"Member since:"}),e.jsx("span",{className:`font-medium ${r?"text-gray-200":"text-gray-900"}`,children:(A=t==null?void 0:t.metadata)!=null&&A.creationTime?new Date(t.metadata.creationTime).toLocaleDateString():"Recently"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:`${r?"text-gray-400":"text-gray-500"}`,children:"Email:"}),e.jsx("span",{className:`font-medium ${r?"text-gray-200":"text-gray-900"}`,children:(t==null?void 0:t.email)||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:`${r?"text-gray-400":"text-gray-500"}`,children:"Order completion rate:"}),e.jsxs("span",{className:`font-medium ${r?"text-green-400":"text-green-600"}`,children:[s.totalOrders>0?Math.round(s.completedOrders/s.totalOrders*100):0,"%"]})]})]})})]})]})]}),s.totalOrders===0&&e.jsx("div",{className:`mt-8 p-6 rounded-lg ${r?"bg-blue-900/20 border-blue-800":"bg-blue-50 border-blue-200"} border`,children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:`h-6 w-6 ${r?"text-blue-400":"text-blue-600"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:`text-sm font-medium ${r?"text-blue-300":"text-blue-800"}`,children:"Welcome to your dashboard!"}),e.jsx("p",{className:`text-sm ${r?"text-blue-200":"text-blue-700"} mt-1`,children:"This is your personal space to track orders, view spending analytics, and manage your shopping experience. Start by browsing our products or checking out featured items."}),e.jsx("div",{className:"mt-3",children:e.jsx(h,{to:"/products",className:`text-sm font-medium ${r?"text-blue-300 hover:text-blue-200":"text-blue-700 hover:text-blue-600"} underline`,children:"Start shopping now →"})})]})]})})]})};export{I as default};
