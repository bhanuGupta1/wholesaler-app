import{K as M,r as i,j as e,L as c}from"./index-Cayz1xms.js";import{g as I}from"./orderService-Ckalb_W1.js";import{f as a}from"./format-CBpsKyOP.js";const T=()=>{var p,j,y,f;const{id:n}=M(),[t,g]=i.useState(null),[d,N]=i.useState([]),[b,o]=i.useState(!0),[x,m]=i.useState(null),h=i.useRef(null);i.useEffect(()=>{n&&(async()=>{try{o(!0),m(null),console.log("Fetching order for invoice:",n);const r=await I(n);console.log("Invoice - Fetched order:",r),g(r),N(r.items||[])}catch(r){console.error("Error fetching order details for invoice:",r),m(r.message)}finally{o(!1)}})()},[n]);const v=()=>{const s=h.current.innerHTML,r=document.body.innerHTML;document.body.innerHTML=s,window.print(),document.body.innerHTML=r,window.location.reload()},w=s=>{if(!s)return"-";try{return s.toDate&&typeof s.toDate=="function"?a(s.toDate(),"dd MMM yyyy"):s instanceof Date?a(s,"dd MMM yyyy"):typeof s=="string"?a(new Date(s),"dd MMM yyyy"):"-"}catch(r){return console.error("Error formatting date:",r),"-"}},l=()=>t.subtotal!==void 0&&t.subtotal!==null?t.subtotal:d.reduce((s,r)=>s+(r.price||0)*(r.quantity||0),0),u=()=>t.taxAmount!==void 0&&t.taxAmount!==null?t.taxAmount:l()*.1,A=()=>t.totalAmount||t.total?t.totalAmount||t.total:l()+u();return b?e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})}):x?e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4 text-red-800",children:"Error Loading Invoice"}),e.jsx("p",{className:"text-red-600 mb-4",children:x}),e.jsx(c,{to:"/orders",className:"text-indigo-600 hover:text-indigo-900",children:"← Back to Orders"})]})}):t?e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-6 flex justify-between items-center",children:[e.jsx(c,{to:`/orders/${n}`,className:"text-indigo-600 hover:text-indigo-900",children:"← Back to Order"}),e.jsx("button",{onClick:v,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Print Invoice"})]}),e.jsxs("div",{ref:h,className:"bg-white shadow rounded-lg overflow-hidden p-8",children:[e.jsxs("div",{className:"flex justify-between items-start mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"INVOICE"}),e.jsx("p",{className:"text-gray-500 mt-1",children:t.orderId||`#ORD-${n.substring(0,5)}`})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Wholesaler App"}),e.jsx("p",{className:"text-gray-500",children:"123 Business Street"}),e.jsx("p",{className:"text-gray-500",children:"Auckland, New Zealand"}),e.jsx("p",{className:"text-gray-500",children:"contact@wholesaler.com"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-8 mb-8",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-gray-500 font-medium mb-2",children:"Bill To:"}),e.jsx("p",{className:"font-medium",children:t.customerName||"N/A"}),e.jsx("p",{children:t.customerEmail||""}),e.jsx("p",{children:t.customerPhone||""}),e.jsx("p",{children:((p=t.billingAddress)==null?void 0:p.street)||""}),e.jsx("p",{children:(j=t.billingAddress)!=null&&j.city?`${t.billingAddress.city}, ${((y=t.billingAddress)==null?void 0:y.state)||""} ${((f=t.billingAddress)==null?void 0:f.zip)||""}`:""})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-gray-500 font-medium mb-2",children:"Invoice Details:"}),e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("span",{className:"text-gray-500",children:"Invoice Date:"}),e.jsx("span",{children:a(new Date,"dd MMM yyyy")})]}),e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("span",{className:"text-gray-500",children:"Order Date:"}),e.jsx("span",{children:w(t.dateCreated||t.createdAt)})]}),e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("span",{className:"text-gray-500",children:"Status:"}),e.jsx("span",{className:"capitalize",children:t.status||"pending"})]})]})]}),e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 mb-8",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Item"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Price"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Quantity"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:d.length>0?d.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-4",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.productName||"Unknown Product"})}),e.jsxs("td",{className:"px-4 py-4 text-right text-sm text-gray-500",children:["$",(s.price||0).toFixed(2)]}),e.jsx("td",{className:"px-4 py-4 text-right text-sm text-gray-500",children:s.quantity||0}),e.jsxs("td",{className:"px-4 py-4 text-right text-sm text-gray-900",children:["$",((s.price||0)*(s.quantity||0)).toFixed(2)]})]},s.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"px-4 py-4 text-center text-sm text-gray-500",children:"No items found for this order"})})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("div",{className:"w-64",children:[e.jsxs("div",{className:"flex justify-between py-2 border-t",children:[e.jsx("span",{className:"font-medium",children:"Subtotal:"}),e.jsxs("span",{children:["$",l().toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between py-2",children:[e.jsx("span",{className:"font-medium",children:"Tax:"}),e.jsxs("span",{children:["$",u().toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between py-2 font-bold text-lg border-t",children:[e.jsx("span",{children:"Total:"}),e.jsxs("span",{children:["$",A().toFixed(2)]})]})]})}),t.totalAmount||t.total?e.jsx("div",{className:"mt-4 text-right text-sm text-gray-500",children:e.jsxs("p",{children:["Order Total: $",(t.totalAmount||t.total).toFixed(2)]})}):null,e.jsxs("div",{className:"mt-8 text-center text-gray-500 text-sm",children:[e.jsx("p",{children:"Thank you for your business!"}),e.jsx("p",{children:"Payment is due within 30 days."})]})]})]}):e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Order not found"}),e.jsx(c,{to:"/orders",className:"text-indigo-600 hover:text-indigo-900",children:"← Back to Orders"})]})})};export{T as default};
