import{a as q,d as j,j as e}from"./index-DvFbKyhG.js";import{r as i}from"./vendor-DJ1oPbzn.js";import{q as L,c as k,w as E,b as $,g as B,e as I}from"./firebase-DMhjYMbV.js";import{M as v}from"./message-circle-CMdGYWn2.js";import{C as M}from"./circle-check-big-DU5H-gtP.js";import{c as w}from"./createLucideIcon-AIsR3Rz6.js";import{S as N}from"./star-D-4s30rK.js";/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Y=w("circle-alert",U);/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],O=w("send",_),K=()=>{const{user:l}=q(),[S,u]=i.useState(!1),[x,g]=i.useState(!1),[b,n]=i.useState(null),[F,h]=i.useState(!1),[y,C]=i.useState([]),[r,c]=i.useState({title:"",message:"",rating:0,category:"general",priority:"medium"}),D=[{value:"general",label:"General Feedback"},{value:"product",label:"Product Related"},{value:"service",label:"Customer Service"},{value:"website",label:"Website/App"},{value:"delivery",label:"Delivery & Shipping"},{value:"billing",label:"Billing & Payment"},{value:"suggestion",label:"Suggestion"},{value:"complaint",label:"Complaint"}],m=[{value:"low",label:"Low",color:"text-green-600"},{value:"medium",label:"Medium",color:"text-yellow-600"},{value:"high",label:"High",color:"text-red-600"}];i.useEffect(()=>{l&&p()},[l]);const p=async()=>{try{u(!0);const t=L(k(j,"feedbacks"),E("userId","==",l.uid),$("createdAt","desc")),d=(await B(t)).docs.map(s=>({id:s.id,...s.data()}));C(d)}catch(t){console.error("Error fetching feedbacks:",t),n("Failed to load your previous feedbacks")}finally{u(!1)}},o=t=>{const{name:a,value:d}=t.target;c(s=>({...s,[a]:d}))},A=t=>{c(a=>({...a,rating:t}))},P=async t=>{if(t.preventDefault(),!r.title.trim()||!r.message.trim()){n("Please fill in both title and message");return}if(r.rating===0){n("Please provide a rating");return}try{g(!0),n(null);const a={...r,userId:l.uid,userEmail:l.email,userName:l.displayName||l.email,createdAt:new Date,status:"pending",adminResponse:null,adminResponseAt:null};await I(k(j,"feedbacks"),a),c({title:"",message:"",rating:0,category:"general",priority:"medium"}),h(!0),setTimeout(()=>h(!1),5e3),p()}catch(a){console.error("Error submitting feedback:",a),n("Failed to submit feedback. Please try again.")}finally{g(!1)}},f=t=>t?(t.toDate?t.toDate():new Date(t)).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A",R=t=>{switch(t){case"pending":return"text-yellow-600 bg-yellow-100";case"reviewed":return"text-blue-600 bg-blue-100";case"resolved":return"text-green-600 bg-green-100";case"closed":return"text-gray-600 bg-gray-100";default:return"text-gray-600 bg-gray-100"}};return l?e.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Feedback & Support"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"We value your feedback! Help us improve our service by sharing your thoughts and experiences."})]}),F&&e.jsx("div",{className:"mb-6 p-4 bg-green-50 dark:bg-green-900/20 rounded-lg border border-green-200 dark:border-green-800",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(M,{className:"h-5 w-5 text-green-600 dark:text-green-400 mr-2"}),e.jsx("p",{className:"text-green-800 dark:text-green-200 font-medium",children:"Thank you! Your feedback has been submitted successfully."})]})}),b&&e.jsx("div",{className:"mb-6 p-4 bg-red-50 dark:bg-red-900/20 rounded-lg border border-red-200 dark:border-red-800",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Y,{className:"h-5 w-5 text-red-600 dark:text-red-400 mr-2"}),e.jsx("p",{className:"text-red-800 dark:text-red-200",children:b})]})}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 mb-8",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-6",children:"Submit New Feedback"}),e.jsxs("form",{onSubmit:P,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Title *"}),e.jsx("input",{type:"text",id:"title",name:"title",value:r.title,onChange:o,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:text-white",placeholder:"Brief summary of your feedback",maxLength:100,required:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"category",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Category"}),e.jsx("select",{id:"category",name:"category",value:r.category,onChange:o,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:text-white",children:D.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"priority",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Priority"}),e.jsx("select",{id:"priority",name:"priority",value:r.priority,onChange:o,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:text-white",children:m.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Overall Rating *"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[[1,2,3,4,5].map(t=>e.jsx("button",{type:"button",onClick:()=>A(t),className:"focus:outline-none",children:e.jsx(N,{className:`h-6 w-6 ${t<=r.rating?"text-yellow-400 fill-current":"text-gray-300 dark:text-gray-600"} hover:text-yellow-400 transition-colors`})},t)),e.jsx("span",{className:"ml-2 text-sm text-gray-600 dark:text-gray-400",children:r.rating>0?`${r.rating}/5`:"Click to rate"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"message",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Your Feedback *"}),e.jsx("textarea",{id:"message",name:"message",value:r.message,onChange:o,rows:5,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:text-white",placeholder:"Please provide detailed feedback about your experience...",maxLength:1e3,required:!0}),e.jsxs("p",{className:"mt-1 text-sm text-gray-500",children:[r.message.length,"/1000 characters"]})]}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:x,className:"w-full md:w-auto flex items-center justify-center px-6 py-3 border border-transparent text-base font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed",children:x?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Submitting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(O,{className:"h-4 w-4 mr-2"}),"Submit Feedback"]})})})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-6",children:"Your Previous Feedback"}),S?e.jsx("div",{className:"flex justify-center items-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})}):y.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(v,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"You haven't submitted any feedback yet."})]}):e.jsx("div",{className:"space-y-4",children:y.map(t=>{var a,d;return e.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:t.title}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${R(t.status)}`,children:t.status.charAt(0).toUpperCase()+t.status.slice(1)})]}),e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsxs("div",{className:"flex items-center mr-4",children:[[1,2,3,4,5].map(s=>e.jsx(N,{className:`h-4 w-4 ${s<=t.rating?"text-yellow-400 fill-current":"text-gray-300"}`},s)),e.jsxs("span",{className:"ml-1 text-sm text-gray-600 dark:text-gray-400",children:[t.rating,"/5"]})]}),e.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400 mr-4",children:t.category}),e.jsxs("span",{className:`text-sm font-medium ${(a=m.find(s=>s.value===t.priority))==null?void 0:a.color}`,children:[(d=m.find(s=>s.value===t.priority))==null?void 0:d.label," Priority"]})]}),e.jsx("p",{className:"text-gray-700 dark:text-gray-300 mb-2",children:t.message}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Submitted: ",f(t.createdAt)]}),t.adminResponse&&e.jsxs("div",{className:"mt-3 p-3 bg-blue-50 dark:bg-blue-900/20 rounded border-l-4 border-blue-400",children:[e.jsx("p",{className:"text-sm font-medium text-blue-800 dark:text-blue-200 mb-1",children:"Admin Response:"}),e.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:t.adminResponse}),e.jsx("p",{className:"text-xs text-blue-600 dark:te-*+blue-400 mt-1",children:f(t.adminResponseAt)})]})]},t.id)})})]})]}):e.jsx("div",{className:"p-6 max-w-4xl mx-auto",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(v,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-2",children:"Sign in Required"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Please log in to submit feedback or view your previous submissions."})]})})};export{K as default};
