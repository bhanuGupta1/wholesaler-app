import{c as M,d as j,a0 as w,m as _,q as y,w as N,k as z,l as G,a1 as ie,g as R,e as P,b as le,f as q,_ as ce,M as ne,a2 as V,a as oe,r as g,u as de,j as t}from"./index-Cayz1xms.js";class ue{constructor(){this.dealsRef=M(j,"deals"),this.dealsUsageRef=M(j,"deal_usage"),this.activityRef=M(j,"deal_activity")}async createDeal(e,a){try{this.validateDealData(e);const r={...e,discount:parseFloat(e.discount),minPurchase:e.minPurchase?parseFloat(e.minPurchase):0,maxUses:e.maxUses?parseInt(e.maxUses):null,currentUses:0,isActive:e.isActive??!0,createdBy:a,createdAt:w.now(),updatedAt:w.now(),expires:w.fromDate(new Date(e.expires))},c=await _(this.dealsRef,r);return await this.logDealActivity(c.id,"created",a),{success:!0,id:c.id}}catch(r){return console.error("Error creating deal:",r),{success:!1,error:r.message}}}async getDeals(e={}){try{let a=y(this.dealsRef);e.status==="active"?a=y(a,N("isActive","==",!0)):e.status==="inactive"&&(a=y(a,N("isActive","==",!1))),e.category&&(a=y(a,N("category","==",e.category)));const r=e.sortBy||"expires",c=e.sortDirection||"asc";return a=y(a,z(r,c)),e.limit&&(a=y(a,G(e.limit))),e.startAfter&&(a=y(a,ie(e.startAfter))),{success:!0,deals:(await R(a)).docs.map(i=>{var d,h;return{id:i.id,...i.data(),expires:(d=i.data().expires)==null?void 0:d.toDate(),createdAt:(h=i.data().createdAt)==null?void 0:h.toDate()}})}}catch(a){return console.error("Error fetching deals:",a),{success:!1,error:a.message}}}async updateDeal(e,a,r){try{const c=P(j,"deals",e),n={...a,updatedAt:w.now()};return a.expires&&typeof a.expires=="string"&&(n.expires=w.fromDate(new Date(a.expires))),await le(c,n),await this.logDealActivity(e,"updated",r,a),{success:!0}}catch(c){return console.error("Error updating deal:",c),{success:!1,error:c.message}}}async deleteDeal(e,a){try{const r=q(j),c=P(j,"deals",e);r.delete(c);const n=y(this.dealsUsageRef,N("dealId","==",e));return(await R(n)).docs.forEach(i=>{r.delete(i.ref)}),await r.commit(),await this.logDealActivity(e,"deleted",a),{success:!0}}catch(r){return console.error("Error deleting deal:",r),{success:!1,error:r.message}}}subscribeToDeals(e,a={}){try{let r=y(this.dealsRef);const c=a.sortBy||"expires",n=a.sortDirection||"asc";return r=y(r,z(c,n)),a.status==="active"&&(r=y(r,N("isActive","==",!0))),ce(r,p=>{const i=p.docs.map(d=>{var h,D;return{id:d.id,...d.data(),expires:(h=d.data().expires)==null?void 0:h.toDate(),createdAt:(D=d.data().createdAt)==null?void 0:D.toDate()}});e(i)},p=>{console.error("Error in deals subscription:",p),e(null,p)})}catch(r){console.error("Error setting up subscription:",r),e(null,r)}}async applyDealToOrder(e,a,r,c){try{const n=P(j,"deals",e),p=await ne(n);if(!p.exists())return{success:!1,error:"Deal not found"};const i=p.data(),d=this.validateDealUsage(i,r);if(!d.valid)return{success:!1,error:d.error};const h=r*i.discount/100,D=r-h,C=q(j),S=P(this.dealsUsageRef);return C.set(S,{dealId:e,orderId:a,userId:c,originalAmount:r,discountAmount:h,finalAmount:D,usedAt:w.now()}),C.update(n,{currentUses:(i.currentUses||0)+1,updatedAt:w.now()}),await C.commit(),await this.logDealActivity(e,"applied",c,{orderId:a,orderAmount:r}),{success:!0,discountAmount:h,finalAmount:D,dealTitle:i.title}}catch(n){return console.error("Error applying deal:",n),{success:!1,error:n.message}}}validateDealUsage(e,a){var n;if(!e.isActive)return{valid:!1,error:"Deal is not active"};const r=new Date;return(((n=e.expires)==null?void 0:n.toDate())||new Date(e.expires))<=r?{valid:!1,error:"Deal has expired"}:e.minPurchase&&a<e.minPurchase?{valid:!1,error:`Minimum purchase amount is $${e.minPurchase}`}:e.maxUses&&e.currentUses>=e.maxUses?{valid:!1,error:"Deal usage limit reached"}:{valid:!0}}validateDealData(e){var r;if(!((r=e.title)!=null&&r.trim()))throw new Error("Deal title is required");if(!e.discount||e.discount<0||e.discount>100)throw new Error("Discount must be between 0 and 100");if(!e.expires)throw new Error("Expiry date is required");if(new Date(e.expires)<=new Date)throw new Error("Expiry date must be in the future");if(e.minPurchase&&e.minPurchase<0)throw new Error("Minimum purchase amount cannot be negative");if(e.maxUses&&e.maxUses<1)throw new Error("Maximum uses must be at least 1")}async logDealActivity(e,a,r,c={}){try{await _(this.activityRef,{dealId:e,action:a,userId:r,metadata:c,timestamp:w.now()})}catch(n){console.error("Error logging deal activity:",n)}}async getDealAnalytics(e){try{const a=y(this.dealsUsageRef,N("dealId","==",e)),c=(await R(a)).docs.map(i=>{var d;return{id:i.id,...i.data(),usedAt:(d=i.data().usedAt)==null?void 0:d.toDate()}}),n=c.reduce((i,d)=>i+d.discountAmount,0),p=c.reduce((i,d)=>i+d.discountAmount,0);return{success:!0,analytics:{totalUses:c.length,totalDiscount:n,totalSavings:p,usageRecords:c}}}catch(a){return console.error("Error getting deal analytics:",a),{success:!1,error:a.message}}}async searchDeals(e,a={}){try{const r=y(this.dealsRef,G(a.limit||50));return{success:!0,deals:(await R(r)).docs.map(i=>{var d,h;return{id:i.id,...i.data(),expires:(d=i.data().expires)==null?void 0:d.toDate(),createdAt:(h=i.data().createdAt)==null?void 0:h.toDate()}}).filter(i=>i.title.toLowerCase().includes(e.toLowerCase())||i.description&&i.description.toLowerCase().includes(e.toLowerCase())||i.category&&i.category.toLowerCase().includes(e.toLowerCase()))}}catch(r){return console.error("Error searching deals:",r),{success:!1,error:r.message}}}async getDealStatistics(){try{const[e,a]=await Promise.all([V(y(this.dealsRef)),V(y(this.dealsRef,N("isActive","==",!0)))]);return{success:!0,statistics:{total:e.data().count,active:a.data().count,inactive:e.data().count-a.data().count}}}catch(e){return console.error("Error getting deal statistics:",e),{success:!1,error:e.message}}}async deactivateExpiredDeals(){try{const e=w.now(),a=y(this.dealsRef,N("expires","<",e),N("isActive","==",!0)),r=await R(a);if(r.empty)return{success:!0,updated:0};const c=q(j);return r.docs.forEach(n=>{c.update(n.ref,{isActive:!1,updatedAt:w.now(),deactivatedReason:"expired"})}),await c.commit(),{success:!0,updated:r.docs.length}}catch(e){return console.error("Error deactivating expired deals:",e),{success:!1,error:e.message}}}}const v=new ue,ge=(l={})=>{const{user:e}=oe(),[a,r]=g.useState([]),[c,n]=g.useState(!0),[p,i]=g.useState(null),[d,h]=g.useState(null);g.useEffect(()=>{if(!e){n(!1);return}return v.subscribeToDeals((o,x)=>{x?(console.error("Subscription error:",x),i(x.message)):(r(o||[]),i(null)),n(!1)},{sortBy:l.sortBy||"expires",sortDirection:l.sortDirection||"asc",status:l.status})},[e,l.sortBy,l.sortDirection,l.status]),g.useEffect(()=>{(async()=>{if(!e)return;const o=await v.getDealStatistics();o.success?h(o.statistics):console.error("Failed to load statistics:",o.error)})()},[e]);const D=g.useCallback(async u=>{if(!e)return{success:!1,error:"User not authenticated"};n(!0);try{return await v.createDeal(u,e.uid)}catch(o){return console.error("Error creating deal:",o),{success:!1,error:o.message}}finally{n(!1)}},[e]),C=g.useCallback(async(u,o)=>{if(!e)return{success:!1,error:"User not authenticated"};n(!0);try{return await v.updateDeal(u,o,e.uid)}catch(x){return console.error("Error updating deal:",x),{success:!1,error:x.message}}finally{n(!1)}},[e]),S=g.useCallback(async u=>{if(!e)return{success:!1,error:"User not authenticated"};n(!0);try{return await v.deleteDeal(u,e.uid)}catch(o){return console.error("Error deleting deal:",o),{success:!1,error:o.message}}finally{n(!1)}},[e]),f=g.useCallback(async(u,o,x)=>{if(!e)return{success:!1,error:"User not authenticated"};try{return await v.applyDealToOrder(u,o,x,e.uid)}catch(U){return console.error("Error applying deal:",U),{success:!1,error:U.message}}},[e]),L=g.useCallback(async(u,o={})=>{try{return await v.searchDeals(u,o)}catch(x){return console.error("Error searching deals:",x),{success:!1,error:x.message}}},[]),E=g.useCallback(async u=>{try{return await v.getDealAnalytics(u)}catch(o){return console.error("Error getting deal analytics:",o),{success:!1,error:o.message}}},[]),$=g.useCallback(async(u,o)=>{if(!e)return{success:!1,error:"User not authenticated"};try{return await v.updateDeal(u,{isActive:!o},e.uid)}catch(x){return console.error("Error toggling deal status:",x),{success:!1,error:x.message}}},[e]),T=g.useCallback(async()=>{try{return await v.deactivateExpiredDeals()}catch(u){return console.error("Error cleaning up expired deals:",u),{success:!1,error:u.message}}},[]);return{deals:a,loading:c,error:p,statistics:d,createDeal:D,updateDeal:C,deleteDeal:S,applyDeal:f,searchDeals:L,getDealAnalytics:E,toggleDealStatus:$,cleanupExpiredDeals:T}},he=()=>{var Q;const{darkMode:l}=de(),[e,a]=g.useState({title:"",discount:"",expires:"",description:"",category:"",minPurchase:"",maxUses:"",isActive:!0}),[r,c]=g.useState(null),[n,p]=g.useState(""),[i,d]=g.useState("all"),[h,D]=g.useState("expires"),[C,S]=g.useState(!1),[f,L]=g.useState(null),{deals:E,loading:$,error:T,statistics:u,createDeal:o,updateDeal:x,deleteDeal:U,toggleDealStatus:H,getDealAnalytics:J,cleanupExpiredDeals:K}=ge({sortBy:h}),A=s=>{const{name:m,value:b,type:F,checked:k}=s.target;a(ae=>({...ae,[m]:F==="checkbox"?k:b}))},W=async()=>{if(!e.title||!e.discount||!e.expires){alert("Please fill in all required fields");return}const s=await o(e);s.success?(a({title:"",discount:"",expires:"",description:"",category:"",minPurchase:"",maxUses:"",isActive:!0}),alert("Deal added successfully!")):alert(`Failed to add deal: ${s.error}`)},X=async(s,m)=>{const b=await x(s,m);b.success?(c(null),alert("Deal updated successfully!")):alert(`Failed to update deal: ${b.error}`)},Y=async s=>{if(!window.confirm("Are you sure you want to delete this deal?"))return;const m=await U(s);m.success?alert("Deal deleted successfully!"):alert(`Failed to delete deal: ${m.error}`)},Z=async(s,m)=>{const b=await H(s,m);b.success||alert(`Failed to update deal status: ${b.error}`)},ee=async s=>{const m=await J(s);m.success?(L(m.analytics),S(!0)):alert(`Failed to load analytics: ${m.error}`)},te=async()=>{if(!window.confirm("This will deactivate all expired deals. Continue?"))return;const s=await K();s.success?alert(`${s.updated} expired deals were deactivated.`):alert(`Failed to cleanup expired deals: ${s.error}`)},B=g.useMemo(()=>E.filter(s=>{const m=s.title.toLowerCase().includes(n.toLowerCase())||s.description&&s.description.toLowerCase().includes(n.toLowerCase()),b=new Date,F=s.expires<b;let k=!0;return i==="active"?k=s.isActive&&!F:i==="expired"?k=F:i==="inactive"&&(k=!s.isActive),m&&k}),[E,n,i]),O=s=>new Date(s)<new Date,I=s=>new Date(s).toLocaleDateString(),se=s=>O(s.expires)?"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200":s.isActive?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300",re=s=>O(s.expires)?"Expired":s.isActive?"Active":"Inactive";return $&&E.length===0?t.jsx("div",{className:`min-h-screen p-6 ${l?"bg-gray-900 text-white":"bg-gray-50 text-gray-900"}`,children:t.jsx("div",{className:"max-w-7xl mx-auto",children:t.jsx("div",{className:"flex justify-center items-center h-64",children:t.jsx("div",{className:"text-xl",children:"Loading deals..."})})})}):T?t.jsx("div",{className:`min-h-screen p-6 ${l?"bg-gray-900 text-white":"bg-gray-50 text-gray-900"}`,children:t.jsx("div",{className:"max-w-7xl mx-auto",children:t.jsx("div",{className:"flex justify-center items-center h-64",children:t.jsxs("div",{className:"text-xl text-red-600",children:["Error: ",T]})})})}):t.jsx("div",{className:`min-h-screen p-6 ${l?"bg-gray-900 text-white":"bg-gray-50 text-gray-900"}`,children:t.jsxs("div",{className:"max-w-7xl mx-auto",children:[t.jsxs("div",{className:"flex justify-between items-center mb-8",children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Deal Management"}),t.jsxs("div",{className:"flex items-center space-x-4",children:[u&&t.jsxs(t.Fragment,{children:[t.jsxs("span",{className:"text-sm",children:["Total: ",u.total]}),t.jsxs("span",{className:"text-sm",children:["Active: ",u.active]}),t.jsxs("span",{className:"text-sm",children:["Inactive: ",u.inactive]})]}),t.jsx("button",{onClick:te,className:"px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 text-sm",children:"Cleanup Expired"})]})]}),t.jsxs("div",{className:`mb-8 p-6 rounded-lg shadow-sm ${l?"bg-gray-800":"bg-white"}`,children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[t.jsx("input",{type:"text",placeholder:"Search deals...",value:n,onChange:s=>p(s.target.value),className:`px-4 py-2 rounded-lg border ${l?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`}),t.jsxs("select",{value:i,onChange:s=>d(s.target.value),className:`px-4 py-2 rounded-lg border ${l?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`,children:[t.jsx("option",{value:"all",children:"All Deals"}),t.jsx("option",{value:"active",children:"Active"}),t.jsx("option",{value:"inactive",children:"Inactive"}),t.jsx("option",{value:"expired",children:"Expired"})]}),t.jsxs("select",{value:h,onChange:s=>D(s.target.value),className:`px-4 py-2 rounded-lg border ${l?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`,children:[t.jsx("option",{value:"expires",children:"Sort by Expiry"}),t.jsx("option",{value:"createdAt",children:"Sort by Created"}),t.jsx("option",{value:"title",children:"Sort by Title"}),t.jsx("option",{value:"discount",children:"Sort by Discount"})]}),t.jsxs("div",{className:"text-sm text-gray-500",children:["Showing ",B.length," of ",E.length," deals"]})]}),t.jsxs("div",{className:"border-t pt-6",children:[t.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Add New Deal"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[t.jsx("input",{type:"text",name:"title",placeholder:"Deal Title*",value:e.title,onChange:A,className:`px-4 py-2 rounded-lg border ${l?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`}),t.jsx("input",{type:"number",name:"discount",placeholder:"Discount %*",value:e.discount,onChange:A,min:"0",max:"100",className:`px-4 py-2 rounded-lg border ${l?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`}),t.jsx("input",{type:"date",name:"expires",value:e.expires,onChange:A,min:new Date().toISOString().split("T")[0],className:`px-4 py-2 rounded-lg border ${l?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`}),t.jsx("input",{type:"text",name:"category",placeholder:"Category",value:e.category,onChange:A,className:`px-4 py-2 rounded-lg border ${l?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`}),t.jsx("input",{type:"number",name:"minPurchase",placeholder:"Min Purchase Amount",value:e.minPurchase,onChange:A,min:"0",step:"0.01",className:`px-4 py-2 rounded-lg border ${l?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`}),t.jsx("input",{type:"number",name:"maxUses",placeholder:"Max Uses (optional)",value:e.maxUses,onChange:A,min:"1",className:`px-4 py-2 rounded-lg border ${l?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`})]}),t.jsx("textarea",{name:"description",placeholder:"Deal Description",value:e.description,onChange:A,rows:3,className:`mt-4 w-full px-4 py-2 rounded-lg border ${l?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`}),t.jsxs("div",{className:"flex items-center justify-between mt-4",children:[t.jsxs("label",{className:"flex items-center",children:[t.jsx("input",{type:"checkbox",name:"isActive",checked:e.isActive,onChange:A,className:"mr-2"}),t.jsx("span",{children:"Active Deal"})]}),t.jsx("button",{onClick:W,disabled:$,className:`px-6 py-2 rounded-lg font-semibold transition-colors ${$?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 text-white"}`,children:$?"Adding...":"Add Deal"})]})]})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:B.map(s=>t.jsxs("div",{className:`p-6 rounded-lg shadow-sm border transition-all hover:shadow-md ${l?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[t.jsxs("div",{className:"flex items-start justify-between mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold truncate pr-2",children:s.title}),t.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium whitespace-nowrap ${se(s)}`,children:re(s)})]}),t.jsxs("div",{className:"space-y-2 mb-4",children:[t.jsxs("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:[s.discount,"% OFF"]}),s.description&&t.jsx("p",{className:`text-sm line-clamp-2 ${l?"text-gray-300":"text-gray-600"}`,children:s.description}),t.jsxs("div",{className:`text-sm space-y-1 ${l?"text-gray-400":"text-gray-500"}`,children:[t.jsxs("p",{children:["Expires: ",I(s.expires)]}),s.category&&t.jsxs("p",{children:["Category: ",s.category]}),s.minPurchase>0&&t.jsxs("p",{children:["Min Purchase: $",s.minPurchase]}),s.maxUses&&t.jsxs("p",{children:["Usage: ",s.currentUses||0," / ",s.maxUses]})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsx("button",{onClick:()=>Z(s.id,s.isActive),className:`px-3 py-2 rounded-lg text-xs font-medium transition-colors ${s.isActive?"bg-yellow-100 text-yellow-800 hover:bg-yellow-200 dark:bg-yellow-900 dark:text-yellow-200":"bg-green-100 text-green-800 hover:bg-green-200 dark:bg-green-900 dark:text-green-200"}`,children:s.isActive?"Deactivate":"Activate"}),t.jsx("button",{onClick:()=>ee(s.id),className:"px-3 py-2 rounded-lg text-xs font-medium bg-purple-100 text-purple-800 hover:bg-purple-200 dark:bg-purple-900 dark:text-purple-200 transition-colors",children:"Analytics"}),t.jsx("button",{onClick:()=>c(s),className:"px-3 py-2 rounded-lg text-xs font-medium bg-blue-100 text-blue-800 hover:bg-blue-200 dark:bg-blue-900 dark:text-blue-200 transition-colors",children:"Edit"}),t.jsx("button",{onClick:()=>Y(s.id),className:"px-3 py-2 rounded-lg text-xs font-medium bg-red-100 text-red-800 hover:bg-red-200 dark:bg-red-900 dark:text-red-200 transition-colors",children:"Delete"})]})]},s.id))}),B.length===0&&t.jsxs("div",{className:`text-center py-12 ${l?"text-gray-400":"text-gray-500"}`,children:[t.jsx("div",{className:"text-6xl mb-4",children:"🎯"}),t.jsx("p",{className:"text-xl mb-2",children:"No deals found"}),t.jsx("p",{className:"text-sm",children:n||i!=="all"?"Try adjusting your search or filter criteria":"Create your first deal to get started"})]}),r&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:t.jsxs("div",{className:`max-w-md w-full rounded-lg p-6 ${l?"bg-gray-800":"bg-white"}`,children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Edit Deal"}),t.jsxs("div",{className:"space-y-4",children:[t.jsx("input",{type:"text",placeholder:"Deal Title",value:r.title,onChange:s=>c({...r,title:s.target.value}),className:`w-full px-4 py-2 rounded-lg border ${l?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`}),t.jsx("input",{type:"number",placeholder:"Discount %",value:r.discount,onChange:s=>c({...r,discount:s.target.value}),min:"0",max:"100",className:`w-full px-4 py-2 rounded-lg border ${l?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`}),t.jsx("input",{type:"date",value:r.expires instanceof Date?r.expires.toISOString().split("T")[0]:r.expires,onChange:s=>c({...r,expires:s.target.value}),min:new Date().toISOString().split("T")[0],className:`w-full px-4 py-2 rounded-lg border ${l?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`}),t.jsx("textarea",{placeholder:"Description",value:r.description||"",onChange:s=>c({...r,description:s.target.value}),rows:3,className:`w-full px-4 py-2 rounded-lg border ${l?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`})]}),t.jsxs("div",{className:"flex justify-end space-x-2 mt-6",children:[t.jsx("button",{onClick:()=>c(null),className:`px-4 py-2 rounded-lg ${l?"bg-gray-700 text-white":"bg-gray-200 text-gray-800"}`,children:"Cancel"}),t.jsx("button",{onClick:()=>X(r.id,r),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Update"})]})]})}),C&&f&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:t.jsxs("div",{className:`max-w-2xl w-full rounded-lg p-6 max-h-96 overflow-y-auto ${l?"bg-gray-800":"bg-white"}`,children:[t.jsxs("div",{className:"flex justify-between items-center mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold",children:"Deal Analytics"}),t.jsx("button",{onClick:()=>S(!1),className:`px-3 py-1 rounded-lg ${l?"bg-gray-700 text-white":"bg-gray-200 text-gray-800"}`,children:"Close"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[t.jsxs("div",{className:`p-4 rounded-lg ${l?"bg-gray-700":"bg-gray-100"}`,children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Total Uses"}),t.jsx("p",{className:"text-2xl font-bold",children:f.totalUses})]}),t.jsxs("div",{className:`p-4 rounded-lg ${l?"bg-gray-700":"bg-gray-100"}`,children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Total Discount Given"}),t.jsxs("p",{className:"text-2xl font-bold text-green-600",children:["$",(Q=f.totalDiscount)==null?void 0:Q.toFixed(2)]})]}),t.jsxs("div",{className:`p-4 rounded-lg ${l?"bg-gray-700":"bg-gray-100"}`,children:[t.jsx("p",{className:"text-sm text-gray-500",children:"Average Discount"}),t.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:["$",f.totalUses>0?(f.totalDiscount/f.totalUses).toFixed(2):"0.00"]})]})]}),f.usageRecords.length>0&&t.jsxs("div",{children:[t.jsx("h4",{className:"font-semibold mb-2",children:"Recent Usage"}),t.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:f.usageRecords.slice(0,10).map((s,m)=>{var b;return t.jsxs("div",{className:`p-2 rounded text-sm ${l?"bg-gray-700":"bg-gray-100"}`,children:[t.jsxs("p",{children:["Order: ",s.orderId]}),t.jsxs("p",{children:["Discount: $",(b=s.discountAmount)==null?void 0:b.toFixed(2)]}),t.jsxs("p",{children:["Date: ",s.usedAt?I(s.usedAt):"N/A"]})]},m)})})]})]})})]})})};export{he as default};
