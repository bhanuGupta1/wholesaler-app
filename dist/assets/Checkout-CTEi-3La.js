import{x as ve,a as je,u as we,b as ke,j as e}from"./index-Dy66ZVuQ.js";import{r as p}from"./vendor-DJ1oPbzn.js";import{v as $e,c as Ce}from"./orderService-BGzdWnTg.js";import{P as T}from"./package-Cp5rcFUb.js";import{c as _}from"./createLucideIcon-AIsR3Rz6.js";import{U as L}from"./user-ColF89V6.js";import{T as R}from"./truck-DCjYC1-4.js";import{C as X}from"./credit-card-C5qMo7w_.js";import{T as B}from"./tag-CR0fMey3.js";import{S as M}from"./shield-BHGnmh5n.js";import"./firebase-DMhjYMbV.js";/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],ee=_("mail",Pe);/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],De=_("map-pin",Se);/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],re=_("phone",qe),Ze=()=>{var H,J,K;const{cart:C,clearCart:se}=ve(),{user:x}=je(),{darkMode:s}=we(),P=ke(),l=!x||(x==null?void 0:x.role)==="guest",Z=l?`guest_${Date.now()}`:null,[y,S]=p.useState(l?2:1),[E,G]=p.useState(!1),[V,k]=p.useState(""),[N,te]=p.useState([]);p.useEffect(()=>{const r=C.map(t=>ae(t));te(r)},[C]);const ae=r=>{if(!r.bulkPricing||typeof r.bulkPricing!="object")return{...r,effectivePrice:r.price,hasBulkDiscount:!1};const m=Object.keys(r.bulkPricing).map(d=>parseInt(d)).filter(d=>!isNaN(d)).sort((d,u)=>u-d).find(d=>r.quantity>=d);if(m){const d=r.bulkPricing[m.toString()],u=r.price-d,b=u/r.price*100;return{...r,effectivePrice:d,hasBulkDiscount:!0,bulkPricing:{...r.bulkPricing,isBulkPrice:!0,originalPrice:r.price,bulkDiscount:b,bulkTier:m,appliedPrice:d,savings:u}}}return{...r,effectivePrice:r.price,hasBulkDiscount:!1,bulkPricing:{...r.bulkPricing,isBulkPrice:!1}}},[i,ie]=p.useState({firstName:((H=x==null?void 0:x.displayName)==null?void 0:H.split(" ")[0])||"",lastName:((J=x==null?void 0:x.displayName)==null?void 0:J.split(" ")[1])||"",email:(x==null?void 0:x.email)||"",phone:"",address:"",suburb:"",city:"",region:"",postcode:"",country:"NZ",isDefault:!1}),[c,ne]=p.useState({method:"credit_card",cardNumber:"",expiryDate:"",cvv:"",nameOnCard:"",billingAddressSame:!0,billingAddress:{address:"",suburb:"",city:"",region:"",postcode:"",country:"NZ"}}),[v,O]=p.useState("standard"),[z,le]=p.useState(""),[n,de]=p.useState({email:"",phone:"",firstName:"",lastName:""});p.useEffect(()=>{C.length===0&&P("/cart")},[C,P]);const A=[{id:"standard",name:"Standard Delivery",description:"3-5 business days",price:9.9,freeThreshold:250},{id:"express",name:"Express Delivery",description:"1-2 business days",price:19.9,freeThreshold:500},{id:"overnight",name:"Overnight Delivery",description:"Next business day (Metro areas)",price:29.9,freeThreshold:1e3},{id:"pickup",name:"Click & Collect",description:"Ready in 2-4 hours",price:0,freeThreshold:0}],oe=["Auckland","Bay of Plenty","Canterbury","Gisborne","Hawke's Bay","Manawatū-Whanganui","Marlborough","Nelson","Northland","Otago","Southland","Taranaki","Tasman","Waikato","Wellington","West Coast"],W=()=>{let r=0,t=0,m=0;N.forEach(h=>{const f=(h.effectivePrice||h.price)*h.quantity;r+=f;const q=h.price*h.quantity;if(m+=q,h.hasBulkDiscount){const F=q-f;t+=F}});const d=A.find(h=>h.id===v),u=r>=d.freeThreshold?0:d.price,b=r*.15,w=r+u+b;return{subtotal:r,originalSubtotal:m,totalBulkSavings:t,deliveryFee:u,gst:b,total:w,totalItems:N.reduce((h,o)=>h+o.quantity,0)}},j=(r,t)=>{ie(m=>({...m,[r]:t}))},$=(r,t)=>{ne(m=>({...m,[r]:t}))},D=(r,t)=>{de(m=>({...m,[r]:t}))},ce=()=>{if(l)return!0;const r={};return i.firstName.trim()||(r.firstName="First name is required"),i.lastName.trim()||(r.lastName="Last name is required"),i.email.trim()?U(i.email)||(r.email="Please enter a valid email address"):r.email="Email is required",i.phone.trim()?Q(i.phone)||(r.phone="Please enter a valid NZ phone number"):r.phone="Phone number is required",i.address.trim()||(r.address="Address is required"),i.city.trim()||(r.city="City is required"),i.region.trim()||(r.region="Region is required"),i.postcode.trim()?he(i.postcode)||(r.postcode="Postcode must be 4 digits"):r.postcode="Postcode is required",I(r),Object.keys(r).length===0},me=()=>{if(!l)return!0;const r={};return n.firstName.trim()||(r.guestFirstName="First name is required"),n.lastName.trim()||(r.guestLastName="Last name is required"),n.email.trim()?U(n.email)||(r.guestEmail="Please enter a valid email address"):r.guestEmail="Email is required",n.phone&&!Q(n.phone)&&(r.guestPhone="Please enter a valid NZ phone number"),I(r),Object.keys(r).length===0},ue=()=>{const r={};return(c.method==="credit_card"||c.method==="debit_card")&&(c.nameOnCard.trim()||(r.nameOnCard="Name on card is required"),c.cardNumber.trim()?pe(c.cardNumber)||(r.cardNumber="Card number must be 16 digits"):r.cardNumber="Card number is required",c.expiryDate.trim()?ye(c.expiryDate)||(r.expiryDate="Invalid or expired date (MM/YY)"):r.expiryDate="Expiry date is required",c.cvv.trim()?fe(c.cvv)||(r.cvv="CVV must be 3-4 digits"):r.cvv="CVV is required"),I(r),Object.keys(r).length===0},ge=r=>{const m=r.replace(/\s+/g,"").replace(/[^0-9]/gi,"").match(/\d{4,16}/g),d=m&&m[0]||"",u=[];for(let b=0,w=d.length;b<w;b+=4)u.push(d.substring(b,b+4));return u.length?u.join(" "):r},xe=r=>{const t=r.replace(/\D/g,"");return t.length>=2?t.substring(0,2)+(t.length>2?"/"+t.substring(2,4):""):t},be=r=>r.replace(/\D/g,"").substring(0,4),Y=r=>{const t=r.replace(/\D/g,"");return t.startsWith("64")?"+64 "+t.substring(2):t.startsWith("0")?t:t.length<=9?"0"+t:r},U=r=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r),Q=r=>{const t=r.replace(/\D/g,"");return t.startsWith("64")?t.length>=11&&t.length<=13:t.length>=8&&t.length<=10},he=r=>/^\d{4}$/.test(r),pe=r=>{const t=r.replace(/\s/g,"");return/^\d{16}$/.test(t)},fe=r=>/^\d{3,4}$/.test(r),ye=r=>{if(!/^\d{2}\/\d{2}$/.test(r))return!1;const[t,m]=r.split("/").map(w=>parseInt(w)),d=new Date,u=d.getFullYear()%100,b=d.getMonth()+1;return!(t<1||t>12||m<u||m===u&&t<b)},[a,I]=p.useState({}),Ne=async()=>{var r,t,m;try{if(G(!0),k(""),N.length===0){k("Your cart is empty");return}const d=N.filter(o=>{const f=o.effectivePrice??o.price;return f==null||f<0});if(d.length>0){console.error("Items with invalid prices:",d),k("Some items have invalid pricing. Please refresh the page and try again.");return}if(l&&(!((r=n.firstName)!=null&&r.trim())||!((t=n.lastName)!=null&&t.trim())||!((m=n.email)!=null&&m.trim()))){k("Please fill in all required contact information");return}const u=W(),b=N.map(o=>{const f=o.effectivePrice??o.price??0,q=o.price??0,F=o.quantity??0;return{productId:o.id||o.productId,productName:o.name||o.productName,price:q,effectivePrice:f,quantity:F,subtotal:f*F,hasBulkDiscount:o.hasBulkDiscount||!1,bulkPricing:o.bulkPricing||null,sku:o.sku||"",category:o.category||"",imageUrl:o.imageUrl||""}});try{$e(b)}catch(o){k(o.message);return}const w={customerName:l?`${n.firstName} ${n.lastName}`.trim():`${i.firstName} ${i.lastName}`.trim(),customerEmail:l?n.email:i.email,customerPhone:l?n.phone:i.phone,isGuestOrder:l,guestId:Z,shippingAddress:l?{firstName:n.firstName,lastName:n.lastName,email:n.email,phone:n.phone,address:v==="pickup"?"Click & Collect":"Guest Order",suburb:"N/A",city:"N/A",region:"N/A",postcode:"N/A",country:"New Zealand"}:i,billingAddress:l?{firstName:n.firstName,lastName:n.lastName,email:n.email}:c.billingAddressSame?i:c.billingAddress,items:b,originalSubtotal:u.originalSubtotal,subtotal:u.subtotal,totalBulkSavings:u.totalBulkSavings,deliveryFee:u.deliveryFee,gst:u.gst,taxAmount:u.gst,total:u.total,totalAmount:u.total,currency:"NZD",deliveryOption:v,specialInstructions:z,paymentMethod:c.method,paymentStatus:"pending",status:"pending",userId:l?null:(x==null?void 0:x.uid)||null,itemCount:N.reduce((o,f)=>o+(f.quantity||0),0),hasBulkDiscounts:u.totalBulkSavings>0,bulkDiscountsAutoApplied:N.some(o=>o.hasBulkDiscount),orderSource:"checkout",country:"New Zealand",timezone:"Pacific/Auckland"};console.log("Creating order with validated data:",w);const h=await Ce(w);await new Promise(o=>setTimeout(o,2e3)),se(),P(l?`/guest-order-confirmation/${h}?email=${encodeURIComponent(n.email)}`:`/order-confirmation/${h}`)}catch(d){console.error("Checkout error:",d),k(d.message||"Failed to place order. Please try again.")}finally{G(!1)}},g=W();return e.jsx("div",{className:`min-h-screen ${s?"bg-gray-900 text-white":"bg-gray-50 text-gray-900"}`,children:e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("h1",{className:"text-4xl font-bold mb-4 flex items-center",children:[e.jsx(T,{className:"w-10 h-10 mr-3"}),l?"Guest Checkout":"Checkout"]}),l&&e.jsx("div",{className:`mb-6 p-6 rounded-xl ${s?"bg-blue-900/20 border-blue-800":"bg-blue-50 border-blue-200"} border`,children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"text-3xl mr-4",children:"🇳🇿"}),e.jsxs("div",{children:[e.jsx("h3",{className:`text-lg font-semibold ${s?"text-blue-300":"text-blue-800"} mb-2`,children:"Checking out as Guest"}),e.jsx("p",{className:`${s?"text-blue-200":"text-blue-700"}`,children:"Complete your purchase without creating an account. We'll send order updates to your email. All prices in NZD."})]})]})}),g.totalBulkSavings>0&&e.jsx("div",{className:`mb-6 p-6 rounded-xl ${s?"bg-green-900/20 border-green-800":"bg-green-50 border-green-200"} border`,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(B,{className:"w-8 h-8 mr-3 text-green-600"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("h3",{className:`text-lg font-semibold ${s?"text-green-300":"text-green-800"} mb-1`,children:["🎉 You're saving $",g.totalBulkSavings.toFixed(2)," NZD with auto-applied bulk pricing!"]}),e.jsx("p",{className:`${s?"text-green-200":"text-green-700"}`,children:"Bulk discounts have been automatically applied based on your quantities and will be maintained through checkout."})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:`text-sm font-medium ${s?"text-green-300":"text-green-700"}`,children:[N.filter(r=>r.hasBulkDiscount).length," items with bulk pricing"]}),e.jsx("div",{className:`text-xs ${s?"text-green-400":"text-green-600"}`,children:"Auto-applied at checkout"})]})]})}),e.jsx("div",{className:"flex items-center justify-center mb-6",children:(l?[{num:2,label:"Contact & Payment"},{num:3,label:"Review"}]:[{num:1,label:"Shipping"},{num:2,label:"Payment"},{num:3,label:"Review"}]).map((r,t)=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`flex items-center justify-center w-10 h-10 rounded-full font-semibold ${y>=r.num?"bg-indigo-600 text-white":s?"bg-gray-700 text-gray-400":"bg-gray-300 text-gray-600"}`,children:y>r.num?"✓":r.num}),e.jsx("span",{className:"ml-3 font-medium",children:r.label}),t<(l?1:2)&&e.jsx("div",{className:`w-20 h-1 mx-6 rounded ${y>r.num?"bg-indigo-600":s?"bg-gray-700":"bg-gray-300"}`})]},r.num))})]}),V&&e.jsx("div",{className:`mb-6 p-4 rounded-xl border-l-4 ${s?"bg-red-900/30 border-red-800 text-red-400":"bg-red-50 border-red-400 text-red-700"}`,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),V]})}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"xl:col-span-2",children:[!l&&y===1&&e.jsxs("div",{className:`${s?"bg-gray-800 border-gray-700":"bg-white border-gray-200"} rounded-2xl shadow-lg border p-8`,children:[e.jsxs("h2",{className:"text-2xl font-bold mb-6 flex items-center",children:[e.jsx(De,{className:"w-6 h-6 mr-2"}),"Shipping Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm font-semibold mb-2 flex items-center",children:[e.jsx(L,{className:"w-4 h-4 mr-1"}),"First Name *"]}),e.jsx("input",{type:"text",value:i.firstName,onChange:r=>j("firstName",r.target.value),className:`w-full px-4 py-3 border rounded-xl ${a.firstName?"border-red-500 focus:border-red-500 focus:ring-red-500":s?"bg-gray-700 border-gray-600 text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent":"bg-white border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-transparent"}`,required:!0}),a.firstName&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.firstName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Last Name *"}),e.jsx("input",{type:"text",value:i.lastName,onChange:r=>j("lastName",r.target.value),className:`w-full px-4 py-3 border rounded-xl ${a.lastName?"border-red-500 focus:border-red-500 focus:ring-red-500":s?"bg-gray-700 border-gray-600 text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent":"bg-white border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-transparent"}`,required:!0}),a.lastName&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.lastName})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm font-semibold mb-2 flex items-center",children:[e.jsx(ee,{className:"w-4 h-4 mr-1"}),"Email *"]}),e.jsx("input",{type:"email",value:i.email,onChange:r=>j("email",r.target.value),className:`w-full px-4 py-3 border rounded-xl ${a.email?"border-red-500 focus:border-red-500 focus:ring-red-500":s?"bg-gray-700 border-gray-600 text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent":"bg-white border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-transparent"}`,required:!0}),a.email&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.email})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm font-semibold mb-2 flex items-center",children:[e.jsx(re,{className:"w-4 h-4 mr-1"}),"Phone *"]}),e.jsx("input",{type:"tel",value:i.phone,onChange:r=>j("phone",Y(r.target.value)),placeholder:"021 234 5678",className:`w-full px-4 py-3 border rounded-xl ${a.phone?"border-red-500 focus:border-red-500 focus:ring-red-500":s?"bg-gray-700 border-gray-600 text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent":"bg-white border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-transparent"}`,required:!0}),a.phone&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.phone})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Street Address *"}),e.jsx("input",{type:"text",value:i.address,onChange:r=>j("address",r.target.value),placeholder:"123 Queen Street",className:`w-full px-4 py-3 border rounded-xl ${s?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"} focus:ring-2 focus:ring-indigo-500 focus:border-transparent`,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Suburb"}),e.jsx("input",{type:"text",value:i.suburb,onChange:r=>j("suburb",r.target.value),placeholder:"CBD",className:`w-full px-4 py-3 border rounded-xl ${s?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"} focus:ring-2 focus:ring-indigo-500 focus:border-transparent`})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"City *"}),e.jsx("input",{type:"text",value:i.city,onChange:r=>j("city",r.target.value),placeholder:"Auckland",className:`w-full px-4 py-3 border rounded-xl ${s?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"} focus:ring-2 focus:ring-indigo-500 focus:border-transparent`,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Region *"}),e.jsxs("select",{value:i.region,onChange:r=>j("region",r.target.value),className:`w-full px-4 py-3 border rounded-xl ${s?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"} focus:ring-2 focus:ring-indigo-500 focus:border-transparent`,required:!0,children:[e.jsx("option",{value:"",children:"Select Region"}),oe.map(r=>e.jsx("option",{value:r,children:r},r))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Postcode *"}),e.jsx("input",{type:"text",value:i.postcode,onChange:r=>j("postcode",be(r.target.value)),placeholder:"1010",maxLength:"4",className:`w-full px-4 py-3 border rounded-xl ${a.postcode?"border-red-500 focus:border-red-500 focus:ring-red-500":s?"bg-gray-700 border-gray-600 text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent":"bg-white border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-transparent"}`,required:!0}),a.postcode&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.postcode})]})]}),e.jsxs("div",{className:"mt-8",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[e.jsx(R,{className:"w-5 h-5 mr-2"}),"Delivery Options"]}),e.jsx("div",{className:"space-y-3",children:A.map(r=>e.jsxs("label",{className:`flex items-center p-4 border rounded-xl cursor-pointer transition-all ${v===r.id?s?"border-indigo-500 bg-indigo-900/20 shadow-lg":"border-indigo-500 bg-indigo-50 shadow-lg":s?"border-gray-600 hover:border-gray-500":"border-gray-300 hover:border-gray-400"}`,children:[e.jsx("input",{type:"radio",name:"delivery",value:r.id,checked:v===r.id,onChange:t=>O(t.target.value),className:"mr-4 w-5 h-5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold",children:r.name}),e.jsx("div",{className:`text-sm ${s?"text-gray-400":"text-gray-600"}`,children:r.description})]}),e.jsx("div",{className:"text-right",children:r.price===0?e.jsx("span",{className:"font-semibold text-green-600",children:"FREE"}):g.subtotal>=r.freeThreshold?e.jsxs("div",{children:[e.jsxs("span",{className:"line-through text-gray-400",children:["$",r.price.toFixed(2)]}),e.jsx("span",{className:"ml-2 font-semibold text-green-600",children:"FREE"})]}):e.jsxs("span",{className:"font-semibold",children:["$",r.price.toFixed(2)]})})]},r.id))})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Special Instructions (Optional)"}),e.jsx("textarea",{value:z,onChange:r=>le(r.target.value),rows:"3",className:`w-full px-4 py-3 border rounded-xl ${s?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"} focus:ring-2 focus:ring-indigo-500 focus:border-transparent`,placeholder:"Leave at door, ring doorbell, etc..."})]})]}),y===2&&e.jsxs("div",{className:`${s?"bg-gray-800 border-gray-700":"bg-white border-gray-200"} rounded-2xl shadow-lg border p-8`,children:[e.jsxs("h2",{className:"text-2xl font-bold mb-6 flex items-center",children:[e.jsx(X,{className:"w-6 h-6 mr-2"}),l?"Contact & Payment Information":"Payment Information"]}),l&&e.jsxs("div",{className:"mb-8",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[e.jsx(L,{className:"w-5 h-5 mr-2"}),"Contact Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"First Name *"}),e.jsx("input",{type:"text",value:n.firstName,onChange:r=>D("firstName",r.target.value),className:`w-full px-4 py-3 border rounded-xl ${a.guestFirstName?"border-red-500 focus:border-red-500 focus:ring-red-500":s?"bg-gray-700 border-gray-600 text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent":"bg-white border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-transparent"}`,required:!0}),a.guestFirstName&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.guestFirstName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Last Name *"}),e.jsx("input",{type:"text",value:n.lastName,onChange:r=>D("lastName",r.target.value),className:`w-full px-4 py-3 border rounded-xl ${a.guestLastName?"border-red-500 focus:border-red-500 focus:ring-red-500":s?"bg-gray-700 border-gray-600 text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent":"bg-white border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-transparent"}`,required:!0}),a.guestLastName&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.guestLastName})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm font-semibold mb-2 flex items-center",children:[e.jsx(ee,{className:"w-4 h-4 mr-1"}),"Email *"]}),e.jsx("input",{type:"email",value:n.email,onChange:r=>D("email",r.target.value),className:`w-full px-4 py-3 border rounded-xl ${a.guestEmail?"border-red-500 focus:border-red-500 focus:ring-red-500":s?"bg-gray-700 border-gray-600 text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent":"bg-white border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-transparent"}`,placeholder:"your.email@example.co.nz",required:!0}),a.guestEmail&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.guestEmail})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm font-semibold mb-2 flex items-center",children:[e.jsx(re,{className:"w-4 h-4 mr-1"}),"Phone (Optional)"]}),e.jsx("input",{type:"tel",value:n.phone,onChange:r=>D("phone",Y(r.target.value)),className:`w-full px-4 py-3 border rounded-xl ${a.guestPhone?"border-red-500 focus:border-red-500 focus:ring-red-500":s?"bg-gray-700 border-gray-600 text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent":"bg-white border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-transparent"}`,placeholder:"021 234 5678"}),a.guestPhone&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.guestPhone})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("h4",{className:"text-md font-semibold mb-3 flex items-center",children:[e.jsx(R,{className:"w-4 h-4 mr-1"}),"Delivery Method"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:`flex items-center p-4 border rounded-xl cursor-pointer transition-all ${v==="pickup"?s?"border-indigo-500 bg-indigo-900/20":"border-indigo-500 bg-indigo-50":s?"border-gray-600":"border-gray-300"}`,children:[e.jsx("input",{type:"radio",name:"delivery",value:"pickup",checked:v==="pickup",onChange:r=>O(r.target.value),className:"mr-3 w-5 h-5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold",children:"Click & Collect (Recommended)"}),e.jsx("div",{className:`text-sm ${s?"text-gray-400":"text-gray-600"}`,children:"Ready in 2-4 hours • FREE"})]}),e.jsx("span",{className:"font-semibold text-green-600",children:"FREE"})]}),e.jsxs("label",{className:`flex items-center p-4 border rounded-xl cursor-pointer transition-all ${v==="standard"?s?"border-indigo-500 bg-indigo-900/20":"border-indigo-500 bg-indigo-50":s?"border-gray-600":"border-gray-300"}`,children:[e.jsx("input",{type:"radio",name:"delivery",value:"standard",checked:v==="standard",onChange:r=>O(r.target.value),className:"mr-3 w-5 h-5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold",children:"Standard Delivery"}),e.jsx("div",{className:`text-sm ${s?"text-gray-400":"text-gray-600"}`,children:"3-5 business days across New Zealand"})]}),e.jsxs("span",{className:"font-semibold",children:["$",(K=A.find(r=>r.id==="standard"))==null?void 0:K.price.toFixed(2)]})]})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Choose Payment Method"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[{id:"credit_card",name:"Credit Card",icon:"💳",desc:"Visa, Mastercard"},{id:"debit_card",name:"Debit Card",icon:"💳",desc:"EFTPOS, Visa Debit"},{id:"bank_transfer",name:"Bank Transfer",icon:"🏦",desc:"Direct from bank"},{id:"afterpay",name:"Afterpay",icon:"💰",desc:"Buy now, pay later"},{id:"paypal",name:"PayPal",icon:"🅿️",desc:"PayPal account"}].map(r=>e.jsxs("label",{className:`flex items-center p-4 border rounded-xl cursor-pointer transition-all ${c.method===r.id?s?"border-indigo-500 bg-indigo-900/20":"border-indigo-500 bg-indigo-50":s?"border-gray-600 hover:border-gray-500":"border-gray-300 hover:border-gray-400"}`,children:[e.jsx("input",{type:"radio",name:"payment",value:r.id,checked:c.method===r.id,onChange:t=>$("method",t.target.value),className:"mr-3 w-5 h-5"}),e.jsx("span",{className:"mr-3 text-2xl",children:r.icon}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:r.name}),e.jsx("div",{className:`text-xs ${s?"text-gray-400":"text-gray-500"}`,children:r.desc})]})]},r.id))})]}),(c.method==="credit_card"||c.method==="debit_card")&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Name on Card *"}),e.jsx("input",{type:"text",value:c.nameOnCard,onChange:r=>$("nameOnCard",r.target.value),className:`w-full px-4 py-3 border rounded-xl ${a.nameOnCard?"border-red-500 focus:border-red-500 focus:ring-red-500":s?"bg-gray-700 border-gray-600 text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent":"bg-white border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-transparent"}`,required:!0}),a.nameOnCard&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.nameOnCard})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Card Number *"}),e.jsx("input",{type:"text",value:c.cardNumber,onChange:r=>$("cardNumber",ge(r.target.value)),placeholder:"1234 5678 9012 3456",maxLength:"19",className:`w-full px-4 py-3 border rounded-xl ${a.cardNumber?"border-red-500 focus:border-red-500 focus:ring-red-500":s?"bg-gray-700 border-gray-600 text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent":"bg-white border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-transparent"}`,required:!0}),a.cardNumber&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.cardNumber})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Expiry Date *"}),e.jsx("input",{type:"text",value:c.expiryDate,onChange:r=>$("expiryDate",xe(r.target.value)),placeholder:"MM/YY",maxLength:"5",className:`w-full px-4 py-3 border rounded-xl ${a.expiryDate?"border-red-500 focus:border-red-500 focus:ring-red-500":s?"bg-gray-700 border-gray-600 text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent":"bg-white border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-transparent"}`,required:!0}),a.expiryDate&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.expiryDate})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"CVV *"}),e.jsx("input",{type:"text",value:c.cvv,onChange:r=>$("cvv",r.target.value.replace(/\D/g,"")),placeholder:"123",maxLength:"4",className:`w-full px-4 py-3 border rounded-xl ${a.cvv?"border-red-500 focus:border-red-500 focus:ring-red-500":s?"bg-gray-700 border-gray-600 text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent":"bg-white border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-transparent"}`,required:!0}),a.cvv&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.cvv})]})]})]}),c.method==="afterpay"&&e.jsx("div",{className:`p-6 rounded-xl border-2 border-dashed ${s?"border-gray-600 bg-gray-700":"border-gray-300 bg-gray-50"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-4xl mb-3",children:"💰"}),e.jsx("p",{className:"font-semibold text-lg",children:"Afterpay Payment"}),e.jsx("p",{className:`text-sm ${s?"text-gray-400":"text-gray-600"} mt-1`,children:"Split your purchase into 4 equal payments, due every 2 weeks"}),e.jsx("div",{className:"mt-3 text-xs text-green-600 font-medium",children:"No interest if paid on time"})]})}),c.method==="bank_transfer"&&e.jsx("div",{className:`p-6 rounded-xl border-2 border-dashed ${s?"border-gray-600 bg-gray-700":"border-gray-300 bg-gray-50"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-4xl mb-3",children:"🏦"}),e.jsx("p",{className:"font-semibold text-lg",children:"Bank Transfer"}),e.jsx("p",{className:`text-sm ${s?"text-gray-400":"text-gray-600"} mt-1`,children:"Bank details will be provided after order confirmation"})]})})]}),y===3&&e.jsxs("div",{className:`${s?"bg-gray-800 border-gray-700":"bg-white border-gray-200"} rounded-2xl shadow-lg border p-8`,children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Review Your Order"}),e.jsx("div",{className:"space-y-4 mb-8",children:N.map(r=>{const t=r.effectivePrice||r.price,m=r.hasBulkDiscount,d=m?(r.price-t)*r.quantity:0;return e.jsxs("div",{className:`flex items-center space-x-4 p-4 border rounded-xl ${s?"border-gray-600":"border-gray-200"}`,children:[e.jsx("div",{className:"w-20 h-20 bg-gray-200 rounded-xl flex items-center justify-center overflow-hidden",children:r.imageUrl?e.jsx("img",{src:r.imageUrl,alt:r.name,className:"w-20 h-20 object-cover rounded-xl"}):e.jsx(T,{className:"w-8 h-8 text-gray-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-lg",children:r.name}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:`text-sm ${s?"text-gray-400":"text-gray-600"}`,children:["Qty: ",r.quantity," × $",t.toFixed(2),m&&e.jsxs("span",{className:"ml-2 text-green-600 font-medium",children:["(was $",r.price.toFixed(2),")"]})]}),m&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(B,{className:"w-3 h-3 text-green-600"}),e.jsxs("span",{className:"text-xs font-medium text-green-600",children:["Auto bulk discount: ",r.bulkPricing.bulkDiscount.toFixed(0),"% off • ",r.bulkPricing.bulkTier,"+ units"]})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"font-bold text-lg",children:["$",(t*r.quantity).toFixed(2)]}),d>0&&e.jsxs("div",{className:"text-sm text-green-600 font-medium",children:["Saved $",d.toFixed(2)]})]})]},r.id)})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold mb-3 flex items-center",children:[e.jsx(L,{className:"w-4 h-4 mr-1"}),"Contact Information"]}),e.jsx("div",{className:`p-4 rounded-xl ${s?"bg-gray-700":"bg-gray-50"}`,children:e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsx("div",{className:"font-medium",children:l?`${n.firstName} ${n.lastName}`:`${i.firstName} ${i.lastName}`}),e.jsx("div",{children:l?n.email:i.email}),(l?n.phone:i.phone)&&e.jsx("div",{children:l?n.phone:i.phone}),l&&e.jsxs("div",{className:`text-xs mt-2 px-2 py-1 rounded ${s?"bg-orange-900/30 text-orange-400":"bg-orange-100 text-orange-700"}`,children:["Guest Order • ID: ",Z]})]})})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold mb-3 flex items-center",children:[e.jsx(X,{className:"w-4 h-4 mr-1"}),"Payment Method"]}),e.jsx("div",{className:`p-4 rounded-xl ${s?"bg-gray-700":"bg-gray-50"}`,children:e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsx("div",{className:"font-medium capitalize",children:c.method.replace("_"," ")}),c.cardNumber&&e.jsxs("div",{children:["•••• •••• •••• ",c.cardNumber.slice(-4)]}),e.jsx("div",{className:"text-xs text-green-600 font-medium",children:"All payments in NZD"})]})})]})]})]})]}),e.jsx("div",{className:"xl:col-span-1",children:e.jsxs("div",{className:`${s?"bg-gray-800 border-gray-700":"bg-white border-gray-200"} rounded-2xl shadow-lg border p-6 sticky top-4`,children:[e.jsxs("h3",{className:"text-xl font-bold mb-6 flex items-center",children:[e.jsx(T,{className:"w-6 h-6 mr-2"}),"Order Summary"]}),e.jsxs("div",{className:"space-y-4 mb-6",children:[g.totalBulkSavings>0&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:`${s?"text-gray-400":"text-gray-500"} line-through`,children:"Original subtotal:"}),e.jsxs("span",{className:`${s?"text-gray-400":"text-gray-500"} line-through`,children:["$",g.originalSubtotal.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{children:["Subtotal (",g.totalItems," items):"]}),e.jsxs("span",{className:"font-semibold",children:["$",g.subtotal.toFixed(2)]})]}),g.totalBulkSavings>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-green-600 font-medium flex items-center",children:[e.jsx(B,{className:"w-4 h-4 mr-1"}),"Auto Bulk Savings:"]}),e.jsxs("span",{className:"font-bold text-green-600",children:["-$",g.totalBulkSavings.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Delivery:"}),e.jsx("span",{children:g.deliveryFee===0?e.jsx("span",{className:"text-green-600 font-semibold",children:"FREE"}):`$${g.deliveryFee.toFixed(2)}`})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"GST (15%):"}),e.jsxs("span",{children:["$",g.gst.toFixed(2)]})]}),e.jsx("hr",{className:`${s?"border-gray-600":"border-gray-200"}`}),e.jsxs("div",{className:"flex justify-between text-xl font-bold",children:[e.jsx("span",{children:"Total (NZD):"}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{children:["$",g.total.toFixed(2)]}),g.totalBulkSavings>0&&e.jsxs("div",{className:"text-sm font-normal text-green-600",children:["You saved $",g.totalBulkSavings.toFixed(2),"!"]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[!l&&y===1&&e.jsx("button",{onClick:()=>{ce()&&S(2)},className:"w-full py-4 rounded-xl font-semibold text-lg transition-colors bg-indigo-600 text-white hover:bg-indigo-700 shadow-lg",children:"Continue to Payment"}),y===2&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>{const r=ue(),t=l?me():!0;r&&t&&S(3)},className:"w-full py-4 rounded-xl font-semibold text-lg transition-colors bg-indigo-600 text-white hover:bg-indigo-700 shadow-lg",children:"Review Order"}),!l&&e.jsx("button",{onClick:()=>S(1),className:`w-full py-3 rounded-xl font-medium border transition-colors ${s?"border-gray-600 text-gray-300 hover:bg-gray-700":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:"Back to Shipping"})]}),y===3&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:Ne,disabled:E,className:`w-full py-4 rounded-xl font-semibold text-lg transition-colors ${E?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700 shadow-lg"} text-white`,children:E?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx(M,{className:"w-5 h-5 mr-2"}),l?"Complete Guest Order":"Place Order"]}),e.jsxs("div",{className:"text-sm font-normal mt-1",children:["$",g.total.toFixed(2)," NZD"]})]})}),e.jsx("button",{onClick:()=>S(2),className:`w-full py-3 rounded-xl font-medium border transition-colors ${s?"border-gray-600 text-gray-300 hover:bg-gray-700":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:"Back to Payment"})]}),Object.keys(a).length>0&&e.jsxs("div",{className:`mt-4 p-4 rounded-xl ${s?"bg-red-900/20 border-red-800":"bg-red-50 border-red-200"} border`,children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("svg",{className:"w-5 h-5 text-red-600 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),e.jsx("span",{className:"font-semibold text-red-600",children:"Please fix the following errors:"})]}),e.jsxs("div",{className:`text-sm space-y-1 ${s?"text-red-300":"text-red-600"}`,children:[Object.keys(a).length," field(s) need attention"]})]})]}),e.jsxs("div",{className:"mt-6 space-y-3",children:[e.jsxs("div",{className:`p-4 rounded-xl text-sm ${s?"bg-green-900/20 border-green-800":"bg-green-50 border-green-200"} border`,children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx(M,{className:"w-4 h-4 mr-2 text-green-600"}),e.jsx("span",{className:"font-semibold text-green-600",children:"Secure NZ Checkout"})]}),e.jsxs("div",{className:`text-xs space-y-1 ${s?"text-green-300":"text-green-600"}`,children:[e.jsx("div",{children:"• SSL encrypted & PCI compliant"}),e.jsx("div",{children:"• All prices include GST"}),e.jsx("div",{children:"• NZ consumer rights protected"}),g.totalBulkSavings>0&&e.jsx("div",{children:"• Auto bulk discounts applied"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[e.jsxs("div",{className:`p-3 rounded-xl ${s?"bg-gray-700":"bg-gray-50"}`,children:[e.jsx(M,{className:`w-5 h-5 mx-auto mb-1 ${s?"text-green-400":"text-green-600"}`}),e.jsx("div",{className:`text-xs font-medium ${s?"text-gray-300":"text-gray-700"}`,children:"Secure"})]}),e.jsxs("div",{className:`p-3 rounded-xl ${s?"bg-gray-700":"bg-gray-50"}`,children:[e.jsx(R,{className:`w-5 h-5 mx-auto mb-1 ${s?"text-blue-400":"text-blue-600"}`}),e.jsx("div",{className:`text-xs font-medium ${s?"text-gray-300":"text-gray-700"}`,children:"Fast Ship"})]}),e.jsxs("div",{className:`p-3 rounded-xl ${s?"bg-gray-700":"bg-gray-50"}`,children:[e.jsx(B,{className:`w-5 h-5 mx-auto mb-1 ${s?"text-purple-400":"text-purple-600"}`}),e.jsx("div",{className:`text-xs font-medium ${s?"text-gray-300":"text-gray-700"}`,children:"Auto Bulk"})]})]})]})]})})]})]})})};export{Ze as default};
