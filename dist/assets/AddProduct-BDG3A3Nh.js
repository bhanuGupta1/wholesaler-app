import{u as le,a as oe,b as ne,d as S,j as e}from"./index-DvFbKyhG.js";import{r as x}from"./vendor-DJ1oPbzn.js";import{c as H,q as k,b as ce,l as U,w as M,g as W,s as Q,e as de,f as ge,d as me}from"./firebase-DMhjYMbV.js";import{u as xe}from"./useAccessControl-CIRVTgbG.js";import{I as ue}from"./ImageUploader-Bwdwn7ab.js";const je=()=>{const{darkMode:r}=le(),{user:i}=oe(),{canManageProducts:N,userAccessLevel:I,isAdmin:p,isManager:b,isSeller:h}=xe(),f=ne(),[s,d]=x.useState({name:"",description:"",originalPrice:"",price:"",costPrice:"",stock:"",category:"",imageUrl:"",imageUrls:[],sku:"",supplier:"",tags:"",reorderPoint:"",enableBulkPricing:!0}),[v,D]=x.useState(!1),[C,y]=x.useState(null),[L,w]=x.useState(!1),[$,A]=x.useState([]),[V,E]=x.useState(!1),[F,R]=x.useState(new Set),[m,Y]=x.useState({}),P=p||b,K=["Electronics","Office Supplies","Furniture","Home & Garden","Health & Beauty","Automotive","Sports & Recreation","Books & Media","Clothing & Accessories","Tools & Hardware","Kitchen","Other"],G=["Apple Inc.","Samsung Electronics","Sony Corporation","Microsoft Corporation","Nike Inc.","Canon Inc.","Herman Miller","Dyson Ltd.","KitchenAid","Tesla Inc.","Bose Corporation","Patagonia Inc.","Custom Supplier"];x.useEffect(()=>{N&&q()},[N,i]),x.useEffect(()=>{if(s.stock&&!s.reorderPoint){const t=Math.max(5,Math.floor(parseInt(s.stock)*.1));d(a=>({...a,reorderPoint:t.toString()}))}},[s.stock]),x.useEffect(()=>{J()},[s.costPrice,s.price,s.originalPrice]);const J=()=>{const t={},a=parseFloat(s.costPrice)||0,n=parseFloat(s.price)||0,o=parseFloat(s.originalPrice)||0;a&&n&&a>=n&&(t.costPrice="Cost price must be less than selling price"),n&&o&&n>o&&(t.price="Selling price cannot be higher than original price"),a&&o&&a>=o&&(t.originalPrice="Original price must be higher than cost price"),Y(t)},X=()=>{const t=parseFloat(s.costPrice)||0,a=parseFloat(s.price)||0,n=parseFloat(s.originalPrice)||0,o=t&&a?((a-t)/a*100).toFixed(1):0,c=t&&a?((a-t)/t*100).toFixed(1):0,l=n&&a?((n-a)/n*100).toFixed(1):0;return{profitMargin:o,markup:c,discountPercent:l}},q=async()=>{E(!0);try{const t=H(S,"products");let a;p||b?a=k(t,ce("createdAt","desc"),U(5)):h&&(i!=null&&i.uid)?a=k(t,M("createdBy","==",i.uid),U(5)):a=k(t,M("createdBy","==",(i==null?void 0:i.uid)||"none"),U(5));const o=(await W(a)).docs.map(c=>{var u;const l=c.data();return{id:c.id,name:l.name||"Unnamed Product",description:l.description||"",price:l.price||0,originalPrice:l.originalPrice||l.price||0,costPrice:l.costPrice||0,stock:l.stock||l.stockQuantity||0,category:l.category||"Uncategorized",imageUrl:l.imageUrl||"",sku:l.sku||"",supplier:l.supplier||"",createdBy:l.createdBy||"unknown",ownedBy:l.ownedBy||l.createdBy||"unknown",createdByEmail:l.createdByEmail||"unknown",createdAt:((u=l.createdAt)==null?void 0:u.toDate())||new Date}});!p&&!b&&o.sort((c,l)=>l.createdAt-c.createdAt),A(o)}catch(t){if(console.error("Error fetching recent products:",t),(t.code==="failed-precondition"||t.message.includes("index"))&&(h||!p)&&i!=null&&i.uid)try{const a=k(productsRef,M("createdBy","==",i.uid),U(5)),o=(await W(a)).docs.map(c=>{var u;const l=c.data();return{id:c.id,name:l.name||"Unnamed Product",price:l.price||0,originalPrice:l.originalPrice||l.price||0,stock:l.stock||l.stockQuantity||0,category:l.category||"Uncategorized",createdAt:((u=l.createdAt)==null?void 0:u.toDate())||new Date}});o.sort((c,l)=>l.createdAt-c.createdAt),A(o)}catch(a){console.error("Simple query also failed:",a)}}finally{E(!1)}},Z=async(t,a)=>{if(!P){const o=$.find(c=>c.id===t);if(!o||o.createdBy!==(i==null?void 0:i.uid)&&o.ownedBy!==(i==null?void 0:i.uid)){y("You can only delete products you created");return}}if(window.confirm(`Are you sure you want to delete "${a}"? This action cannot be undone.`)){R(o=>new Set(o).add(t));try{await ge(me(S,"products",t)),A(o=>o.filter(c=>c.id!==t)),w(!0),setTimeout(()=>w(!1),3e3)}catch(o){console.error("Error deleting product:",o),y("Failed to delete product. Please try again.")}finally{R(o=>{const c=new Set(o);return c.delete(t),c})}}};if(!N)return e.jsx("div",{className:`container mx-auto px-4 py-8 ${r?"text-gray-200":"text-gray-800"}`,children:e.jsxs("div",{className:`max-w-md mx-auto text-center p-8 ${r?"bg-gray-800":"bg-white"} rounded-xl shadow-lg`,children:[e.jsx("div",{className:"text-6xl mb-4",children:"ğŸš«"}),e.jsx("h2",{className:`text-2xl font-bold mb-4 ${r?"text-white":"text-gray-900"}`,children:"Access Denied"}),e.jsx("p",{className:`mb-4 ${r?"text-gray-300":"text-gray-600"}`,children:"You need seller, manager, or admin permissions to add products."}),e.jsx("div",{className:`p-3 rounded-lg mb-6 ${r?"bg-gray-700":"bg-gray-50"}`,children:e.jsxs("p",{className:`text-sm ${r?"text-gray-400":"text-gray-500"}`,children:["Current access level: ",e.jsx("span",{className:"font-medium",children:I})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:()=>f("/catalog"),className:"block w-full py-2 px-4 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors",children:"Browse Products"}),e.jsx("button",{onClick:()=>f(-1),className:`block w-full py-2 px-4 border rounded-lg transition-colors ${r?"border-gray-600 text-gray-300 hover:bg-gray-700":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:"Go Back"})]})]})});const g=t=>{const{name:a,value:n}=t.target;d(o=>({...o,[a]:n})),C&&y(null),L&&w(!1)},_=()=>s.name.trim()?!s.price||parseFloat(s.price)<=0?"Valid selling price is required":!s.stock||parseInt(s.stock)<0?"Valid stock quantity is required":s.category?Object.keys(m).length>0?"Please fix pricing errors before submitting":null:"Category is required":"Product name is required",ee=async t=>{t.preventDefault();const a=_();if(a){y(a);return}D(!0),y(null);try{const n=parseFloat(s.price),o=parseInt(s.stock),c=parseFloat(s.originalPrice)||n,l=parseFloat(s.costPrice)||0,u=parseInt(s.reorderPoint)||Math.max(5,Math.floor(o*.1)),te=s.tags?s.tags.split(",").map(j=>j.trim().toLowerCase()).filter(j=>j):[s.category.toLowerCase(),s.name.toLowerCase().split(" ")[0]],B=s.imageUrls.filter(j=>j.trim()),se=s.imageUrl?[s.imageUrl,...B]:B,ae={name:s.name.trim(),description:s.description.trim()||"",price:n,originalPrice:c,costPrice:l,stock:o,stockQuantity:o,category:s.category,imageUrl:s.imageUrl.trim()||"",imageUrls:B,allImages:se,sku:s.sku.trim()||"",supplier:s.supplier.trim()||"",tags:te,reorderPoint:u,createdBy:i.uid,ownedBy:i.uid,createdByEmail:i.email,businessId:i.uid,businessName:i.businessName||i.displayName||"",createdAt:Q(),updatedAt:Q(),isApproved:!0,status:"active",bulkPricing:s.enableBulkPricing?{10:+(n*.9).toFixed(2),50:+(n*.85).toFixed(2),100:+(n*.8).toFixed(2)}:{}},ie=await de(H(S,"products"),ae);console.log("Product added with ID:",ie.id),w(!0),d({name:"",description:"",originalPrice:"",price:"",costPrice:"",stock:"",category:"",imageUrl:"",imageUrls:[],sku:"",supplier:"",tags:"",reorderPoint:"",enableBulkPricing:!0}),setTimeout(()=>{f("/inventory")},2e3),q()}catch(n){console.error("Error adding product:",n),y("Failed to add product. Please try again.")}finally{D(!1)}},re=()=>{f("/inventory")},{profitMargin:T,markup:O,discountPercent:z}=X();return e.jsxs("div",{className:`container mx-auto px-4 py-8 max-w-4xl ${r?"text-gray-200":"text-gray-800"}`,children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:`text-3xl font-bold ${r?"text-white":"text-gray-900"}`,children:"Add New Product"}),e.jsx("p",{className:`mt-1 text-sm ${r?"text-gray-400":"text-gray-500"}`,children:"Create a comprehensive product listing with pricing, inventory, and business details"}),e.jsxs("div",{className:"mt-2 flex items-center space-x-2",children:[e.jsxs("div",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${r?"bg-green-900/30 text-green-400":"bg-green-100 text-green-800"}`,children:["âœ… ",I," Access"]}),e.jsxs("div",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${r?"bg-blue-900/30 text-blue-400":"bg-blue-100 text-blue-800"}`,children:["ğŸ‘¤ Owner: ",(i==null?void 0:i.displayName)||(i==null?void 0:i.email)||"You"]})]})]}),L&&e.jsx("div",{className:`mb-6 p-4 rounded-lg ${r?"bg-green-900/20 border-green-800 text-green-400":"bg-green-50 border-green-200 text-green-800"} border`,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:"h-5 w-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Product added successfully! Redirecting to inventory..."]})}),C&&e.jsx("div",{className:`mb-6 p-4 rounded-lg ${r?"bg-red-900/20 border-red-800 text-red-400":"bg-red-50 border-red-200 text-red-800"} border`,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:"h-5 w-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),C]})}),e.jsx("div",{className:`${r?"bg-gray-800 border-gray-700":"bg-white border-gray-200"} rounded-xl shadow-lg border`,children:e.jsxs("form",{onSubmit:ee,className:"p-6 space-y-8",children:[e.jsxs("div",{children:[e.jsx("h3",{className:`text-lg font-semibold mb-4 ${r?"text-white":"text-gray-900"}`,children:"ğŸ“ Basic Information"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx("label",{htmlFor:"name",className:`block text-sm font-medium ${r?"text-gray-300":"text-gray-700"} mb-2`,children:"Product Name *"}),e.jsx("input",{type:"text",id:"name",name:"name",value:s.name,onChange:g,className:`w-full px-3 py-2 border rounded-md ${r?"bg-gray-700 border-gray-600 text-gray-200 placeholder-gray-400":"bg-white border-gray-300 text-gray-900"} focus:ring-indigo-500 focus:border-indigo-500`,placeholder:"Enter product name",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"sku",className:`block text-sm font-medium ${r?"text-gray-300":"text-gray-700"} mb-2`,children:"SKU (Stock Keeping Unit)"}),e.jsx("input",{type:"text",id:"sku",name:"sku",value:s.sku,onChange:g,className:`w-full px-3 py-2 border rounded-md ${r?"bg-gray-700 border-gray-600 text-gray-200 placeholder-gray-400":"bg-white border-gray-300 text-gray-900"} focus:ring-indigo-500 focus:border-indigo-500`,placeholder:"e.g., APL-IP16-256"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"category",className:`block text-sm font-medium ${r?"text-gray-300":"text-gray-700"} mb-2`,children:"Category *"}),e.jsxs("select",{id:"category",name:"category",value:s.category,onChange:g,className:`w-full px-3 py-2 border rounded-md ${r?"bg-gray-700 border-gray-600 text-gray-200":"bg-white border-gray-300 text-gray-900"} focus:ring-indigo-500 focus:border-indigo-500`,required:!0,children:[e.jsx("option",{value:"",children:"Select a category"}),K.map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx("label",{htmlFor:"description",className:`block text-sm font-medium ${r?"text-gray-300":"text-gray-700"} mb-2`,children:"Description"}),e.jsx("textarea",{id:"description",name:"description",value:s.description,onChange:g,rows:3,className:`w-full px-3 py-2 border rounded-md ${r?"bg-gray-700 border-gray-600 text-gray-200 placeholder-gray-400":"bg-white border-gray-300 text-gray-900"} focus:ring-indigo-500 focus:border-indigo-500`,placeholder:"Enter detailed product description..."})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:`text-lg font-semibold mb-4 ${r?"text-white":"text-gray-900"}`,children:"ğŸ’° Pricing & Margins"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"costPrice",className:`block text-sm font-medium ${r?"text-gray-300":"text-gray-700"} mb-2`,children:["Cost Price ($)",e.jsx("span",{className:`text-xs ml-1 ${r?"text-gray-400":"text-gray-500"}`,children:"(Your wholesale cost)"})]}),e.jsx("input",{type:"number",id:"costPrice",name:"costPrice",value:s.costPrice,onChange:g,step:"0.01",min:"0",className:`w-full px-3 py-2 border rounded-md ${m.costPrice?"border-red-500 focus:border-red-500 focus:ring-red-500":r?"bg-gray-700 border-gray-600 text-gray-200 placeholder-gray-400":"bg-white border-gray-300 text-gray-900"} focus:ring-indigo-500 focus:border-indigo-500`,placeholder:"0.00"}),m.costPrice&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:m.costPrice})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"price",className:`block text-sm font-medium ${r?"text-gray-300":"text-gray-700"} mb-2`,children:["Selling Price ($) *",e.jsx("span",{className:`text-xs ml-1 ${r?"text-gray-400":"text-gray-500"}`,children:"(Current price)"})]}),e.jsx("input",{type:"number",id:"price",name:"price",value:s.price,onChange:g,step:"0.01",min:"0",className:`w-full px-3 py-2 border rounded-md ${m.price?"border-red-500 focus:border-red-500 focus:ring-red-500":r?"bg-gray-700 border-gray-600 text-gray-200 placeholder-gray-400":"bg-white border-gray-300 text-gray-900"} focus:ring-indigo-500 focus:border-indigo-500`,placeholder:"0.00",required:!0}),m.price&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:m.price})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"originalPrice",className:`block text-sm font-medium ${r?"text-gray-300":"text-gray-700"} mb-2`,children:["Original Price ($)",e.jsx("span",{className:`text-xs ml-1 ${r?"text-gray-400":"text-gray-500"}`,children:"(MSRP/List price)"})]}),e.jsx("input",{type:"number",id:"originalPrice",name:"originalPrice",value:s.originalPrice,onChange:g,step:"0.01",min:"0",className:`w-full px-3 py-2 border rounded-md ${m.originalPrice?"border-red-500 focus:border-red-500 focus:ring-red-500":r?"bg-gray-700 border-gray-600 text-gray-200 placeholder-gray-400":"bg-white border-gray-300 text-gray-900"} focus:ring-indigo-500 focus:border-indigo-500`,placeholder:"0.00"}),m.originalPrice&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:m.originalPrice})]})]}),(s.price||s.costPrice||s.originalPrice)&&e.jsxs("div",{className:`mt-4 p-4 rounded-lg ${r?"bg-gray-700/50":"bg-gray-50"}`,children:[e.jsx("h4",{className:`text-sm font-medium mb-2 ${r?"text-gray-300":"text-gray-700"}`,children:"ğŸ“Š Pricing Analytics"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[T>0&&e.jsxs("div",{className:`${r?"text-green-400":"text-green-600"}`,children:["ğŸ“ˆ Profit Margin: ",T,"%"]}),O>0&&e.jsxs("div",{className:`${r?"text-blue-400":"text-blue-600"}`,children:["ğŸ”¢ Markup: ",O,"%"]}),z>0&&e.jsxs("div",{className:`${r?"text-purple-400":"text-purple-600"}`,children:["ğŸ·ï¸ Discount: ",z,"%"]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:`text-lg font-semibold mb-4 ${r?"text-white":"text-gray-900"}`,children:"ğŸ“¦ Inventory Management"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"stock",className:`block text-sm font-medium ${r?"text-gray-300":"text-gray-700"} mb-2`,children:"Stock Quantity *"}),e.jsx("input",{type:"number",id:"stock",name:"stock",value:s.stock,onChange:g,min:"0",className:`w-full px-3 py-2 border rounded-md ${r?"bg-gray-700 border-gray-600 text-gray-200 placeholder-gray-400":"bg-white border-gray-300 text-gray-900"} focus:ring-indigo-500 focus:border-indigo-500`,placeholder:"0",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"reorderPoint",className:`block text-sm font-medium ${r?"text-gray-300":"text-gray-700"} mb-2`,children:["Reorder Point",e.jsx("span",{className:`text-xs ml-1 ${r?"text-gray-400":"text-gray-500"}`,children:"(When to restock)"})]}),e.jsx("input",{type:"number",id:"reorderPoint",name:"reorderPoint",value:s.reorderPoint,onChange:g,min:"0",className:`w-full px-3 py-2 border rounded-md ${r?"bg-gray-700 border-gray-600 text-gray-200 placeholder-gray-400":"bg-white border-gray-300 text-gray-900"} focus:ring-indigo-500 focus:border-indigo-500`,placeholder:"Auto-calculated"}),e.jsx("p",{className:`text-xs mt-1 ${r?"text-gray-400":"text-gray-500"}`,children:"Auto-calculated as 10% of stock (minimum 5 units)"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:`text-lg font-semibold mb-4 ${r?"text-white":"text-gray-900"}`,children:"ğŸ¢ Business Information"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"supplier",className:`block text-sm font-medium ${r?"text-gray-300":"text-gray-700"} mb-2`,children:"Supplier"}),e.jsxs("select",{id:"supplier",name:"supplier",value:s.supplier,onChange:g,className:`w-full px-3 py-2 border rounded-md ${r?"bg-gray-700 border-gray-600 text-gray-200":"bg-white border-gray-300 text-gray-900"} focus:ring-indigo-500 focus:border-indigo-500`,children:[e.jsx("option",{value:"",children:"Select supplier"}),G.map(t=>e.jsx("option",{value:t,children:t},t))]}),s.supplier==="Custom Supplier"&&e.jsx("input",{type:"text",placeholder:"Enter custom supplier name",className:`w-full mt-2 px-3 py-2 border rounded-md ${r?"bg-gray-700 border-gray-600 text-gray-200 placeholder-gray-400":"bg-white border-gray-300 text-gray-900"} focus:ring-indigo-500 focus:border-indigo-500`,onChange:t=>d(a=>({...a,supplier:t.target.value}))})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"tags",className:`block text-sm font-medium ${r?"text-gray-300":"text-gray-700"} mb-2`,children:["Tags",e.jsx("span",{className:`text-xs ml-1 ${r?"text-gray-400":"text-gray-500"}`,children:"(comma separated)"})]}),e.jsx("input",{type:"text",id:"tags",name:"tags",value:s.tags,onChange:g,className:`w-full px-3 py-2 border rounded-md ${r?"bg-gray-700 border-gray-600 text-gray-200 placeholder-gray-400":"bg-white border-gray-300 text-gray-900"} focus:ring-indigo-500 focus:border-indigo-500`,placeholder:"e.g., premium, wireless, portable"}),e.jsx("p",{className:`text-xs mt-1 ${r?"text-gray-400":"text-gray-500"}`,children:"Auto-generated from category and product name if left empty"})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:`text-lg font-semibold mb-4 ${r?"text-white":"text-gray-900"}`,children:["ğŸ–¼ï¸ Product Images",e.jsx("span",{className:`text-sm font-normal ml-2 ${r?"text-gray-400":"text-gray-500"}`,children:"(Add up to 5 images)"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{htmlFor:"imageUrl",className:`block text-sm font-medium ${r?"text-gray-300":"text-gray-700"} mb-2`,children:["Primary Image URL *",e.jsx("span",{className:`text-xs ml-1 ${r?"text-gray-400":"text-gray-500"}`,children:"(Main product image)"})]}),e.jsx("input",{type:"url",id:"imageUrl",name:"imageUrl",value:s.imageUrl,onChange:g,className:`w-full px-3 py-2 border rounded-md ${r?"bg-gray-700 border-gray-600 text-gray-200 placeholder-gray-400":"bg-white border-gray-300 text-gray-900"} focus:ring-indigo-500 focus:border-indigo-500`,placeholder:"https://example.com/primary-image.jpg"}),s.imageUrl&&e.jsxs("div",{className:"mt-3",children:[e.jsx("p",{className:`text-sm font-medium mb-2 ${r?"text-gray-300":"text-gray-700"}`,children:"Primary Image Preview:"}),e.jsx("div",{className:`w-32 h-32 rounded-lg border-2 border-dashed ${r?"border-gray-600":"border-gray-300"} flex items-center justify-center overflow-hidden`,children:e.jsx("img",{src:s.imageUrl,alt:"Primary product preview",className:"w-full h-full object-cover rounded-lg",onError:t=>{t.target.style.display="none",t.target.parentNode.innerHTML=`
                          <div class="text-center p-4">
                            <span class="text-red-500 text-sm">âŒ Invalid image URL</span>
                          </div>
                        `}})})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:`block text-sm font-medium ${r?"text-gray-300":"text-gray-700"} mb-2`,children:["Additional Images (Optional)",e.jsx("span",{className:`text-xs ml-1 ${r?"text-gray-400":"text-gray-500"}`,children:"(Up to 4 more images for gallery view)"})]}),e.jsx("div",{className:"space-y-3",children:[0,1,2,3].map(t=>e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"url",value:s.imageUrls[t]||"",onChange:a=>{const n=[...s.imageUrls];n[t]=a.target.value,d(o=>({...o,imageUrls:n}))},className:`flex-1 px-3 py-2 border rounded-md ${r?"bg-gray-700 border-gray-600 text-gray-200 placeholder-gray-400":"bg-white border-gray-300 text-gray-900"} focus:ring-indigo-500 focus:border-indigo-500`,placeholder:`https://example.com/image-${t+2}.jpg`}),s.imageUrls[t]&&e.jsx("div",{className:`w-12 h-12 rounded border ${r?"border-gray-600":"border-gray-300"} overflow-hidden flex-shrink-0`,children:e.jsx("img",{src:s.imageUrls[t],alt:`Preview ${t+2}`,className:"w-full h-full object-cover",onError:a=>{a.target.style.display="none",a.target.parentNode.innerHTML='<div class="w-full h-full bg-red-100 flex items-center justify-center"><span class="text-red-500 text-xs">âŒ</span></div>'}})}),s.imageUrls[t]&&e.jsx("button",{type:"button",onClick:()=>{const a=[...s.imageUrls];a[t]="",d(n=>({...n,imageUrls:a}))},className:`p-2 rounded ${r?"text-red-400 hover:bg-red-900/20":"text-red-600 hover:bg-red-50"} transition-colors`,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},t))}),(s.imageUrl||s.imageUrls.some(t=>t))&&e.jsxs("div",{className:`mt-4 p-4 rounded-lg ${r?"bg-gray-700/50":"bg-gray-50"}`,children:[e.jsx("p",{className:`text-sm font-medium mb-3 ${r?"text-gray-300":"text-gray-700"}`,children:"ğŸ“¸ Gallery Preview (how it will look to customers):"}),e.jsxs("div",{className:"flex space-x-2 overflow-x-auto",children:[s.imageUrl&&e.jsx("div",{className:"w-20 h-20 rounded-lg border-2 border-indigo-500 overflow-hidden flex-shrink-0",children:e.jsx("img",{src:s.imageUrl,alt:"Primary",className:"w-full h-full object-cover"})}),s.imageUrls.filter(t=>t).map((t,a)=>e.jsx("div",{className:`w-20 h-20 rounded-lg border-2 ${r?"border-gray-600":"border-gray-200"} overflow-hidden flex-shrink-0`,children:e.jsx("img",{src:t,alt:`Additional ${a+1}`,className:"w-full h-full object-cover"})},a))]}),e.jsxs("p",{className:`text-xs mt-2 ${r?"text-gray-400":"text-gray-500"}`,children:["Total images: ",[s.imageUrl,...s.imageUrls.filter(t=>t)].length,s.imageUrl&&" (Primary image has blue border)"]})]})]}),e.jsxs("div",{className:"flex items-center my-4",children:[e.jsx("div",{className:`flex-1 border-t ${r?"border-gray-600":"border-gray-300"}`}),e.jsx("span",{className:`px-3 text-sm ${r?"text-gray-400":"text-gray-500"}`,children:"OR"}),e.jsx("div",{className:`flex-1 border-t ${r?"border-gray-600":"border-gray-300"}`})]}),e.jsxs("div",{children:[e.jsxs("p",{className:`text-sm font-medium mb-2 ${r?"text-gray-300":"text-gray-700"}`,children:["Upload Image File",e.jsx("span",{className:`text-xs ml-1 ${r?"text-gray-400":"text-gray-500"}`,children:"(Upload from your device - will set as primary image)"})]}),e.jsx(ue,{initialImage:s.imageUrl,onImageUploaded:t=>d(a=>({...a,imageUrl:t})),folder:"product-images",customId:i==null?void 0:i.uid,darkMode:r,autoUpload:!0})]}),e.jsxs("div",{className:`mt-4 p-3 rounded-lg ${r?"bg-gray-700/50":"bg-gray-50"}`,children:[e.jsx("p",{className:`text-sm font-medium mb-2 ${r?"text-gray-300":"text-gray-700"}`,children:"ğŸ”— Quick Demo Images (for testing):"}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-2 text-xs",children:[e.jsx("button",{type:"button",onClick:()=>d(t=>({...t,imageUrl:"https://images.unsplash.com/photo-1505740420928-5e560c06d30e?w=500&h=500&fit=crop"})),className:`text-left p-2 rounded ${r?"hover:bg-gray-600 text-blue-400":"hover:bg-gray-200 text-blue-600"} transition-colors`,children:"ğŸ“± Phone (Primary)"}),e.jsx("button",{type:"button",onClick:()=>{const t=[...s.imageUrls];t[0]="https://images.unsplash.com/photo-1542291026-7eec264c27ff?w=500&h=500&fit=crop",d(a=>({...a,imageUrls:t}))},className:`text-left p-2 rounded ${r?"hover:bg-gray-600 text-blue-400":"hover:bg-gray-200 text-blue-600"} transition-colors`,children:"ğŸ‘Ÿ Sneakers"}),e.jsx("button",{type:"button",onClick:()=>{const t=[...s.imageUrls];t[1]="https://images.unsplash.com/photo-1496181133206-80ce9b88a853?w=500&h=500&fit=crop",d(a=>({...a,imageUrls:t}))},className:`text-left p-2 rounded ${r?"hover:bg-gray-600 text-blue-400":"hover:bg-gray-200 text-blue-600"} transition-colors`,children:"ğŸ’» Laptop"}),e.jsx("button",{type:"button",onClick:()=>{const t=[...s.imageUrls];t[2]="https://images.unsplash.com/photo-1523275335684-37898b6baf30?w=500&h=500&fit=crop",d(a=>({...a,imageUrls:t}))},className:`text-left p-2 rounded ${r?"hover:bg-gray-600 text-blue-400":"hover:bg-gray-200 text-blue-600"} transition-colors`,children:"âŒš Watch"})]}),e.jsx("p",{className:`text-xs mt-2 ${r?"text-gray-400":"text-gray-500"}`,children:"ğŸ’¡ Tip: Use the first button to set a primary image, then use others to add gallery images"})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:`text-lg font-semibold mb-4 ${r?"text-white":"text-gray-900"}`,children:"ğŸ¯ Bulk Pricing"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:s.enableBulkPricing,onChange:t=>d(a=>({...a,enableBulkPricing:t.target.checked})),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),e.jsx("span",{className:`ml-2 text-sm ${r?"text-gray-300":"text-gray-700"}`,children:"Enable automatic bulk pricing discounts"})]}),s.enableBulkPricing&&s.price&&e.jsxs("div",{className:`p-4 rounded-lg ${r?"bg-gray-700/50":"bg-gray-50"}`,children:[e.jsx("h4",{className:`text-sm font-medium mb-2 ${r?"text-gray-300":"text-gray-700"}`,children:"Bulk Pricing Tiers"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{className:`${r?"text-green-400":"text-green-600"}`,children:["ğŸ“¦ 10+ units: $",(parseFloat(s.price)*.9).toFixed(2)," (10% off)"]}),e.jsxs("div",{className:`${r?"text-blue-400":"text-blue-600"}`,children:["ğŸ“¦ 50+ units: $",(parseFloat(s.price)*.85).toFixed(2)," (15% off)"]}),e.jsxs("div",{className:`${r?"text-purple-400":"text-purple-600"}`,children:["ğŸ“¦ 100+ units: $",(parseFloat(s.price)*.8).toFixed(2)," (20% off)"]})]})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-4 pt-6 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("button",{type:"button",onClick:re,className:`px-6 py-2 border rounded-md font-medium ${r?"border-gray-600 text-gray-300 hover:bg-gray-700":"border-gray-300 text-gray-700 hover:bg-gray-50"} transition-colors`,disabled:v,children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:v||Object.keys(m).length>0,className:"px-8 py-2 bg-indigo-600 text-white rounded-md font-medium hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center",children:[v&&e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),v?"Adding Product...":"Add Product"]})]})]})}),e.jsx("div",{className:`mt-6 p-4 rounded-lg ${r?"bg-blue-900/20 border-blue-800":"bg-blue-50 border-blue-200"} border`,children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("svg",{className:`h-5 w-5 ${r?"text-blue-400":"text-blue-600"} mt-0.5 mr-3`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("div",{children:[e.jsx("h3",{className:`text-sm font-medium ${r?"text-blue-300":"text-blue-800"} mb-1`,children:"Ownership & Business Features"}),e.jsxs("ul",{className:`text-sm ${r?"text-blue-200":"text-blue-700"} space-y-1`,children:[e.jsx("li",{children:"â€¢ Products automatically owned by you with full management rights"}),e.jsx("li",{children:"â€¢ Pricing structure tracks cost, selling, and original prices for margin analysis"}),e.jsx("li",{children:"â€¢ Bulk pricing tiers automatically calculated when enabled"}),e.jsx("li",{children:"â€¢ Inventory reorder points help manage stock levels"}),e.jsx("li",{children:"â€¢ Supplier and tag information for better organization"})]})]})]})}),N&&e.jsxs("div",{className:`mt-8 ${r?"bg-gray-800 border-gray-700":"bg-white border-gray-200"} rounded-xl shadow-lg border`,children:[e.jsxs("div",{className:`px-6 py-4 border-b ${r?"border-gray-700":"border-gray-200"} flex justify-between items-center`,children:[e.jsxs("div",{children:[e.jsx("h3",{className:`text-lg font-semibold ${r?"text-white":"text-gray-900"}`,children:h?"My Recent Products":"Recently Added Products"}),e.jsx("p",{className:`text-sm ${r?"text-gray-400":"text-gray-500"}`,children:p||b?"All recent products (Admin/Manager View)":h?"Your recent product listings":"Your recent products"})]}),$.length>0&&e.jsx("div",{className:`px-2 py-1 rounded-full text-xs font-medium ${P?r?"bg-red-900/30 text-red-400":"bg-red-100 text-red-800":r?"bg-blue-900/30 text-blue-400":"bg-blue-100 text-blue-800"}`,children:P?"ğŸ—‘ï¸ Delete Access":"ğŸ‘ï¸ View Only"})]}),e.jsx("div",{className:"p-6",children:V?e.jsxs("div",{className:"flex justify-center items-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-indigo-500"}),e.jsx("span",{className:`ml-3 ${r?"text-gray-400":"text-gray-500"}`,children:"Loading recent products..."})]}):$.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:`text-4xl mb-3 ${r?"text-gray-600":"text-gray-400"}`,children:"ğŸ“¦"}),e.jsx("p",{className:`${r?"text-gray-400":"text-gray-500"} mb-2`,children:h?"No products created yet":"No recent products to display"}),e.jsx("p",{className:`text-sm ${r?"text-gray-500":"text-gray-400"}`,children:h?"Add your first product above to start selling":"Products you create will appear here"})]}):e.jsx("div",{className:"space-y-3",children:$.map(t=>{var a,n;return e.jsxs("div",{className:`flex items-center justify-between p-4 rounded-lg border ${r?"border-gray-700 bg-gray-700/50":"border-gray-200 bg-gray-50"}`,children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-lg ${r?"bg-gray-600":"bg-gray-200"} flex items-center justify-center overflow-hidden`,children:t.imageUrl?e.jsx("img",{src:t.imageUrl,alt:t.name,className:"w-full h-full object-cover"}):e.jsx("span",{className:"text-2xl",children:"ğŸ“¦"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:`font-medium ${r?"text-white":"text-gray-900"}`,children:t.name}),e.jsxs("div",{className:"flex items-center space-x-4 mt-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:`text-sm font-medium ${r?"text-green-400":"text-green-600"}`,children:["$",(a=t.price)==null?void 0:a.toFixed(2)]}),t.originalPrice&&t.originalPrice>t.price&&e.jsxs("span",{className:`text-xs line-through ${r?"text-gray-500":"text-gray-400"}`,children:["$",(n=t.originalPrice)==null?void 0:n.toFixed(2)]})]}),e.jsxs("span",{className:`text-sm ${r?"text-gray-400":"text-gray-500"}`,children:["Stock: ",t.stock]}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${r?"bg-blue-900/30 text-blue-400":"bg-blue-100 text-blue-800"}`,children:t.category})]}),e.jsxs("p",{className:`text-xs ${r?"text-gray-500":"text-gray-400"} mt-1`,children:["Added ",t.createdAt.toLocaleDateString(),(p||b)&&t.createdBy!==i.uid&&e.jsxs("span",{className:`ml-2 px-1 py-0.5 rounded text-xs ${r?"bg-purple-900/30 text-purple-400":"bg-purple-100 text-purple-700"}`,children:["by ",t.createdByEmail||"other user"]}),t.createdBy===i.uid&&e.jsx("span",{className:`ml-2 px-1 py-0.5 rounded text-xs ${r?"bg-green-900/30 text-green-400":"bg-green-100 text-green-700"}`,children:"by you"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>f(`/products/${t.id}`),className:`px-3 py-1 text-sm rounded-md ${r?"text-blue-400 hover:bg-blue-900/20":"text-blue-600 hover:bg-blue-50"} transition-colors`,children:"View"}),(P||t.createdBy===(i==null?void 0:i.uid))&&e.jsx("button",{onClick:()=>Z(t.id,t.name),disabled:F.has(t.id),className:`px-3 py-1 text-sm rounded-md transition-colors ${F.has(t.id)?"opacity-50 cursor-not-allowed bg-gray-400 text-white":r?"text-red-400 hover:bg-red-900/20 border border-red-800":"text-red-600 hover:bg-red-50 border border-red-200"}`,children:F.has(t.id)?e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-t border-b border-white mr-1"}),"Deleting..."]}):"ğŸ—‘ï¸ Delete"})]})]},t.id)})})})]})]})};export{je as default};
