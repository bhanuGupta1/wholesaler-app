import{r as d,j as e,b as v,e as w,d as p,m as $,c as P}from"./index-Cayz1xms.js";import{I as C}from"./ImageUploader-Cg8xnCPV.js";const E=({product:o,onClose:l,categories:h,darkMode:r})=>{const m=!!o,[s,g]=d.useState({name:"",sku:"",category:"",price:"",stock:"",description:"",imageUrl:"",costPrice:"",supplier:"",reorderPoint:""}),[u,x]=d.useState(!1),[t,b]=d.useState({});d.useEffect(()=>{o&&g({name:o.name||"",sku:o.sku||"",category:o.category||"",price:o.price||"",stock:o.stock||"",description:o.description||"",imageUrl:o.imageUrl||"",costPrice:o.costPrice||"",supplier:o.supplier||"",reorderPoint:o.reorderPoint||""})},[o]);const y=()=>{const i={};return s.name.trim()||(i.name="Product name is required"),s.category||(i.category="Category is required"),s.price?(isNaN(s.price)||Number(s.price)<=0)&&(i.price="Price must be a positive number"):i.price="Price is required",s.stock?(isNaN(s.stock)||Number(s.stock)<0||!Number.isInteger(Number(s.stock)))&&(i.stock="Stock must be a non-negative integer"):i.stock="Stock quantity is required",s.costPrice&&(isNaN(s.costPrice)||Number(s.costPrice)<=0)&&(i.costPrice="Cost price must be a positive number"),s.reorderPoint&&(isNaN(s.reorderPoint)||Number(s.reorderPoint)<0||!Number.isInteger(Number(s.reorderPoint)))&&(i.reorderPoint="Reorder point must be a non-negative integer"),i},n=i=>{const{name:a,value:c}=i.target;g(f=>({...f,[a]:c})),t[a]&&b(f=>({...f,[a]:void 0}))},j=i=>{g(a=>({...a,imageUrl:i}))},N=async i=>{i.preventDefault();const a=y();if(Object.keys(a).length>0){b(a);return}try{x(!0);const c={name:s.name,sku:s.sku,category:s.category,price:Number(s.price),stock:Number(s.stock),description:s.description,imageUrl:s.imageUrl,costPrice:s.costPrice?Number(s.costPrice):null,supplier:s.supplier,reorderPoint:s.reorderPoint?Number(s.reorderPoint):null,updatedAt:new Date};m?await v(w(p,"products",o.id),c):(c.createdAt=new Date,await $(P(p,"products"),c)),x(!1),l(!0)}catch(c){console.error("Error saving product:",c),x(!1),b({submit:"Failed to save product. Please try again."})}};return e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75 overflow-y-auto h-full w-full z-50 flex items-center justify-center",children:e.jsxs("div",{className:`relative ${r?"bg-gray-800 text-gray-200":"bg-white text-gray-900"} rounded-lg shadow-xl mx-auto max-w-2xl w-full`,children:[e.jsx("div",{className:`${r?"bg-gray-700 border-gray-600":"bg-gray-50 border-gray-200"} py-4 px-6 rounded-t-lg border-b`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:`text-lg font-medium ${r?"text-gray-200":"text-gray-900"}`,children:m?"Edit Product":"Add New Product"}),e.jsx("button",{type:"button",onClick:()=>l(!1),className:`${r?"text-gray-400 hover:text-gray-300":"text-gray-400 hover:text-gray-500"} focus:outline-none`,children:e.jsx("svg",{className:"h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsxs("form",{onSubmit:N,className:"p-6",children:[t.submit&&e.jsx("div",{className:`mb-4 ${r?"bg-red-900/30 border-red-800":"bg-red-50 border-red-400"} border-l-4 p-4 rounded-md`,children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-red-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:`text-sm ${r?"text-red-400":"text-red-700"}`,children:t.submit})})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"name",className:`block text-sm font-medium ${r?"text-gray-300":"text-gray-700"}`,children:["Product Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"name",id:"name",value:s.name,onChange:n,className:`mt-1 block w-full shadow-sm sm:text-sm rounded-md ${t.name?`${r?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-red-300 focus:ring-red-500 focus:border-red-500"}`:`${r?"border-gray-600 bg-gray-700 focus:ring-indigo-500 focus:border-indigo-500":"border-gray-300 focus:ring-indigo-500 focus:border-indigo-500"}`}`,placeholder:"Enter product name"}),t.name&&e.jsx("p",{className:`mt-1 text-sm ${r?"text-red-400":"text-red-600"}`,children:t.name})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"sku",className:`block text-sm font-medium ${r?"text-gray-300":"text-gray-700"}`,children:"SKU"}),e.jsx("input",{type:"text",name:"sku",id:"sku",value:s.sku,onChange:n,className:`mt-1 block w-full shadow-sm sm:text-sm rounded-md ${r?"border-gray-600 bg-gray-700 focus:ring-indigo-500 focus:border-indigo-500":"border-gray-300 focus:ring-indigo-500 focus:border-indigo-500"}`,placeholder:"Enter SKU (optional)"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"category",className:`block text-sm font-medium ${r?"text-gray-300":"text-gray-700"}`,children:["Category ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{id:"category",name:"category",value:s.category,onChange:n,className:`mt-1 block w-full pl-3 pr-10 py-2 text-base shadow-sm sm:text-sm rounded-md ${t.category?`${r?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-red-300 focus:ring-red-500 focus:border-red-500"}`:`${r?"border-gray-600 bg-gray-700 focus:ring-indigo-500 focus:border-indigo-500":"border-gray-300 focus:ring-indigo-500 focus:border-indigo-500"}`}`,children:[e.jsx("option",{value:"",children:"Select a category"}),h.map(i=>e.jsx("option",{value:i,children:i},i))]}),t.category&&e.jsx("p",{className:`mt-1 text-sm ${r?"text-red-400":"text-red-600"}`,children:t.category})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"price",className:`block text-sm font-medium ${r?"text-gray-300":"text-gray-700"}`,children:["Selling Price ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"mt-1 relative rounded-md shadow-sm",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("span",{className:`${r?"text-gray-400":"text-gray-500"} sm:text-sm`,children:"$"})}),e.jsx("input",{type:"number",name:"price",id:"price",value:s.price,onChange:n,step:"0.01",min:"0",className:`block w-full pl-7 pr-12 sm:text-sm rounded-md ${t.price?`${r?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-red-300 focus:ring-red-500 focus:border-red-500"}`:`${r?"border-gray-600 bg-gray-700 focus:ring-indigo-500 focus:border-indigo-500":"border-gray-300 focus:ring-indigo-500 focus:border-indigo-500"}`}`,placeholder:"0.00"})]}),t.price&&e.jsx("p",{className:`mt-1 text-sm ${r?"text-red-400":"text-red-600"}`,children:t.price})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"stock",className:`block text-sm font-medium ${r?"text-gray-300":"text-gray-700"}`,children:["Stock Quantity ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",name:"stock",id:"stock",value:s.stock,onChange:n,min:"0",step:"1",className:`mt-1 block w-full shadow-sm sm:text-sm rounded-md ${t.stock?`${r?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-red-300 focus:ring-red-500 focus:border-red-500"}`:`${r?"border-gray-600 bg-gray-700 focus:ring-indigo-500 focus:border-indigo-500":"border-gray-300 focus:ring-indigo-500 focus:border-indigo-500"}`}`,placeholder:"0"}),t.stock&&e.jsx("p",{className:`mt-1 text-sm ${r?"text-red-400":"text-red-600"}`,children:t.stock})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${r?"text-gray-300":"text-gray-700"} mb-2`,children:"Product Image"}),e.jsx(C,{initialImage:s.imageUrl,onImageUploaded:j,folder:"product-images",itemId:m?o.id:null,maxSizeMB:2,aspectRatio:[1,1],darkMode:r,showPreview:!0,autoUpload:!0})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"costPrice",className:`block text-sm font-medium ${r?"text-gray-300":"text-gray-700"}`,children:"Cost Price"}),e.jsxs("div",{className:"mt-1 relative rounded-md shadow-sm",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("span",{className:`${r?"text-gray-400":"text-gray-500"} sm:text-sm`,children:"$"})}),e.jsx("input",{type:"number",name:"costPrice",id:"costPrice",value:s.costPrice,onChange:n,step:"0.01",min:"0",className:`block w-full pl-7 pr-12 sm:text-sm rounded-md ${t.costPrice?`${r?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-red-300 focus:ring-red-500 focus:border-red-500"}`:`${r?"border-gray-600 bg-gray-700 focus:ring-indigo-500 focus:border-indigo-500":"border-gray-300 focus:ring-indigo-500 focus:border-indigo-500"}`}`,placeholder:"0.00"})]}),t.costPrice&&e.jsx("p",{className:`mt-1 text-sm ${r?"text-red-400":"text-red-600"}`,children:t.costPrice})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"supplier",className:`block text-sm font-medium ${r?"text-gray-300":"text-gray-700"}`,children:"Supplier"}),e.jsx("input",{type:"text",name:"supplier",id:"supplier",value:s.supplier,onChange:n,className:`mt-1 block w-full shadow-sm sm:text-sm rounded-md ${r?"border-gray-600 bg-gray-700 focus:ring-indigo-500 focus:border-indigo-500":"border-gray-300 focus:ring-indigo-500 focus:border-indigo-500"}`,placeholder:"Enter supplier name (optional)"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"reorderPoint",className:`block text-sm font-medium ${r?"text-gray-300":"text-gray-700"}`,children:"Reorder Point"}),e.jsx("input",{type:"number",name:"reorderPoint",id:"reorderPoint",value:s.reorderPoint,onChange:n,min:"0",step:"1",className:`mt-1 block w-full shadow-sm sm:text-sm rounded-md ${t.reorderPoint?`${r?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-red-300 focus:ring-red-500 focus:border-red-500"}`:`${r?"border-gray-600 bg-gray-700 focus:ring-indigo-500 focus:border-indigo-500":"border-gray-300 focus:ring-indigo-500 focus:border-indigo-500"}`}`,placeholder:"0"}),t.reorderPoint&&e.jsx("p",{className:`mt-1 text-sm ${r?"text-red-400":"text-red-600"}`,children:t.reorderPoint}),e.jsx("p",{className:`mt-1 text-xs ${r?"text-gray-400":"text-gray-500"}`,children:"Minimum inventory level before reordering"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"description",className:`block text-sm font-medium ${r?"text-gray-300":"text-gray-700"}`,children:"Description"}),e.jsx("textarea",{id:"description",name:"description",rows:"5",value:s.description,onChange:n,className:`mt-1 block w-full shadow-sm sm:text-sm rounded-md ${r?"border-gray-600 bg-gray-700 focus:ring-indigo-500 focus:border-indigo-500":"border-gray-300 focus:ring-indigo-500 focus:border-indigo-500"}`,placeholder:"Enter product description (optional)"})]})]})]}),e.jsxs("div",{className:"mt-8 flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:()=>l(!1),className:`inline-flex justify-center py-2 px-4 border ${r?"border-gray-600 text-gray-300 bg-gray-700 hover:bg-gray-600":"border-gray-300 text-gray-700 bg-white hover:bg-gray-50"} shadow-sm text-sm font-medium rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500`,children:"Cancel"}),e.jsx("button",{type:"submit",disabled:u,className:`inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white ${u?`${r?"bg-indigo-500 opacity-70":"bg-indigo-400"}`:"bg-indigo-600 hover:bg-indigo-700"} focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500`,children:u?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):"Save Product"})]})]})]})})};export{E as P};
