import{a as E,u as L,j as e,d as P}from"./index-DxRwWpQI.js";import{r as n}from"./vendor-DJ1oPbzn.js";import{h as R,d as U,j as I,u as A,k as M}from"./firebase-DMhjYMbV.js";import{I as q}from"./ImageUploader-aMgK4mO8.js";const J=()=>{var b,y,h,f,w,j,N,v;const{user:r}=E(),{darkMode:a}=L(),[c,g]=n.useState(!1),[x,i]=n.useState({type:"",text:""}),[m,$]=n.useState("profile"),[o,d]=n.useState({displayName:(r==null?void 0:r.displayName)||"",email:(r==null?void 0:r.email)||"",phoneNumber:"",bio:"",company:"",jobTitle:"",photoURL:(r==null?void 0:r.photoURL)||""}),[l,u]=n.useState({currentPassword:"",newPassword:"",confirmPassword:""});n.useEffect(()=>{(async()=>{if(r)try{const s=await R(U(P,"users",r.uid));if(s.exists()){const p=s.data();d(C=>({...C,phoneNumber:p.phoneNumber||"",bio:p.bio||"",company:p.company||"",jobTitle:p.jobTitle||""}))}}catch(s){console.error("Error loading user data:",s)}})()},[r]);const T=async t=>{t.preventDefault(),g(!0),i({type:"",text:""});try{await I(r,{displayName:o.displayName,photoURL:o.photoURL}),await A(U(P,"users",r.uid),{displayName:o.displayName,phoneNumber:o.phoneNumber,bio:o.bio,company:o.company,jobTitle:o.jobTitle,photoURL:o.photoURL,updatedAt:new Date}),i({type:"success",text:"Profile updated successfully!"})}catch(s){console.error("Error updating profile:",s),i({type:"error",text:"Failed to update profile. Please try again."})}finally{g(!1)}},D=async t=>{if(t.preventDefault(),l.newPassword!==l.confirmPassword){i({type:"error",text:"Passwords do not match."});return}if(l.newPassword.length<6){i({type:"error",text:"Password must be at least 6 characters long."});return}g(!0),i({type:"",text:""});try{await M(r,l.newPassword),i({type:"success",text:"Password updated successfully!"}),u({currentPassword:"",newPassword:"",confirmPassword:""})}catch(s){console.error("Error updating password:",s),i({type:"error",text:"Failed to update password. Please try again."})}finally{g(!1)}},S=t=>{d(s=>({...s,photoURL:t}))},k=[{id:"profile",name:"Profile Information",icon:"👤"},{id:"security",name:"Security",icon:"🔒"},{id:"account",name:"Account Info",icon:"ℹ️"}];return e.jsx("div",{className:`min-h-screen ${a?"bg-gray-900 text-white":"bg-gray-50 text-gray-900"}`,children:e.jsxs("div",{className:"max-w-4xl mx-auto py-8 px-4",children:[e.jsx("div",{className:`${a?"bg-gray-800 border-gray-700":"bg-white border-gray-200"} rounded-lg shadow-sm border p-6 mb-6`,children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`h-20 w-20 rounded-full ${a?"bg-gray-700":"bg-gray-200"} flex items-center justify-center overflow-hidden`,children:o.photoURL?e.jsx("img",{src:o.photoURL,alt:"Profile",className:"h-full w-full object-cover"}):e.jsx("span",{className:"text-2xl font-bold",children:((y=(b=o.displayName)==null?void 0:b.charAt(0))==null?void 0:y.toUpperCase())||((f=(h=r==null?void 0:r.email)==null?void 0:h.charAt(0))==null?void 0:f.toUpperCase())||"U"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:o.displayName||"User Profile"}),e.jsx("p",{className:`${a?"text-gray-400":"text-gray-600"}`,children:r==null?void 0:r.email}),e.jsx("span",{className:`inline-block px-3 py-1 rounded-full text-xs font-medium mt-2 ${(r==null?void 0:r.accountType)==="admin"?"bg-red-100 text-red-800":(r==null?void 0:r.accountType)==="manager"?"bg-purple-100 text-purple-800":(r==null?void 0:r.accountType)==="business"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:((w=r==null?void 0:r.accountType)==null?void 0:w.toUpperCase())||"USER"})]})]})}),x.text&&e.jsx("div",{className:`mb-6 p-4 rounded-lg ${x.type==="success"?"bg-green-100 text-green-800 border border-green-200":"bg-red-100 text-red-800 border border-red-200"}`,children:x.text}),e.jsxs("div",{className:`${a?"bg-gray-800 border-gray-700":"bg-white border-gray-200"} rounded-lg shadow-sm border`,children:[e.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700",children:e.jsx("nav",{className:"flex space-x-8 px-6",children:k.map(t=>e.jsxs("button",{onClick:()=>$(t.id),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors ${m===t.id?`border-indigo-500 ${a?"text-indigo-400":"text-indigo-600"}`:`border-transparent ${a?"text-gray-400 hover:text-gray-300":"text-gray-500 hover:text-gray-700"}`}`,children:[e.jsx("span",{className:"mr-2",children:t.icon}),t.name]},t.id))})}),e.jsxs("div",{className:"p-6",children:[m==="profile"&&e.jsxs("form",{onSubmit:T,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${a?"text-gray-300":"text-gray-700"} mb-2`,children:"Profile Picture"}),e.jsx(q,{initialImage:o.photoURL,onImageUploaded:S,folder:"profile-pictures",filePrefix:"profile",darkMode:a,showPreview:!0,previewSize:"lg",autoUpload:!0})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${a?"text-gray-300":"text-gray-700"} mb-2`,children:"Display Name"}),e.jsx("input",{type:"text",value:o.displayName,onChange:t=>d(s=>({...s,displayName:t.target.value})),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 ${a?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,placeholder:"Enter your display name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${a?"text-gray-300":"text-gray-700"} mb-2`,children:"Email Address"}),e.jsx("input",{type:"email",value:o.email,disabled:!0,className:`w-full px-3 py-2 border rounded-lg ${a?"bg-gray-800 border-gray-600 text-gray-400":"bg-gray-50 border-gray-300 text-gray-500"} cursor-not-allowed`}),e.jsx("p",{className:`text-xs mt-1 ${a?"text-gray-400":"text-gray-500"}`,children:"Email cannot be changed from this screen"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${a?"text-gray-300":"text-gray-700"} mb-2`,children:"Phone Number"}),e.jsx("input",{type:"tel",value:o.phoneNumber,onChange:t=>d(s=>({...s,phoneNumber:t.target.value})),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 ${a?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,placeholder:"Enter your phone number"})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${a?"text-gray-300":"text-gray-700"} mb-2`,children:"Company"}),e.jsx("input",{type:"text",value:o.company,onChange:t=>d(s=>({...s,company:t.target.value})),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 ${a?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,placeholder:"Enter your company name"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${a?"text-gray-300":"text-gray-700"} mb-2`,children:"Job Title"}),e.jsx("input",{type:"text",value:o.jobTitle,onChange:t=>d(s=>({...s,jobTitle:t.target.value})),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 ${a?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,placeholder:"Enter your job title"})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${a?"text-gray-300":"text-gray-700"} mb-2`,children:"Bio"}),e.jsx("textarea",{value:o.bio,onChange:t=>d(s=>({...s,bio:t.target.value})),rows:4,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 ${a?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,placeholder:"Tell us about yourself..."})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"submit",disabled:c,className:"px-6 py-2 rounded-lg font-medium transition-colors bg-indigo-600 hover:bg-indigo-700 text-white disabled:opacity-50 disabled:cursor-not-allowed",children:c?"Updating...":"Update Profile"})})]}),m==="security"&&e.jsxs("form",{onSubmit:D,className:"space-y-6 max-w-md",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${a?"text-gray-300":"text-gray-700"} mb-2`,children:"New Password"}),e.jsx("input",{type:"password",value:l.newPassword,onChange:t=>u(s=>({...s,newPassword:t.target.value})),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 ${a?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,required:!0,minLength:6,placeholder:"Enter new password"})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${a?"text-gray-300":"text-gray-700"} mb-2`,children:"Confirm New Password"}),e.jsx("input",{type:"password",value:l.confirmPassword,onChange:t=>u(s=>({...s,confirmPassword:t.target.value})),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 ${a?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,required:!0,minLength:6,placeholder:"Confirm new password"})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"submit",disabled:c,className:"px-6 py-2 rounded-lg font-medium transition-colors bg-red-600 hover:bg-red-700 text-white disabled:opacity-50 disabled:cursor-not-allowed",children:c?"Updating...":"Update Password"})})]}),m==="account"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:`p-4 rounded-lg ${a?"bg-gray-700":"bg-gray-50"}`,children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Account Information"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Account Type:"})," ",((j=r==null?void 0:r.accountType)==null?void 0:j.toUpperCase())||"USER"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Member Since:"})," ",(N=r==null?void 0:r.metadata)!=null&&N.creationTime?new Date(r.metadata.creationTime).toLocaleDateString():"Recently"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Last Sign In:"})," ",(v=r==null?void 0:r.metadata)!=null&&v.lastSignInTime?new Date(r.metadata.lastSignInTime).toLocaleDateString():"Recently"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Email Verified:"})," ",r!=null&&r.emailVerified?"✅ Yes":"❌ No"]})]})]}),e.jsxs("div",{className:`p-4 rounded-lg ${a?"bg-blue-900/20":"bg-blue-50"} border border-blue-200`,children:[e.jsx("h3",{className:"text-lg font-medium mb-2 text-blue-800 dark:text-blue-200",children:"💡 Tips"}),e.jsxs("ul",{className:"text-sm space-y-1 text-blue-700 dark:text-blue-300",children:[e.jsx("li",{children:"• Keep your profile information up to date"}),e.jsx("li",{children:"• Use a strong password and change it regularly"}),e.jsx("li",{children:"• Upload a profile picture to personalize your account"}),e.jsx("li",{children:"• Contact support if you need help with anything"})]})]})]})]})]})]})})};export{J as default};
