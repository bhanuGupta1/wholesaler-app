import{B as L,e as M,u as Y,A as U,r as g,j as e}from"./index-CFL3WSdy.js";import{c as B}from"./orderService-wIz04t0R.js";const W=()=>{var F,D;const{cart:x,clearCart:O}=L(),{user:i}=M(),{darkMode:a}=Y(),v=U(),[c,p]=g.useState(1),[N,f]=g.useState(!1),[w,C]=g.useState(""),[s,A]=g.useState({firstName:((F=i==null?void 0:i.displayName)==null?void 0:F.split(" ")[0])||"",lastName:((D=i==null?void 0:i.displayName)==null?void 0:D.split(" ")[1])||"",email:(i==null?void 0:i.email)||"",phone:"",address:"",apartment:"",city:"",state:"",zipCode:"",country:"US",isDefault:!1}),[t,E]=g.useState({method:"credit_card",cardNumber:"",expiryDate:"",cvv:"",nameOnCard:"",billingAddressSame:!0,billingAddress:{address:"",apartment:"",city:"",state:"",zipCode:"",country:"US"}}),[y,T]=g.useState("standard"),[$,I]=g.useState("");g.useEffect(()=>{x.length===0&&v("/cart")},[x,v]);const k=[{id:"standard",name:"Standard Delivery",description:"5-7 business days",price:15.99,freeThreshold:100},{id:"expedited",name:"Expedited Delivery",description:"2-3 business days",price:29.99,freeThreshold:200},{id:"overnight",name:"Overnight Delivery",description:"Next business day",price:49.99,freeThreshold:500},{id:"pickup",name:"Store Pickup",description:"Ready in 2-4 hours",price:0,freeThreshold:0}],S=()=>{const r=x.reduce((m,j)=>m+j.price*j.quantity,0),d=k.find(m=>m.id===y),n=r>=d.freeThreshold?0:d.price,l=r*.08,u=r+n+l;return{subtotal:r,deliveryFee:n,tax:l,total:u}},o=(r,d)=>{A(n=>({...n,[r]:d}))},b=(r,d)=>{E(n=>({...n,[r]:d}))},P=()=>["firstName","lastName","email","phone","address","city","state","zipCode"].every(d=>s[d].trim()!==""),q=()=>t.method==="credit_card"||t.method==="debit_card"?t.cardNumber&&t.expiryDate&&t.cvv&&t.nameOnCard:!0,_=r=>{const n=r.replace(/\s+/g,"").replace(/[^0-9]/gi,"").match(/\d{4,16}/g),l=n&&n[0]||"",u=[];for(let m=0,j=l.length;m<j;m+=4)u.push(l.substring(m,m+4));return u.length?u.join(" "):r},R=r=>{const d=r.replace(/\D/g,"");return d.length>=2?d.substring(0,2)+(d.length>2?"/"+d.substring(2,4):""):d},z=async()=>{try{f(!0),C("");const r=S(),d={customerName:`${s.firstName} ${s.lastName}`,customerEmail:s.email,customerPhone:s.phone,shippingAddress:s,billingAddress:t.billingAddressSame?s:t.billingAddress,items:x.map(l=>({productId:l.id,productName:l.name,price:l.price,quantity:l.quantity,subtotal:l.price*l.quantity})),subtotal:r.subtotal,deliveryFee:r.deliveryFee,tax:r.tax,total:r.total,deliveryOption:y,specialInstructions:$,paymentMethod:t.method,paymentStatus:"pending",status:"pending",userId:(i==null?void 0:i.uid)||null,itemCount:x.reduce((l,u)=>l+u.quantity,0)},n=await B(d);await new Promise(l=>setTimeout(l,2e3)),O(),v(`/order-confirmation/${n}`)}catch(r){C(r.message||"Failed to place order. Please try again.")}finally{f(!1)}},h=S();return e.jsx("div",{className:`min-h-screen ${a?"bg-gray-900 text-white":"bg-gray-50 text-gray-900"}`,children:e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-4",children:"Checkout"}),e.jsx("div",{className:"flex items-center justify-center mb-6",children:[{num:1,label:"Shipping"},{num:2,label:"Payment"},{num:3,label:"Review"}].map((r,d)=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`flex items-center justify-center w-8 h-8 rounded-full ${c>=r.num?"bg-indigo-600 text-white":a?"bg-gray-700 text-gray-400":"bg-gray-300 text-gray-600"}`,children:c>r.num?"✓":r.num}),e.jsx("span",{className:"ml-2 font-medium",children:r.label}),d<2&&e.jsx("div",{className:`w-16 h-0.5 mx-4 ${c>r.num?"bg-indigo-600":a?"bg-gray-700":"bg-gray-300"}`})]},r.num))})]}),w&&e.jsx("div",{className:`mb-6 p-4 rounded-lg border-l-4 ${a?"bg-red-900/30 border-red-800 text-red-400":"bg-red-50 border-red-400 text-red-700"}`,children:w}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2",children:[c===1&&e.jsxs("div",{className:`${a?"bg-gray-800":"bg-white"} rounded-lg shadow-md p-6`,children:[e.jsx("h2",{className:"text-xl font-semibold mb-6",children:"Shipping Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"First Name *"}),e.jsx("input",{type:"text",value:s.firstName,onChange:r=>o("firstName",r.target.value),className:`w-full px-4 py-3 border rounded-lg ${a?"bg-gray-700 border-gray-600":"bg-white border-gray-300"}`,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Last Name *"}),e.jsx("input",{type:"text",value:s.lastName,onChange:r=>o("lastName",r.target.value),className:`w-full px-4 py-3 border rounded-lg ${a?"bg-gray-700 border-gray-600":"bg-white border-gray-300"}`,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Email *"}),e.jsx("input",{type:"email",value:s.email,onChange:r=>o("email",r.target.value),className:`w-full px-4 py-3 border rounded-lg ${a?"bg-gray-700 border-gray-600":"bg-white border-gray-300"}`,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Phone *"}),e.jsx("input",{type:"tel",value:s.phone,onChange:r=>o("phone",r.target.value),className:`w-full px-4 py-3 border rounded-lg ${a?"bg-gray-700 border-gray-600":"bg-white border-gray-300"}`,required:!0})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Address *"}),e.jsx("input",{type:"text",value:s.address,onChange:r=>o("address",r.target.value),className:`w-full px-4 py-3 border rounded-lg ${a?"bg-gray-700 border-gray-600":"bg-white border-gray-300"}`,required:!0})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Apartment, suite, etc. (Optional)"}),e.jsx("input",{type:"text",value:s.apartment,onChange:r=>o("apartment",r.target.value),className:`w-full px-4 py-3 border rounded-lg ${a?"bg-gray-700 border-gray-600":"bg-white border-gray-300"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"City *"}),e.jsx("input",{type:"text",value:s.city,onChange:r=>o("city",r.target.value),className:`w-full px-4 py-3 border rounded-lg ${a?"bg-gray-700 border-gray-600":"bg-white border-gray-300"}`,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"State *"}),e.jsxs("select",{value:s.state,onChange:r=>o("state",r.target.value),className:`w-full px-4 py-3 border rounded-lg ${a?"bg-gray-700 border-gray-600":"bg-white border-gray-300"}`,required:!0,children:[e.jsx("option",{value:"",children:"Select State"}),e.jsx("option",{value:"CA",children:"California"}),e.jsx("option",{value:"NY",children:"New York"}),e.jsx("option",{value:"TX",children:"Texas"}),e.jsx("option",{value:"FL",children:"Florida"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"ZIP Code *"}),e.jsx("input",{type:"text",value:s.zipCode,onChange:r=>o("zipCode",r.target.value),className:`w-full px-4 py-3 border rounded-lg ${a?"bg-gray-700 border-gray-600":"bg-white border-gray-300"}`,required:!0})]})]}),e.jsxs("div",{className:"mt-8",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Delivery Options"}),e.jsx("div",{className:"space-y-3",children:k.map(r=>e.jsxs("label",{className:`flex items-center p-4 border rounded-lg cursor-pointer ${y===r.id?a?"border-indigo-500 bg-indigo-900/20":"border-indigo-500 bg-indigo-50":a?"border-gray-600":"border-gray-300"}`,children:[e.jsx("input",{type:"radio",name:"delivery",value:r.id,checked:y===r.id,onChange:d=>T(d.target.value),className:"mr-4"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:r.name}),e.jsx("div",{className:`text-sm ${a?"text-gray-400":"text-gray-600"}`,children:r.description})]}),e.jsx("div",{className:"text-right",children:r.price===0?e.jsx("span",{className:"font-medium text-green-600",children:"FREE"}):h.subtotal>=r.freeThreshold?e.jsxs("div",{children:[e.jsxs("span",{className:"line-through text-gray-400",children:["$",r.price]}),e.jsx("span",{className:"ml-2 font-medium text-green-600",children:"FREE"})]}):e.jsxs("span",{className:"font-medium",children:["$",r.price]})})]},r.id))})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Special Instructions (Optional)"}),e.jsx("textarea",{value:$,onChange:r=>I(r.target.value),rows:"3",className:`w-full px-4 py-3 border rounded-lg ${a?"bg-gray-700 border-gray-600":"bg-white border-gray-300"}`,placeholder:"Any special delivery instructions..."})]})]}),c===2&&e.jsxs("div",{className:`${a?"bg-gray-800":"bg-white"} rounded-lg shadow-md p-6`,children:[e.jsx("h2",{className:"text-xl font-semibold mb-6",children:"Payment Information"}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Choose Payment Method"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[{id:"credit_card",name:"Credit Card",icon:"💳"},{id:"debit_card",name:"Debit Card",icon:"💳"},{id:"paypal",name:"PayPal",icon:"🅿️"},{id:"apple_pay",name:"Apple Pay",icon:"🍎"}].map(r=>e.jsxs("label",{className:`flex items-center p-4 border rounded-lg cursor-pointer ${t.method===r.id?a?"border-indigo-500 bg-indigo-900/20":"border-indigo-500 bg-indigo-50":a?"border-gray-600":"border-gray-300"}`,children:[e.jsx("input",{type:"radio",name:"payment",value:r.id,checked:t.method===r.id,onChange:d=>b("method",d.target.value),className:"mr-3"}),e.jsx("span",{className:"mr-2",children:r.icon}),e.jsx("span",{children:r.name})]},r.id))})]}),(t.method==="credit_card"||t.method==="debit_card")&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Name on Card *"}),e.jsx("input",{type:"text",value:t.nameOnCard,onChange:r=>b("nameOnCard",r.target.value),className:`w-full px-4 py-3 border rounded-lg ${a?"bg-gray-700 border-gray-600":"bg-white border-gray-300"}`,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Card Number *"}),e.jsx("input",{type:"text",value:t.cardNumber,onChange:r=>b("cardNumber",_(r.target.value)),placeholder:"1234 5678 9012 3456",maxLength:"19",className:`w-full px-4 py-3 border rounded-lg ${a?"bg-gray-700 border-gray-600":"bg-white border-gray-300"}`,required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Expiry Date *"}),e.jsx("input",{type:"text",value:t.expiryDate,onChange:r=>b("expiryDate",R(r.target.value)),placeholder:"MM/YY",maxLength:"5",className:`w-full px-4 py-3 border rounded-lg ${a?"bg-gray-700 border-gray-600":"bg-white border-gray-300"}`,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"CVV *"}),e.jsx("input",{type:"text",value:t.cvv,onChange:r=>b("cvv",r.target.value.replace(/\D/g,"")),placeholder:"123",maxLength:"4",className:`w-full px-4 py-3 border rounded-lg ${a?"bg-gray-700 border-gray-600":"bg-white border-gray-300"}`,required:!0})]})]})]}),t.method==="paypal"&&e.jsx("div",{className:`p-6 rounded-lg border-2 border-dashed ${a?"border-gray-600 bg-gray-700":"border-gray-300 bg-gray-50"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-4xl mb-2",children:"🅿️"}),e.jsx("p",{className:"font-medium",children:"PayPal Payment"}),e.jsx("p",{className:`text-sm ${a?"text-gray-400":"text-gray-600"}`,children:"You will be redirected to PayPal to complete your payment"})]})}),e.jsx("div",{className:"mt-6",children:e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("input",{type:"checkbox",checked:t.billingAddressSame,onChange:r=>b("billingAddressSame",r.target.checked),className:"mr-3"}),e.jsx("label",{className:"text-sm font-medium",children:"Billing address is same as shipping address"})]})})]}),c===3&&e.jsxs("div",{className:`${a?"bg-gray-800":"bg-white"} rounded-lg shadow-md p-6`,children:[e.jsx("h2",{className:"text-xl font-semibold mb-6",children:"Review Your Order"}),e.jsx("div",{className:"space-y-4 mb-6",children:x.map(r=>e.jsxs("div",{className:"flex items-center space-x-4 p-4 border rounded-lg",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-200 rounded-lg flex items-center justify-center",children:r.imageUrl?e.jsx("img",{src:r.imageUrl,alt:r.name,className:"w-16 h-16 object-cover rounded-lg"}):e.jsx("span",{children:"📦"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium",children:r.name}),e.jsxs("p",{className:`text-sm ${a?"text-gray-400":"text-gray-600"}`,children:["Qty: ",r.quantity," × $",r.price.toFixed(2)]})]}),e.jsxs("div",{className:"font-semibold",children:["$",(r.price*r.quantity).toFixed(2)]})]},r.id))}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-2",children:"Shipping Address"}),e.jsxs("div",{className:`p-3 rounded ${a?"bg-gray-700":"bg-gray-50"} text-sm`,children:[e.jsxs("div",{children:[s.firstName," ",s.lastName]}),e.jsx("div",{children:s.address}),s.apartment&&e.jsx("div",{children:s.apartment}),e.jsxs("div",{children:[s.city,", ",s.state," ",s.zipCode]}),e.jsx("div",{children:s.phone})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-2",children:"Payment Method"}),e.jsxs("div",{className:`p-3 rounded ${a?"bg-gray-700":"bg-gray-50"} text-sm`,children:[e.jsx("div",{className:"capitalize",children:t.method.replace("_"," ")}),t.cardNumber&&e.jsxs("div",{children:["•••• •••• •••• ",t.cardNumber.slice(-4)]})]})]})]})]})]}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:`${a?"bg-gray-800":"bg-white"} rounded-lg shadow-md p-6 sticky top-4`,children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Order Summary"}),e.jsxs("div",{className:"space-y-3 mb-6",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{children:["Subtotal (",x.reduce((r,d)=>r+d.quantity,0)," items):"]}),e.jsxs("span",{children:["$",h.subtotal.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Delivery:"}),e.jsx("span",{children:h.deliveryFee===0?e.jsx("span",{className:"text-green-600",children:"FREE"}):`$${h.deliveryFee.toFixed(2)}`})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Tax:"}),e.jsxs("span",{children:["$",h.tax.toFixed(2)]})]}),e.jsx("hr",{className:`${a?"border-gray-600":"border-gray-200"}`}),e.jsxs("div",{className:"flex justify-between text-lg font-bold",children:[e.jsx("span",{children:"Total:"}),e.jsxs("span",{children:["$",h.total.toFixed(2)]})]})]}),e.jsxs("div",{className:"space-y-3",children:[c===1&&e.jsx("button",{onClick:()=>p(2),disabled:!P(),className:`w-full py-3 rounded-lg font-medium ${P()?"bg-indigo-600 text-white hover:bg-indigo-700":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:"Continue to Payment"}),c===2&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>p(3),disabled:!q(),className:`w-full py-3 rounded-lg font-medium ${q()?"bg-indigo-600 text-white hover:bg-indigo-700":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:"Review Order"}),e.jsx("button",{onClick:()=>p(1),className:`w-full py-2 rounded-lg font-medium border ${a?"border-gray-600 text-gray-300 hover:bg-gray-700":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:"Back to Shipping"})]}),c===3&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:z,disabled:N,className:`w-full py-3 rounded-lg font-medium ${N?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700"} text-white`,children:N?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Processing..."]}):`Place Order • $${h.total.toFixed(2)}`}),e.jsx("button",{onClick:()=>p(2),className:`w-full py-2 rounded-lg font-medium border ${a?"border-gray-600 text-gray-300 hover:bg-gray-700":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:"Back to Payment"})]})]}),e.jsx("div",{className:`mt-6 p-3 rounded text-xs ${a?"bg-green-900/20 border-green-800":"bg-green-50 border-green-200"} border`,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"mr-2",children:"🔒"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-green-600",children:"Secure Checkout"}),e.jsx("div",{className:`${a?"text-green-300":"text-green-600"}`,children:"SSL encrypted & PCI compliant"})]})]})})]})})]})]})})};export{W as default};
